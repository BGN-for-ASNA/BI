# 17. Modeling Network
When modeling network data, the relationships between nodes can be represented by weighted links. These weights might indicate the strength of connections such as the number of interactions, shared attributes, or other quantitative measures of connection strength between nodes. The simple model that can be built to model link weights between nodes _i_ and _j_ can be defined as follows:

$$
G_{ij} \sim Poisson(Y_{ij}) \\
log(Y_{ij}) =  \alpha  + \lambda_i + \pi_j + \delta_{ij}
$$

where:
- \( Y_{ij} \) is the weight of links between _i_ and _j_.
- \( \alpha \) is the intercept.
- \( \lambda_i \) is the characteristic of node _i_ that affects node _i_'s propensity to emit a link toward node _j_.
- \( \pi_j \) is the characteristic of node _j_ that affects node _j_'s propensity to receive a link from node _i_.
- \( \delta_{ij} \) is a matrix of dyadic effects governing reciprocity between dyads.

Note that any additional covariates can be added with a regression coefficient to the model representing nodal characteristics (e.g., sex, age) or dyadic characteristics (e.g., genetic distances).

To account for correlation between the propensity to emit and receive links of a dyad, we can use [varying slopes](13.%20Varying%20slopes.md) as follows:

$$
\left(\begin{array}{cc} 
\lambda_i \\
\pi_j 
\end{array}\right) 
\sim 
MultivariateNormal\left(\begin{array}{cc} 
\left(\begin{array}{cc} 
0 \\
0
\end{array}\right),
\left(\begin{array}{cc} 
\sigma_\lambda^2 & \sigma_\pi \sigma_{\lambda \rho }\\
\sigma_\lambda \sigma_{\pi \rho } & \sigma_\pi^2
\end{array}\right)
\end{array}\right)
$$ 

This can be optimized for computation by:

$$
\left(\begin{array}{cc} 
\lambda_i \\
\pi_j 
\end{array}\right) 
\sim 
MultivariateNormal\left(\begin{array}{cc} 
\left(\begin{array}{cc} 
\sigma_\lambda \\
\sigma_\pi
\end{array}\right) \circ 
\left(\begin{array}{cc} 
L *
\left(\begin{array}{cc} 
\hat{\lambda}_i \\ \hat{\pi}_i
\end{array}\right)
\end{array}\right)
\end{array}\right)
$$

$$
\sigma_\alpha \sim Exponential(1)
$$

$$
\sigma_\pi \sim Exponential(1)
$$

$$
L \sim LKJ(2)
$$

Similarly, the dyad reciprocity effect is also modeled using a random slope:

$$
\left(\begin{array}{cc} 
\delta_{ij} \\
\delta_{ji}
\end{array}\right) 
\sim 
MultivariateNormal\left(\begin{array}{cc} 
\left(\begin{array}{cc} 
\sigma_\delta \\
\sigma_\delta
\end{array}\right) \circ 
\left(\begin{array}{cc} 
L_\delta *
\left(\begin{array}{cc} 
\hat{\delta}_{ij} \\ \hat{\delta}_{ji}
\end{array}\right)
\end{array}\right)
\end{array}\right)
$$ 


## Conciderations
- Network links can be modeled using Bernoulli, Binomial, Poisson, or zero-inflated Poisson distributions. So, by replacing the Poisson distribution with a binomial distribution, we can model the existence or absence of link weights â€” i.e., model binary networks.

- Note that if the network is undirected, then accounting for correlation between propensity to emit and receive links is not necessary, and the terms \( \lambda_i \), \( \pi_j \), and \( \delta_{ij} \) are no longer required. (Is it correct?)

- In the following chapters, we will see how to incorporate additional network effects into the model to account for network structural properties (e.g., clusters, assortativity, triadic closure, etc.).