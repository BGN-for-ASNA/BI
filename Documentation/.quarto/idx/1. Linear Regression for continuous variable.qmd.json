{"title":"Linear Regression for continuous variable","markdown":{"headingText":"Linear Regression for continuous variable","containsRefs":false,"markdown":"<!-- Toolpit -->\n\n\n\n\n## General Principles\n\nTo study relationships between two continuous variables (e.g., height and weight), we can use a linear regression approach. Essentially, we draw a line that passes through the point cloud of the two variables being tested. For this, we need to have:\n\n1) An intercept $\\alpha$, which represents the origin of the lineâ€”the expected value of the dependent variable (height) when the independent variable (weight) is equal to zero.\n\n2) A coefficient $\\beta$, which informs us about the slope of the line. In other words, it tells us how much Y (height) increases for each increment of the independent variable (weight).\n\n3) A variance term $\\sigma$, which informs us about the spread of points around the line, i.e., the variance around the prediction.\n\n\n\n![](https://miro.medium.com/v2/resize:fit:786/format:webp/1*WCcaObzvvVzcrg8CBi6iCQ.jpeg)\n\n## Considerations \n\n::: callout-caution\n-   Bayesian models consider [<span style=\"color:#0D6EFD\">model parameter uncertainty ðŸ›ˆ</span>]{#uncertainty}, allowing for the quantification of confidence or uncertainty through the parameters'  [<span style=\"color:#0D6EFD\">posterior distribution ðŸ›ˆ</span>]{#posterior}. Therefore, we need to declare [<span style=\"color:#0D6EFD\">prior distributions ðŸ›ˆ</span>]{#prior} for each model parameter, in your case for: $\\alpha$, $\\beta$, and $\\sigma^2$.\n\n- Prior distributions are built following these considerations:\n\n  - As the data is [<span style=\"color:#0D6EFD\">scaled ðŸ›ˆ</span>]{#scaled} (see introduction), we can use a Normal distribution for $\\alpha$ and $\\beta$, with a mean of 0 and a standard deviation of 1.\n\n  - Since $\\sigma$ is strictly positive, we can use any distribution that is positively defined, such as the Exponential or Gamma distribution.\n\n- Gaussian regression deals directly with continuous outcomes, estimating a linear relationship between predictors and the outcome variable without needing a [<span style=\"color:#0D6EFD\">link function ðŸ›ˆ</span>]{#linkF}. This simplifies interpretation, as coefficients represent direct changes in the outcome variable.\n\n\n:::\n\n## Example\n\nBelow is an example code snippet demonstrating Bayesian linear regression using the Bayesian Inference (BI) package. Data consist of two continuous variables (height and weight), and the goal is to estimate the effect of weight on height.\n\n::: {.panel-tabset group=\"language\"}\n## Python\n\n``` python\nfrom .bi.main import*\n# Setup device------------------------------------------------\nm = bi(platform='cpu')\n\n# Import Data & Data Manipulation ------------------------------------------------\nm.data('../data/Howell1.csv', sep=';') # Import\nm.df = m.df[m.df.age > 18] # Manipulate\nm.scale(['weight']) # Scale\nm.data_to_model(['weight', 'height']) # Send to model (convert to jax array)\n\n# Define model ------------------------------------------------\ndef model(height, weight): \n    # Parameters priors distributions   \n    alpha = dist.normal(178, 20, name = 'alpha')\n    beta = dist.normal(0, 1, name = 'beta')   \n    sigma = dist.uniform(0, 50, name = 'sigma')\n    # Likelihood\n    lk(\"height\", Normal(alpha + beta * weight, sigma), obs = height)\n\n# Run mcmc ------------------------------------------------\nm.run(model)  # Optimize model parameters through MCMC sampling\n\n# Summary ------------------------------------------------\nm.sampler.print_summary(0.89) # Get posterior distributions\n```\n\n## R\n\n``` r\nlibrary(reticulate)\nsetwd(paste0(getwd(), '/bi'))\n\n# Setup device------------------------------------------------\nbi <- import(\"main\")\nload('STRAND sim sr dyad.Rdata')\nm = bi$bi(platform='cpu')\n\n# Import Data & Data Manipulation ------------------------------------------------\nm$data('../data/Howell1.csv', sep=';')  # Import\nm$df = m$df[m$df$age > 18,] # Manipulate\nm$scale(list('weight')) # Scale\nm$data_to_model(list('weight', 'height')) # Send to model (convert to jax array)\n\n# Define model ------------------------------------------------\nmodel <- function(height, weight){\n  # Parameters priors distributions\n  s = bi$dist$uniform(0, 50, name = 's', shape = tuple(as.integer(1)))\n  a = bi$dist$normal(178, 20, name = 'a', shape = tuple(as.integer(1)))\n  b = bi$dist$normal(0, 1, name = 'b', shape = tuple(as.integer(1)))   \n  # Likelihood\n  bi$lk(\"y\", bi$Normal(a + b * weight, s), obs = height)\n}\n\n# Run mcmc ------------------------------------------------\nm$run(model) # Optimize model parameters through MCMC sampling\n\n# Summary ------------------------------------------------\nm$sampler$print_summary(0.89) # Get posterior distributions\n```\n:::\n\n## Mathematical Details\n\n### *Frequentist formulation*\n\nThe following equation allows us to draw a line and is the one that is most used in statistics classes: \n$$\nY_i = \\alpha + \\beta  X_i + \\sigma_i\n$$\n\nWhere:\n\n-   $Y_i$ is the dependent variable for observation *i*.\n\n-   $\\alpha$ is the intercept term.\n\n-   $\\beta$ is the regression coefficient.\n\n-   $X_i$ is the input variable for observation *i*.\n\n-   $\\sigma_i$ is a vector of error terms for observation *i*.\n\n### *Bayesian formulation*\n\nIn the Bayesian formulation, we define each parameter with [<span style=\"color:#0D6EFD\">priors ðŸ›ˆ</span>]{#prior}. We can express a Bayesian version of this regression model using the following model: \n\n$$\nY_i \\sim Normal(\\alpha + \\beta   X_i, \\sigma)\n$$\n\n$$\n\\alpha \\sim Normal(0, 1)\n$$\n\n$$\n\\beta \\sim Normal(0, 1)\n$$\n\n$$\n\\sigma \\sim Uniform(0, 50)\n$$\n\nWhere:\n\n-   $Y_i$ is dependent variable for observation *i*.\n\n-   $\\alpha$ and $\\beta$ are the regression coefficients and intercept parameters, respectively.\n\n-   $X_i$ is the input variable for observation *i*.\n\n-   $\\sigma$ is a prior for the vairance term standard deviation of the normal distribution that describes the variance in the relationship between the dependent variable $Y$ and the independent variable $X$.\n\n\n## Notes\n::: callout-note\nWe can observe a difference between the *Frequentist* and the *Bayesian* formulation regarding the error term. Indeed, *Frequentist* formulation, the error term $\\sigma_i$ represents random fluctuations around the predicted values. This assumption leads to point estimates for $\\alpha$ and $\\beta$, without accounting for uncertainty in these estimates. In contrast, the *Bayesian* formulation treats $\\sigma$ as a parameter with its own prior distribution. This allows us to incorporate our uncertainty about the error term into the model.\n:::\n\n## Reference(s)\n\n@mcelreath2018statistical","srcMarkdownNoYaml":""},"formats":{"html":{"identifier":{"display-name":"HTML","target-format":"html","base-format":"html"},"execute":{"fig-width":7,"fig-height":5,"fig-format":"retina","fig-dpi":96,"df-print":"default","error":false,"eval":true,"cache":null,"freeze":false,"echo":true,"output":true,"warning":true,"include":true,"keep-md":false,"keep-ipynb":false,"ipynb":null,"enabled":null,"daemon":null,"daemon-restart":false,"debug":false,"ipynb-filters":[],"ipynb-shell-interactivity":null,"plotly-connected":true,"engine":"markdown"},"render":{"keep-tex":false,"keep-typ":false,"keep-source":false,"keep-hidden":false,"prefer-html":false,"output-divs":true,"output-ext":"html","fig-align":"default","fig-pos":null,"fig-env":null,"code-fold":"none","code-overflow":"scroll","code-link":false,"code-line-numbers":false,"code-tools":false,"tbl-colwidths":"auto","merge-includes":true,"inline-includes":false,"preserve-yaml":false,"latex-auto-mk":true,"latex-auto-install":true,"latex-clean":true,"latex-min-runs":1,"latex-max-runs":10,"latex-makeindex":"makeindex","latex-makeindex-opts":[],"latex-tlmgr-opts":[],"latex-input-paths":[],"latex-output-dir":null,"link-external-icon":false,"link-external-newwindow":false,"self-contained-math":false,"format-resources":[],"notebook-links":true},"pandoc":{"standalone":true,"wrap":"none","default-image-extension":"png","to":"html","highlight-style":"monokai","include-after-body":["tooltip-scripts.html"],"output-file":"1. Linear Regression for continuous variable.html"},"language":{"toc-title-document":"Table of contents","toc-title-website":"On this page","related-formats-title":"Other Formats","related-notebooks-title":"Notebooks","source-notebooks-prefix":"Source","other-links-title":"Other Links","code-links-title":"Code Links","launch-dev-container-title":"Launch Dev Container","launch-binder-title":"Launch Binder","article-notebook-label":"Article Notebook","notebook-preview-download":"Download Notebook","notebook-preview-download-src":"Download Source","notebook-preview-back":"Back to Article","manuscript-meca-bundle":"MECA Bundle","section-title-abstract":"Abstract","section-title-appendices":"Appendices","section-title-footnotes":"Footnotes","section-title-references":"References","section-title-reuse":"Reuse","section-title-copyright":"Copyright","section-title-citation":"Citation","appendix-attribution-cite-as":"For attribution, please cite this work as:","appendix-attribution-bibtex":"BibTeX citation:","appendix-view-license":"View License","title-block-author-single":"Author","title-block-author-plural":"Authors","title-block-affiliation-single":"Affiliation","title-block-affiliation-plural":"Affiliations","title-block-published":"Published","title-block-modified":"Modified","title-block-keywords":"Keywords","callout-tip-title":"Tip","callout-note-title":"Note","callout-warning-title":"Warning","callout-important-title":"Important","callout-caution-title":"Caution","code-summary":"Code","code-tools-menu-caption":"Code","code-tools-show-all-code":"Show All Code","code-tools-hide-all-code":"Hide All Code","code-tools-view-source":"View Source","code-tools-source-code":"Source Code","tools-share":"Share","tools-download":"Download","code-line":"Line","code-lines":"Lines","copy-button-tooltip":"Copy to Clipboard","copy-button-tooltip-success":"Copied!","repo-action-links-edit":"Edit this page","repo-action-links-source":"View source","repo-action-links-issue":"Report an issue","back-to-top":"Back to top","search-no-results-text":"No results","search-matching-documents-text":"matching documents","search-copy-link-title":"Copy link to search","search-hide-matches-text":"Hide additional matches","search-more-match-text":"more match in this document","search-more-matches-text":"more matches in this document","search-clear-button-title":"Clear","search-text-placeholder":"","search-detached-cancel-button-title":"Cancel","search-submit-button-title":"Submit","search-label":"Search","toggle-section":"Toggle section","toggle-sidebar":"Toggle sidebar navigation","toggle-dark-mode":"Toggle dark mode","toggle-reader-mode":"Toggle reader mode","toggle-navigation":"Toggle navigation","crossref-fig-title":"Figure","crossref-tbl-title":"Table","crossref-lst-title":"Listing","crossref-thm-title":"Theorem","crossref-lem-title":"Lemma","crossref-cor-title":"Corollary","crossref-prp-title":"Proposition","crossref-cnj-title":"Conjecture","crossref-def-title":"Definition","crossref-exm-title":"Example","crossref-exr-title":"Exercise","crossref-ch-prefix":"Chapter","crossref-apx-prefix":"Appendix","crossref-sec-prefix":"Section","crossref-eq-prefix":"Equation","crossref-lof-title":"List of Figures","crossref-lot-title":"List of Tables","crossref-lol-title":"List of Listings","environment-proof-title":"Proof","environment-remark-title":"Remark","environment-solution-title":"Solution","listing-page-order-by":"Order By","listing-page-order-by-default":"Default","listing-page-order-by-date-asc":"Oldest","listing-page-order-by-date-desc":"Newest","listing-page-order-by-number-desc":"High to Low","listing-page-order-by-number-asc":"Low to High","listing-page-field-date":"Date","listing-page-field-title":"Title","listing-page-field-description":"Description","listing-page-field-author":"Author","listing-page-field-filename":"File Name","listing-page-field-filemodified":"Modified","listing-page-field-subtitle":"Subtitle","listing-page-field-readingtime":"Reading Time","listing-page-field-wordcount":"Word Count","listing-page-field-categories":"Categories","listing-page-minutes-compact":"{0} min","listing-page-category-all":"All","listing-page-no-matches":"No matching items","listing-page-words":"{0} words","listing-page-filter":"Filter","draft":"Draft"},"metadata":{"lang":"en","fig-responsive":true,"quarto-version":"1.5.57","bibliography":["references.bib"],"theme":"Morph","backgroundcolor":"#ffffff","code-copy":true},"extensions":{"book":{"multiFile":true}}},"pdf":{"identifier":{"display-name":"PDF","target-format":"pdf","base-format":"pdf"},"execute":{"fig-width":5.5,"fig-height":3.5,"fig-format":"pdf","fig-dpi":300,"df-print":"default","error":false,"eval":true,"cache":null,"freeze":false,"echo":true,"output":true,"warning":true,"include":true,"keep-md":false,"keep-ipynb":false,"ipynb":null,"enabled":null,"daemon":null,"daemon-restart":false,"debug":false,"ipynb-filters":[],"ipynb-shell-interactivity":null,"plotly-connected":true,"engine":"markdown"},"render":{"keep-tex":false,"keep-typ":false,"keep-source":false,"keep-hidden":false,"prefer-html":false,"output-divs":true,"output-ext":"pdf","fig-align":"default","fig-pos":null,"fig-env":null,"code-fold":"none","code-overflow":"scroll","code-link":false,"code-line-numbers":false,"code-tools":false,"tbl-colwidths":true,"merge-includes":true,"inline-includes":false,"preserve-yaml":false,"latex-auto-mk":true,"latex-auto-install":true,"latex-clean":true,"latex-min-runs":1,"latex-max-runs":10,"latex-makeindex":"makeindex","latex-makeindex-opts":[],"latex-tlmgr-opts":[],"latex-input-paths":[],"latex-output-dir":null,"link-external-icon":false,"link-external-newwindow":false,"self-contained-math":false,"format-resources":[]},"pandoc":{"pdf-engine":"xelatex","standalone":true,"variables":{"graphics":true,"tables":true},"default-image-extension":"pdf","to":"pdf","output-file":"1. Linear Regression for continuous variable.pdf"},"language":{"toc-title-document":"Table of contents","toc-title-website":"On this page","related-formats-title":"Other Formats","related-notebooks-title":"Notebooks","source-notebooks-prefix":"Source","other-links-title":"Other Links","code-links-title":"Code Links","launch-dev-container-title":"Launch Dev Container","launch-binder-title":"Launch Binder","article-notebook-label":"Article Notebook","notebook-preview-download":"Download Notebook","notebook-preview-download-src":"Download Source","notebook-preview-back":"Back to Article","manuscript-meca-bundle":"MECA Bundle","section-title-abstract":"Abstract","section-title-appendices":"Appendices","section-title-footnotes":"Footnotes","section-title-references":"References","section-title-reuse":"Reuse","section-title-copyright":"Copyright","section-title-citation":"Citation","appendix-attribution-cite-as":"For attribution, please cite this work as:","appendix-attribution-bibtex":"BibTeX citation:","appendix-view-license":"View License","title-block-author-single":"Author","title-block-author-plural":"Authors","title-block-affiliation-single":"Affiliation","title-block-affiliation-plural":"Affiliations","title-block-published":"Published","title-block-modified":"Modified","title-block-keywords":"Keywords","callout-tip-title":"Tip","callout-note-title":"Note","callout-warning-title":"Warning","callout-important-title":"Important","callout-caution-title":"Caution","code-summary":"Code","code-tools-menu-caption":"Code","code-tools-show-all-code":"Show All Code","code-tools-hide-all-code":"Hide All Code","code-tools-view-source":"View Source","code-tools-source-code":"Source Code","tools-share":"Share","tools-download":"Download","code-line":"Line","code-lines":"Lines","copy-button-tooltip":"Copy to Clipboard","copy-button-tooltip-success":"Copied!","repo-action-links-edit":"Edit this page","repo-action-links-source":"View source","repo-action-links-issue":"Report an issue","back-to-top":"Back to top","search-no-results-text":"No results","search-matching-documents-text":"matching documents","search-copy-link-title":"Copy link to search","search-hide-matches-text":"Hide additional matches","search-more-match-text":"more match in this document","search-more-matches-text":"more matches in this document","search-clear-button-title":"Clear","search-text-placeholder":"","search-detached-cancel-button-title":"Cancel","search-submit-button-title":"Submit","search-label":"Search","toggle-section":"Toggle section","toggle-sidebar":"Toggle sidebar navigation","toggle-dark-mode":"Toggle dark mode","toggle-reader-mode":"Toggle reader mode","toggle-navigation":"Toggle navigation","crossref-fig-title":"Figure","crossref-tbl-title":"Table","crossref-lst-title":"Listing","crossref-thm-title":"Theorem","crossref-lem-title":"Lemma","crossref-cor-title":"Corollary","crossref-prp-title":"Proposition","crossref-cnj-title":"Conjecture","crossref-def-title":"Definition","crossref-exm-title":"Example","crossref-exr-title":"Exercise","crossref-ch-prefix":"Chapter","crossref-apx-prefix":"Appendix","crossref-sec-prefix":"Section","crossref-eq-prefix":"Equation","crossref-lof-title":"List of Figures","crossref-lot-title":"List of Tables","crossref-lol-title":"List of Listings","environment-proof-title":"Proof","environment-remark-title":"Remark","environment-solution-title":"Solution","listing-page-order-by":"Order By","listing-page-order-by-default":"Default","listing-page-order-by-date-asc":"Oldest","listing-page-order-by-date-desc":"Newest","listing-page-order-by-number-desc":"High to Low","listing-page-order-by-number-asc":"Low to High","listing-page-field-date":"Date","listing-page-field-title":"Title","listing-page-field-description":"Description","listing-page-field-author":"Author","listing-page-field-filename":"File Name","listing-page-field-filemodified":"Modified","listing-page-field-subtitle":"Subtitle","listing-page-field-readingtime":"Reading Time","listing-page-field-wordcount":"Word Count","listing-page-field-categories":"Categories","listing-page-minutes-compact":"{0} min","listing-page-category-all":"All","listing-page-no-matches":"No matching items","listing-page-words":"{0} words","listing-page-filter":"Filter","draft":"Draft"},"metadata":{"block-headings":true,"bibliography":["references.bib"]},"extensions":{"book":{"selfContainedOutput":true}}}},"projectFormats":["html","pdf"]}