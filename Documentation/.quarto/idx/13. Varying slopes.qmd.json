{"title":"Varying slopes","markdown":{"headingText":"Varying slopes","containsRefs":false,"markdown":"\n## General Principles\n\nTo model the relationship between predictor variables and an independent variable while allowing for varying effects across groups or clusters, we use a *Varying slopes* model.\n\nThis approach is useful when we expect the relationship between predictors and the independent variable to differ across groups (e.g., different slopes for different subjects, locations, or time periods).This allow every unit in the data to have its own unique response to any treatment or exposure or event, while also improving estimates via pooling.\n\n## Considerations\n::: callout-caution \n-   We have the same considerations as for [12. Varying interceps](12.%20Varying%20intercepts.qmd).\n\n-  The idea is pretty similar to categorical models, where a slope is specified for each category. However, here, we also estimate relationships between different groups. This leads to a different mathematical approach, as to model these relationships between groups, we model a [<span style=\"color:#0D6EFD\"> matrix of covariance üõà</span>]{#cov}.\n\n-  The covariance matrix requiere a correlation matrix distribution that require certain characteristics: \n   -  1) Values range between -1 and 1,  \n   -  2) The diagonal entries are all 1\n   -  3) The matrix need to be [<span style=\"color:#0D6EFD\"> positive semi-definite  üõà</span>]{#PSD}.\n  \n- To satisfy those requirements for the correlation matrix we use a  [<span style=\"color:#0D6EFD\"> $LKJ$ correlation matrix üõà</span>]{#lkj} that hold a concentration parameter $Œ∑$. $Œ∑$ specify the strength of expected correlations : \n  - $Œ∑ = 1$  for uniform prior over all possible correlation matrices, allowing any correlation from -1 to 1 with equal probability.\n  - $Œ∑ < 1$ for extreme correlations (close to -1 or 1), leading to a higher probability of observing very strong correlations.\n  - $Œ∑>1$ for weaker correlations (closer to 0). Higher values increasingly concentrate probability mass around zero correlation:\n    - $Œ∑=2$ Moderately favors weak correlations.\n    - $ùúÇ‚â•5$ Strongly favors very weak correlations, pushing the matrix toward values close to zero correlation (near-independence).\n  \n- $Œ∑$ is ussually set to 2 to define a weakly informative prior.\n\n- As $LKJ$ correlation matrix optimize computation it ussually prefered over a  [<span style=\"color:#0D6EFD\"> $multivariate$ normal distribution üõà</span>]{#mvn} prior for the covariance matrix.\n\n:::\n\n## Example\n\nm.data('Sim data multivariatenormal.csv', sep=',') \nBelow is an example code snippet demonstrating Bayesian regression with varying effects. Data represent a continuous dependent variable $wait$ which represent the waiting time to get surv in coffe shops in a city. The independent variables is $afternoon$ which represent the period of the day (morning, afternoon) for the observed waiting time. As different coffee shops have been observed we also have their ID $cafe$ and the number of coffee shops observed $N_cafes$. The goal is to estimate the relationship between the period of the day and the waiting time while concidering that each cafe can have its unique response (i.e.,account for repreated measurment in cafe).\n\n### Simulated data\n\n::: {.panel-tabset group=\"language\"}\n## Python\n``` python\nfrom main import*\n# Setup device------------------------------------------------\nm = bi(platform='cpu')\n\n# Import Data & Data Manipulation ------------------------------------------------\nm.data('ressources/data/Sim data multivariatenormal.csv', sep=',') # Import\nm.data.to_model(['cafe', 'wait', 'N_cafes']) # Send to model (convert to jax array)\n\n# Define model ------------------------------------------------\n\ndef model(cafe, wait, N_cafes):\n    a = dist.normal(5, 2, name = 'a') #Standard Normal Vector \n    b = dist.normal(-1, 0.5, name = 'b') # Standard Normal Vector \n    sigma_cafe = dist.exponential(1, shape=[2], name = 'sigma_cafe')\n\n    # Covariance matrix\n    sigma = dist.exponential( 1, name = 'sigma') # standard deviations for each variable\n    Rho = dist.lkj(2, 2, name = 'Rho') # LKJ correlations matrix\n    # This operation ensures that each variable's correlation structure is properly scaled by its standard deviation. This makes it possible to account for both correlations and individual variability when generating samples.\n    cov = jnp.outer(sigma_cafe, sigma_cafe) * Rho \n    #This operation applies the correlation and standard deviation structure (encoded in scaled_sr_L) to the standard normal variables b and b. T\n    a_cafe_b_cafe = (jnp.outer(sigma_cafe, sigma_cafe) * Rho) @ jnp.stack([a, b])    \n\n    \n    a_cafe, b_cafe = a_cafe_b_cafe[:, 0], a_cafe_b_cafe[:, 1]\n    mu = a_cafe[cafe] + b_cafe[cafe] * afternoon\n    lk(\"y\", Normal(mu, sigma), obs=wait)\n\n# Run mcmc ------------------------------------------------\nm.run(model) # Optimize model parameters through MCMC sampling\n\n# Summary ------------------------------------------------\nm.sampler.print_summary(0.89) # Get posterior distributions\n```\n\n## R\n``` R\n```\n:::\n\n\n## Mathematical Details\n\n### *Formula*\n\nWe model the relationship between the independent variable $X$ and the outcome variable *Y* with varying intercepts $\\alpha$ and varying slopes $\\beta$  for each group $k$ (e.g., coffe shops) using the following equation:\n\n$$\nY_{ik} = \\alpha_k + \\beta_k X_{ik} + \\sigma\n$$\n\nWhere: \n- $Y_{ik}$ is the outcome variable for observation *i* in group *k*. \n  \n-  $X_{ik}$ is the independent variables for observation *i* in group *k*. \n  \n-  $\\alpha_k$ is the varying intercept for group *k*.\n  \n-  $\\beta_k$ is the varying regression coefficients for group *k*. \n\n- $\\sigma$ is the error term, assumed to be strictly positive.\n\n### *Bayesian model*\n\nWe can express the Bayesian regression model accounting for prior distribution as follows:\n\n$$\nY_{ik} \\sim \\text{Normal}(\\mu_{ik} , \\sigma)\n$$\n$$\n\\mu_{ik} = \\alpha_k + \\beta_k X_{ik} + \\sigma \n$$\n$$\n\\alpha_k \\sim Normal(0,1) \n$$\n$$\n\\beta_k \\sim Normal(0,1)\n$$\n$$\n\\sigma \\sim Exponential(0,1)\n$$\n\nThe varying intercepts slopes ($\\alpha_k$) and ($\\beta_k$) can modeled using a *Multivariate Normal distribution*:\n\n$$ \n\\begin{pmatrix} \n\\alpha_k \\\\ \n\\beta_k \n\\end{pmatrix} \\sim \\text{MultivariateNormal}\\left( \n\\begin{pmatrix} \n0 \\\\ \n0 \n\\end{pmatrix}, \n\\begin{pmatrix} \n\\sigma_\\alpha^2 & \\sigma_\\pi \\sigma_{\\alpha\\rho} \\\\ \n\\sigma_\\alpha \\sigma_{\\pi\\rho} & \\sigma_\\pi \n\\end{pmatrix} \n\\right) \n$$\n\nWhere: \n\n- $\\left(\\begin{array}{cc} 0 \\\\0\\end{array}\\right)$ is the prior for average intercept.\n\n-  $\\left(\\begin{array}{cc} \\sigma_\\alpha^2 & \\sigma_\\pi\\sigma_{\\alpha\\rho} \\\\ \\sigma_\\alpha\\sigma_{\\pi\\rho} & \\sigma_\\pi \\end{array}\\right)$ is is the covariance matrix which specifies the variance and covariance of $\\alpha_k$ and $\\beta_k$, \n  \n-  where: - $\\sigma_\\alpha^2$ The variance of $\\alpha_k$. \n  \n- $\\sigma_\\pi^2$ The variance of $\\beta_k$. \n  \n-  $\\sigma_\\pi\\sigma_{\\alpha\\rho}$ and $\\sigma_\\alpha\\sigma_{\\pi\\rho}$ The covariance between $\\alpha_k$ and $\\beta_k$\n\nBut as discuss in the [Concideration](#considerations) section, for computational reasons, it is often better to implement a [<span style=\"color:#0D6EFD\">centered version of the varying intercept üõà</span>]{#centerRF} that use the $Lkj$ correlation matrix:\n\n$$\n\\left(\\begin{array}{cc} \\alpha_k \\\\ \\beta_k\\end{array}\\right)\n \\sim \n\\left(\\begin{array}{cc} \n\\sigma_\\alpha\\\\\n\\sigma_\\pi\n\\end{array}\\right) \\circ \nL *\n\\left(\\begin{array}{cc} \n\\widehat{\\alpha}_k \\\\\n\\widehat{\\pi}_k\n\\end{array}\\right)\n$$\n\n-   Where:\n\n    -   $\\sigma_\\alpha \\sim Exponential(1)$ bewing the prior standard deviation among intercepts.\n  \n    -   $\\sigma_\\beta \\sim Exponential(1)$ bewing the prior standard deviation among slopes.\n  \n    -   $L \\sim LKJcorr(Œ∑)$ bewing the prior for the correlation matrix using the [<span style=\"color:#0D6EFD\">Cholesky Factor üõà</span>]{#chol}.\n  \n:::::: {.callout-note}\n\nTechnically, we are scaling the Cholesky Factor by the standard deviations through the dot product $\\circ$:\n$$\ncov = \\binom{\\sigma_\\alpha}{\\sigma_\\pi} \\circ L \n$$\n\nThis operation ensures that each variable's correlation structure is properly scaled by its standard deviation. This makes it possible to account for both correlations and individual variability when generating samples. It is the equivalent of `cov = jnp.outer(sigma_cafe, sigma_cafe) * Rho` in the code snippet above.\n\nWe then applies the correlation and standard deviation structure (encoded in cov) to the standard normal variables. It is the equivalent of `a_cafe_b_cafe = (jnp.outer(sigma_cafe, sigma_cafe) * Rho) @ jnp.stack([a, b])` in the code snippet above:\n\n$$ \ncov * \\binom{\\widehat{\\alpha}_k}{\\widehat{\\pi}_k} \n$$\n\n:::\n\n\n\n\n\nThe full cetered version of the model is thus :\n\n$$\nY_{i} \\sim \\text{Normal}(\\mu_k , \\sigma) \\\\\n$$\n\n$$\n\\mu_k =   \\alpha_k + \\beta_i X_i \\\\\n$$\n\n$$\n\\left(\\begin{array}{cc} \\alpha_k \\\\ \\beta_k\\end{array}\\right)\n \\sim \n\\left(\\begin{array}{cc} \n\\sigma_\\alpha\\\\\n\\sigma_\\pi\n\\end{array}\\right) \\circ \nL *\n\\left(\\begin{array}{cc} \n\\widehat{\\alpha}_k \\\\\n\\widehat{\\pi}_k\n\\end{array}\\right)\n$$\n\n$$\n\\alpha \\sim Normal(0,1)\n$$\n$$\n\\beta \\sim Normal(0,1)\n$$\n$$\n\\sigma_\\alpha \\sim Exponential(1)\n$$\n$$\n\\sigma_\\pi \\sim Exponential(1)\n$$\n$$\nL \\sim LKJcorr(2)\n$$\n\n## Notes\n::: callout-note \n-   We can apply multivariate model similarly as [chapter 2](/2.%20Multiple%20Regression%20for%20Continuous%20Variables.qmd). In this case, we apply the same principle, but with a covariance matrix of a dimension equal to the number of varying slopes we define. For example, if we want to generate random slopes for $i$ actors in a model with two independent variables $X_1$ and $X_2$, we can define the formula as follows:\n\n$$\nY_{i} \\sim \\text{Normal}(\\mu_i , \\sigma) \n$$\n\n$$\n\\mu_i =   \\alpha_i + \\beta_{1i} X_{1i}  + \\beta_{2i} X_{2i} \n$$\n\n$$ \n\\begin{pmatrix} \n\\alpha_{i}\\\\ \n\\beta_{1i}\\\\ \n\\beta_{2i} \n\\end{pmatrix} \n\\sim \\begin{pmatrix} \n\\sigma_{\\alpha}\\\\ \n\\sigma_{\\pi}\\\\ \n\\sigma_{\\gamma} \n\\end{pmatrix} \\circ L \\cdot \\begin{pmatrix} \n\\widehat{\\alpha}_{k} \\\\ \n\\widehat{\\pi}_{k} \\\\ \n\\widehat{\\gamma}_{k} \n\\end{pmatrix} \n$$\n\n\n$$\n\\sigma_{\\alpha} \\sim Exponential(1)\n$$\n$$\n\\sigma_{\\pi} \\sim Exponential(1)\n$$\n$$\n\\sigma_{\\gamma} \\sim Exponential(1) \n$$\n$$\nL \\sim LKJcorr(2)\n$$\n\n-   We can apply interaction terms similarly as [chapter 3](\\3.%20Interaction%20between%20continuous%20variables.qmd).\n\n-   We can apply caterogical variables similarly as [chapter 4](4.%20Categorical%20variable.qmd).\n\n-   We can apply varying slopes with any distribution presented in previous chapters.\n\n-   For more than two varying effects we apply the same principel but with a covariance matrix for each varying effect that are summed to gernerat the varying intercept and slope. For exmaple, if we want to generate random slopes for $i$ actors, and $k$ groups we can define the formula as follow:\n\n$$\np(Y_{i} |\\mu_i , \\sigma) \\sim \\text{Normal}(\\mu_i , \\sigma) \\\\\n$$\n\n$$\n\\mu_i =   \\alpha_i + \\beta_{i} X_i \n$$\n$$\n\\alpha_i = \\alpha + \\alpha_{actor[i]} + \\alpha_{group[i]}\n$$\n$$\n\\beta_{i} = \\beta + \\beta_{actor[i]} + \\beta_{group[i]} \n$$\n\n$$\n\\alpha \\sim Normal(0,1)\n$$\n$$\n\\beta \\sim Normal(0,1) \n$$\n\n$$ \n\\begin{pmatrix} \n\\alpha_{\\text{actor}} \\\\ \n\\beta_{\\text{actor}} \n\\end{pmatrix} \n\\sim \n\\begin{pmatrix} \n\\sigma_{\\alpha a} \\\\ \n\\sigma_{\\pi a} \n\\end{pmatrix} \\circ L_a \\cdot \\begin{pmatrix} \n\\widehat{\\alpha}_{ka} \\\\ \n\\widehat{\\pi}_{ka} \n\\end{pmatrix} \n$$\n\n\n$$\n\\sigma_{\\alpha a} \\sim Exponential(1)\n$$\n$$\n\\sigma_{\\pi a} \\sim Exponential(1)\n$$\n$$\nL_{a} \\sim LKJcorr(2)\n$$\n\n$$ \n\\begin{pmatrix} \n\\alpha_{\\text{group}} \\\\ \n\\beta_{\\text{group}} \n\\end{pmatrix} \n\\sim  \n\\begin{pmatrix} \n\\sigma_{\\alpha g} \\\\ \n\\sigma_{\\pi g} \n\\end{pmatrix} \\circ L_g \\cdot \n\\begin{pmatrix} \n\\widehat{\\alpha}_{kg} \\\\ \n\\widehat{\\pi}_{kg} \n\\end{pmatrix} \n$$\n\n\n$$\n\\sigma_{\\alpha g} \\sim Exponential(1)\n$$\n$$\n\\sigma_{\\pi g} \\sim Exponential(1) \n$$\n$$\nL_{g} \\sim LKJcorr(2)\n$$\n\n-   Bellow the formula and the code snipset for a Binomial multivariate model with interaction between two independent variables $X_1$ and $X_2$ and multiples varying effects for each actor and each group:\n\n$$\np(Y_{i} |n , p_i) \\sim \\text{Binomial}(n = 1, p_i) \\\\\n$$\n\n$$\nlogit{p_i}=   \\alpha_i + (\\beta_{1i}  + \\beta_{2i} X_{2i})  X_{1i}\n$$\n$$\n\\alpha_i = \\alpha + \\alpha_{actor[i]} + \\alpha_{group[i]}\n$$\n$$\n\\beta_{1i} = \\beta + \\beta_{1 actor[i]} + \\beta_{ group[i]}\n$$\n$$\n\\beta_{2i} = \\beta + \\beta_{2 actor[i]} + \\beta_{2 group[i]}\n$$\n\n$$\n\\alpha \\sim Normal(0,1)\n$$\n$$\n\\beta \\sim Normal(0,1)\n$$\n\n$$ \n\\begin{pmatrix} \n\\alpha_{\\text{actor}} \\\\ \n\\beta_{1 \\, \\text{actor}} \\\\ \n\\beta_{2 \\, \\text{actor}} \n\\end{pmatrix} \n\\sim  \n\\begin{pmatrix} \n\\sigma_{\\alpha a} \\\\ \n\\sigma_{\\pi a} \\\\ \n\\sigma_{\\gamma a} \n\\end{pmatrix} \\circ L_a \\cdot \n\\begin{pmatrix} \n\\widehat{\\alpha}_{ka} \\\\ \n\\widehat{\\pi}_{ka} \\\\ \n\\widehat{\\gamma}_{ka} \n\\end{pmatrix} \n$$\n\n\n$$\n\\sigma_{\\alpha a} \\sim Exponential(1) \n$$\n\n$$\n\\sigma_{\\pi a} \\sim Exponential(1) \n$$\n$$\n\\sigma_{\\gamma a} \\sim Exponential(1) \n$$\n$$\nL_{a} \\sim LKJcorr(2)\n$$\n\n$$ \n\\begin{pmatrix} \n\\alpha_{\\text{group}} \\\\ \n\\beta_{1 \\, \\text{group}} \\\\ \n\\beta_{2 \\, \\text{group}} \n\\end{pmatrix} \n\\sim  \n\\begin{pmatrix} \n\\sigma_{\\alpha g} \\\\ \n\\sigma_{\\pi g} \\\\ \n\\sigma_{\\gamma g} \n\\end{pmatrix} \\circ L_g \\cdot \n\\begin{pmatrix} \n\\widehat{\\alpha}_{kg} \\\\ \n\\widehat{\\pi}_{kg} \\\\ \n\\widehat{\\gamma}_{kg} \n\\end{pmatrix} \n$$\n\n\n$$\n\\sigma_{\\alpha g} \\sim Exponential(1)\n$$\n$$\n\\sigma_{\\pi g} \\sim Exponential(1) \n$$\n$$\n\\sigma_{\\gamma g} \\sim Exponential(1)\n$$\n$$\nL_{g} \\sim LKJcorr(2)\n$$\n\n```python\nfrom main import*\n# Setup device------------------------------------------------\nm = bi(platform='cpu')\n# Import data\nm.read_csv(\"../data/chimpanzees.csv\", sep=\";\")\nm.df[\"block_id\"] = m.df.block\nm.df[\"treatment\"] = 1 + m.df.prosoc_left + 2 * m.df.condition\nm.data_to_model(['pulled_left', 'treatment', 'actor', 'block_id'])\n\n\ndef model(tid, actor, block_id, L=None, link=False):\n    # fixed priors\n    g = dist.normal(0, 1, name = 'g', shape = (4,))\n    sigma_actor = dist.exponential(1, name = 'sigma_actor', shape = (4,))\n    L_Rho_actor = dist.lkjcholesky(4, 2, name = \"L_Rho_actor\")\n    sigma_block = dist.exponential(1, name = \"sigma_block\", shape = (4,))\n    L_Rho_block = dist.lkjcholesky(4, 2, name = \"L_Rho_block\")\n\n    # adaptive priors - non-centered\n    z_actor = dist.normal(0, 1, name = \"z_actor\", shape = (4,7))\n    z_block = dist.normal(0, 1, name = \"z_block\", shape = (4,3))\n    alpha = deterministic(\n        \"alpha\", ((sigma_actor[..., None] * L_Rho_actor) @ z_actor).T\n    )\n    beta = deterministic(\n        \"beta\", ((sigma_block[..., None] * L_Rho_block) @ z_block).T\n    )\n\n    logit_p = g[tid] + alpha[actor, tid] + beta[block_id, tid]\n    dist(\"L\", dist.Binomial(logits=logit_p), obs=L)\n\n    # compute ordinary correlation matrixes from Cholesky factors\n    if link:\n        deterministic(\"Rho_actor\", L_Rho_actor @ L_Rho_actor.T)\n        deterministic(\"Rho_block\", L_Rho_block @ L_Rho_block.T)\n        deterministic(\"p\", expit(logit_p))\n\n# Run mcmc ------------------------------------------------\nm.run(model) \n\n# Summary ------------------------------------------------\nm.sampler.print_summary(0.89)\n```\n:::\n## Reference(s)\n\n@mcelreath2018statistical","srcMarkdownNoYaml":""},"formats":{"html":{"identifier":{"display-name":"HTML","target-format":"html","base-format":"html"},"execute":{"fig-width":7,"fig-height":5,"fig-format":"retina","fig-dpi":96,"df-print":"default","error":false,"eval":true,"cache":null,"freeze":false,"echo":true,"output":true,"warning":true,"include":true,"keep-md":false,"keep-ipynb":false,"ipynb":null,"enabled":null,"daemon":null,"daemon-restart":false,"debug":false,"ipynb-filters":[],"ipynb-shell-interactivity":null,"plotly-connected":true,"engine":"markdown"},"render":{"keep-tex":false,"keep-typ":false,"keep-source":false,"keep-hidden":false,"prefer-html":false,"output-divs":true,"output-ext":"html","fig-align":"default","fig-pos":null,"fig-env":null,"code-fold":"none","code-overflow":"scroll","code-link":false,"code-line-numbers":false,"code-tools":false,"tbl-colwidths":"auto","merge-includes":true,"inline-includes":false,"preserve-yaml":false,"latex-auto-mk":true,"latex-auto-install":true,"latex-clean":true,"latex-min-runs":1,"latex-max-runs":10,"latex-makeindex":"makeindex","latex-makeindex-opts":[],"latex-tlmgr-opts":[],"latex-input-paths":[],"latex-output-dir":null,"link-external-icon":false,"link-external-newwindow":false,"self-contained-math":false,"format-resources":[],"notebook-links":true},"pandoc":{"standalone":true,"wrap":"none","default-image-extension":"png","to":"html","highlight-style":"monokai","include-after-body":["tooltip-scripts.html"],"output-file":"13. Varying slopes.html"},"language":{"toc-title-document":"Table of contents","toc-title-website":"On this page","related-formats-title":"Other Formats","related-notebooks-title":"Notebooks","source-notebooks-prefix":"Source","other-links-title":"Other Links","code-links-title":"Code Links","launch-dev-container-title":"Launch Dev Container","launch-binder-title":"Launch Binder","article-notebook-label":"Article Notebook","notebook-preview-download":"Download Notebook","notebook-preview-download-src":"Download Source","notebook-preview-back":"Back to Article","manuscript-meca-bundle":"MECA Bundle","section-title-abstract":"Abstract","section-title-appendices":"Appendices","section-title-footnotes":"Footnotes","section-title-references":"References","section-title-reuse":"Reuse","section-title-copyright":"Copyright","section-title-citation":"Citation","appendix-attribution-cite-as":"For attribution, please cite this work as:","appendix-attribution-bibtex":"BibTeX citation:","appendix-view-license":"View License","title-block-author-single":"Author","title-block-author-plural":"Authors","title-block-affiliation-single":"Affiliation","title-block-affiliation-plural":"Affiliations","title-block-published":"Published","title-block-modified":"Modified","title-block-keywords":"Keywords","callout-tip-title":"Tip","callout-note-title":"Note","callout-warning-title":"Warning","callout-important-title":"Important","callout-caution-title":"Caution","code-summary":"Code","code-tools-menu-caption":"Code","code-tools-show-all-code":"Show All Code","code-tools-hide-all-code":"Hide All Code","code-tools-view-source":"View Source","code-tools-source-code":"Source Code","tools-share":"Share","tools-download":"Download","code-line":"Line","code-lines":"Lines","copy-button-tooltip":"Copy to Clipboard","copy-button-tooltip-success":"Copied!","repo-action-links-edit":"Edit this page","repo-action-links-source":"View source","repo-action-links-issue":"Report an issue","back-to-top":"Back to top","search-no-results-text":"No results","search-matching-documents-text":"matching documents","search-copy-link-title":"Copy link to search","search-hide-matches-text":"Hide additional matches","search-more-match-text":"more match in this document","search-more-matches-text":"more matches in this document","search-clear-button-title":"Clear","search-text-placeholder":"","search-detached-cancel-button-title":"Cancel","search-submit-button-title":"Submit","search-label":"Search","toggle-section":"Toggle section","toggle-sidebar":"Toggle sidebar navigation","toggle-dark-mode":"Toggle dark mode","toggle-reader-mode":"Toggle reader mode","toggle-navigation":"Toggle navigation","crossref-fig-title":"Figure","crossref-tbl-title":"Table","crossref-lst-title":"Listing","crossref-thm-title":"Theorem","crossref-lem-title":"Lemma","crossref-cor-title":"Corollary","crossref-prp-title":"Proposition","crossref-cnj-title":"Conjecture","crossref-def-title":"Definition","crossref-exm-title":"Example","crossref-exr-title":"Exercise","crossref-ch-prefix":"Chapter","crossref-apx-prefix":"Appendix","crossref-sec-prefix":"Section","crossref-eq-prefix":"Equation","crossref-lof-title":"List of Figures","crossref-lot-title":"List of Tables","crossref-lol-title":"List of Listings","environment-proof-title":"Proof","environment-remark-title":"Remark","environment-solution-title":"Solution","listing-page-order-by":"Order By","listing-page-order-by-default":"Default","listing-page-order-by-date-asc":"Oldest","listing-page-order-by-date-desc":"Newest","listing-page-order-by-number-desc":"High to Low","listing-page-order-by-number-asc":"Low to High","listing-page-field-date":"Date","listing-page-field-title":"Title","listing-page-field-description":"Description","listing-page-field-author":"Author","listing-page-field-filename":"File Name","listing-page-field-filemodified":"Modified","listing-page-field-subtitle":"Subtitle","listing-page-field-readingtime":"Reading Time","listing-page-field-wordcount":"Word Count","listing-page-field-categories":"Categories","listing-page-minutes-compact":"{0} min","listing-page-category-all":"All","listing-page-no-matches":"No matching items","listing-page-words":"{0} words","listing-page-filter":"Filter","draft":"Draft"},"metadata":{"lang":"en","fig-responsive":true,"quarto-version":"1.5.57","bibliography":["references.bib"],"theme":"Morph","backgroundcolor":"#ffffff","code-copy":true},"extensions":{"book":{"multiFile":true}}},"pdf":{"identifier":{"display-name":"PDF","target-format":"pdf","base-format":"pdf"},"execute":{"fig-width":5.5,"fig-height":3.5,"fig-format":"pdf","fig-dpi":300,"df-print":"default","error":false,"eval":true,"cache":null,"freeze":false,"echo":true,"output":true,"warning":true,"include":true,"keep-md":false,"keep-ipynb":false,"ipynb":null,"enabled":null,"daemon":null,"daemon-restart":false,"debug":false,"ipynb-filters":[],"ipynb-shell-interactivity":null,"plotly-connected":true,"engine":"markdown"},"render":{"keep-tex":false,"keep-typ":false,"keep-source":false,"keep-hidden":false,"prefer-html":false,"output-divs":true,"output-ext":"pdf","fig-align":"default","fig-pos":null,"fig-env":null,"code-fold":"none","code-overflow":"scroll","code-link":false,"code-line-numbers":false,"code-tools":false,"tbl-colwidths":true,"merge-includes":true,"inline-includes":false,"preserve-yaml":false,"latex-auto-mk":true,"latex-auto-install":true,"latex-clean":true,"latex-min-runs":1,"latex-max-runs":10,"latex-makeindex":"makeindex","latex-makeindex-opts":[],"latex-tlmgr-opts":[],"latex-input-paths":[],"latex-output-dir":null,"link-external-icon":false,"link-external-newwindow":false,"self-contained-math":false,"format-resources":[]},"pandoc":{"pdf-engine":"xelatex","standalone":true,"variables":{"graphics":true,"tables":true},"default-image-extension":"pdf","to":"pdf","output-file":"13. Varying slopes.pdf"},"language":{"toc-title-document":"Table of contents","toc-title-website":"On this page","related-formats-title":"Other Formats","related-notebooks-title":"Notebooks","source-notebooks-prefix":"Source","other-links-title":"Other Links","code-links-title":"Code Links","launch-dev-container-title":"Launch Dev Container","launch-binder-title":"Launch Binder","article-notebook-label":"Article Notebook","notebook-preview-download":"Download Notebook","notebook-preview-download-src":"Download Source","notebook-preview-back":"Back to Article","manuscript-meca-bundle":"MECA Bundle","section-title-abstract":"Abstract","section-title-appendices":"Appendices","section-title-footnotes":"Footnotes","section-title-references":"References","section-title-reuse":"Reuse","section-title-copyright":"Copyright","section-title-citation":"Citation","appendix-attribution-cite-as":"For attribution, please cite this work as:","appendix-attribution-bibtex":"BibTeX citation:","appendix-view-license":"View License","title-block-author-single":"Author","title-block-author-plural":"Authors","title-block-affiliation-single":"Affiliation","title-block-affiliation-plural":"Affiliations","title-block-published":"Published","title-block-modified":"Modified","title-block-keywords":"Keywords","callout-tip-title":"Tip","callout-note-title":"Note","callout-warning-title":"Warning","callout-important-title":"Important","callout-caution-title":"Caution","code-summary":"Code","code-tools-menu-caption":"Code","code-tools-show-all-code":"Show All Code","code-tools-hide-all-code":"Hide All Code","code-tools-view-source":"View Source","code-tools-source-code":"Source Code","tools-share":"Share","tools-download":"Download","code-line":"Line","code-lines":"Lines","copy-button-tooltip":"Copy to Clipboard","copy-button-tooltip-success":"Copied!","repo-action-links-edit":"Edit this page","repo-action-links-source":"View source","repo-action-links-issue":"Report an issue","back-to-top":"Back to top","search-no-results-text":"No results","search-matching-documents-text":"matching documents","search-copy-link-title":"Copy link to search","search-hide-matches-text":"Hide additional matches","search-more-match-text":"more match in this document","search-more-matches-text":"more matches in this document","search-clear-button-title":"Clear","search-text-placeholder":"","search-detached-cancel-button-title":"Cancel","search-submit-button-title":"Submit","search-label":"Search","toggle-section":"Toggle section","toggle-sidebar":"Toggle sidebar navigation","toggle-dark-mode":"Toggle dark mode","toggle-reader-mode":"Toggle reader mode","toggle-navigation":"Toggle navigation","crossref-fig-title":"Figure","crossref-tbl-title":"Table","crossref-lst-title":"Listing","crossref-thm-title":"Theorem","crossref-lem-title":"Lemma","crossref-cor-title":"Corollary","crossref-prp-title":"Proposition","crossref-cnj-title":"Conjecture","crossref-def-title":"Definition","crossref-exm-title":"Example","crossref-exr-title":"Exercise","crossref-ch-prefix":"Chapter","crossref-apx-prefix":"Appendix","crossref-sec-prefix":"Section","crossref-eq-prefix":"Equation","crossref-lof-title":"List of Figures","crossref-lot-title":"List of Tables","crossref-lol-title":"List of Listings","environment-proof-title":"Proof","environment-remark-title":"Remark","environment-solution-title":"Solution","listing-page-order-by":"Order By","listing-page-order-by-default":"Default","listing-page-order-by-date-asc":"Oldest","listing-page-order-by-date-desc":"Newest","listing-page-order-by-number-desc":"High to Low","listing-page-order-by-number-asc":"Low to High","listing-page-field-date":"Date","listing-page-field-title":"Title","listing-page-field-description":"Description","listing-page-field-author":"Author","listing-page-field-filename":"File Name","listing-page-field-filemodified":"Modified","listing-page-field-subtitle":"Subtitle","listing-page-field-readingtime":"Reading Time","listing-page-field-wordcount":"Word Count","listing-page-field-categories":"Categories","listing-page-minutes-compact":"{0} min","listing-page-category-all":"All","listing-page-no-matches":"No matching items","listing-page-words":"{0} words","listing-page-filter":"Filter","draft":"Draft"},"metadata":{"block-headings":true,"bibliography":["references.bib"]},"extensions":{"book":{"selfContainedOutput":true}}}},"projectFormats":["html","pdf"]}