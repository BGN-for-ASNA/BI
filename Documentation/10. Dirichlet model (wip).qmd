
# Dirichlet Model
## General Principles
To model the relationship between a categorical outcome variable with more than two categories and one or more independent variables with [<span style="color:#0D6EFD">overdispersion ðŸ›ˆ</span>]{#overdispersion}, we can use a _Dirichlet_ model.

![](https://statstest.b-cdn.net/wp-content/uploads/2020/05/Multinomial-Logistic-Regression-1.jpg)

## Considerations
::: callout-caution 
- We have the same considerations as for the [Multinomial model](7.&#32;Multinomial&#32;model.qmd).

- One major difference from the multinomial model is that the Dirichlet model doesnâ€™t require a simplex but rather strictly positive values. We can thus exponentiate the outputs from the categorical regressions instead of using the softmax function.
- 
:::

## Example
```python
# Simulated data--------------------------------------------------------------------------
# simulate career choices among 500 individuals
N = 500  # number of individuals
income = jnp.array([1, 2, 5])  # expected income of each career
score = 0.5 * income  # scores for each career, based on income

# next line converts scores to probabilities
p = jnp.array(jax.nn.softmax(score))

# now simulate choice
# outcome career holds event type values, not counts
career = bi.dist.categorical(p, shape=N, sample=True)
m.data_on_model = dict(
    income=income,
    career=career
)
d.to_csv('Sim data multinomial.csv')

# Define model ------------------------------------------------
def model(income, career):
    # Parameters priors distributions
    alpha = dist.normal(0, 1, shape=[2], name='a')
    beta = dist.halfnormal(0.5, shape=[1], name='b')
    s_1 = alpha[0] + beta * income[0]
    s_2 = alpha[1] + beta * income[1]
    s_3 = alpha[0] + beta * income[0]
    p = jax.nn.exp(jnp.stack([s_1[0], s_2[0], s_3[0]]))
    # Likelihood
    lk("y", DirichletMultinomial(probs=p[career]), obs=career)
# Run sampler ------------------------------------------------ 
m.run(model)  

# Summary ------------------------------------------------
m.sampler.print_summary(0.89)
```

## Mathematical Details
### *Formula*

### *Bayesian Model*
In the Bayesian formulation, we define each parameter with [<span style="color:#0D6EFD">priors ðŸ›ˆ</span>]{#prior}. We can express the Bayesian regression model accounting for prior distribution as follows:

## Reference(s)
@mcelreath2018statistical

