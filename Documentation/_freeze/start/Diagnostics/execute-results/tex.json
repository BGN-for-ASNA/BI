{
  "hash": "55e7ac680a567c7c070c9858a33a94ff",
  "result": {
    "engine": "jupyter",
    "markdown": "---\ntitle: \"Model Diagnostic\"\nsidebar: start\n---\n\n\n\n\n\n\nThe BI class can compute model diagnostics for a given model.\n\nLets concider the following model for a linear regression:\n\n$$\nY_i \\sim \\text{Normal}(\\alpha + \\beta   X_i, \\sigma)\n$$\n\n$$\n\\alpha \\sim \\text{Normal}(0, 1)\n$$\n\n$$\n\\beta \\sim \\text{Normal}(0, 1)\n$$\n\n$$\n\\sigma \\sim \\text{Uniform}(0, 50)\n$$\n\n::: {.cell execution_count=1}\n``` {.python .cell-code}\nfrom BI import bi\nimport jax.numpy as jnp\n# setup platform------------------------------------------------\nm = bi(platform='cpu')\n\n# import data ------------------------------------------------\nm.data('Howell1.csv', sep=';') \nm.df = m.df[m.df.age > 18]\nm.scale(data=['weight'])\n\n\n # define model ------------------------------------------------\ndef model(weight, height):    \n    a = m.dist.normal( 178, 20, name = 'a')\n    b = m.dist.log_normal(  0, 1, name = 'b')   \n    s = m.dist.uniform( 0, 50, name = 's')\n    m.dist.normal(a + b * weight , s, obs=height, shape=(weight.shape[0],))\n\n# Run sampler ------------------------------------------------\nm.fit(model, num_samples=500,num_chains=4) \nm.summary()\n```\n\n::: {.cell-output .cell-output-stderr}\n```\nWARNING:2025-09-25 08:49:50,208:jax._src.xla_bridge:794: An NVIDIA GPU may be present on this machine, but a CUDA-enabled jaxlib is not installed. Falling back to cpu.\n```\n:::\n\n::: {.cell-output .cell-output-stdout}\n```\njax.local_device_count 32\n```\n:::\n\n::: {.cell-output .cell-output-display}\n```\n  0%|          | 0/1000 [00:00<?, ?it/s]\n```\n:::\n\n::: {.cell-output .cell-output-display}\n```\n  0%|          | 0/1000 [00:00<?, ?it/s]\n```\n:::\n\n::: {.cell-output .cell-output-display}\n```\n  0%|          | 0/1000 [00:00<?, ?it/s]\n```\n:::\n\n::: {.cell-output .cell-output-display}\n```\n  0%|          | 0/1000 [00:00<?, ?it/s]\n```\n:::\n\n::: {.cell-output .cell-output-display execution_count=1}\n```{=html}\n<div>\n<style scoped>\n    .dataframe tbody tr th:only-of-type {\n        vertical-align: middle;\n    }\n\n    .dataframe tbody tr th {\n        vertical-align: top;\n    }\n\n    .dataframe thead th {\n        text-align: right;\n    }\n</style>\n<table border=\"1\" class=\"dataframe\">\n  <thead>\n    <tr style=\"text-align: right;\">\n      <th></th>\n      <th>mean</th>\n      <th>sd</th>\n      <th>hdi_5.5%</th>\n      <th>hdi_94.5%</th>\n      <th>mcse_mean</th>\n      <th>mcse_sd</th>\n      <th>ess_bulk</th>\n      <th>ess_tail</th>\n      <th>r_hat</th>\n    </tr>\n  </thead>\n  <tbody>\n    <tr>\n      <th>a</th>\n      <td>154.66</td>\n      <td>0.28</td>\n      <td>154.22</td>\n      <td>155.11</td>\n      <td>0.01</td>\n      <td>0.01</td>\n      <td>1912.82</td>\n      <td>1630.66</td>\n      <td>1.0</td>\n    </tr>\n    <tr>\n      <th>b</th>\n      <td>5.80</td>\n      <td>0.28</td>\n      <td>5.38</td>\n      <td>6.25</td>\n      <td>0.01</td>\n      <td>0.01</td>\n      <td>1779.03</td>\n      <td>1519.74</td>\n      <td>1.0</td>\n    </tr>\n    <tr>\n      <th>s</th>\n      <td>5.14</td>\n      <td>0.20</td>\n      <td>4.81</td>\n      <td>5.47</td>\n      <td>0.00</td>\n      <td>0.00</td>\n      <td>2005.82</td>\n      <td>1068.71</td>\n      <td>1.0</td>\n    </tr>\n  </tbody>\n</table>\n</div>\n```\n:::\n:::\n\n\n# List of all available diagnostics\n\nFor additional documentation check the [diagnostics API reference](../api_diag.qmd)\n\n## Predictions from model base on specific data value\n\n::: {.cell execution_count=2}\n``` {.python .cell-code}\nm.sample() # Predictions from model base on data in data_on_model\nm.sample(data=dict(weight=jnp.array([0.4])), remove_obs=False)# Predictions from a given value\n```\n\n::: {.cell-output .cell-output-display execution_count=2}\n```\n{'x': Array([149.77945571], dtype=float64)}\n```\n:::\n:::\n\n\n## Forest plot of estimated values\n\n::: {.cell execution_count=3}\n``` {.python .cell-code}\nm.diag.forest()\n```\n\n::: {.cell-output .cell-output-display}\n```\nUnable to display output for mime type(s): text/html\n```\n:::\n\n::: {.cell-output .cell-output-display}\n```\nUnable to display output for mime type(s): text/html\n```\n:::\n:::\n\n\n## Density plots of the posterior distribution\n\n::: {.cell execution_count=4}\n``` {.python .cell-code}\nm.diag.density()\n```\n\n::: {.cell-output .cell-output-display}\n```\nUnable to display output for mime type(s): text/html\n```\n:::\n:::\n\n\n## Posterior distribution plots\n\n::: {.cell execution_count=5}\n``` {.python .cell-code}\nm.diag.posterior()\n```\n\n::: {.cell-output .cell-output-display}\n```\nUnable to display output for mime type(s): text/html\n```\n:::\n:::\n\n\n## Trace plots for MCMC chains\n\n::: {.cell execution_count=6}\n``` {.python .cell-code}\nm.diag.plot_trace()\n```\n\n::: {.cell-output .cell-output-display}\n```\nUnable to display output for mime type(s): text/html\n```\n:::\n:::\n\n\n## Pairwise plots of the posterior distribution\n\n::: {.cell execution_count=7}\n``` {.python .cell-code}\nm.diag.pair()\n```\n\n::: {.cell-output .cell-output-display}\n```\nUnable to display output for mime type(s): text/html\n```\n:::\n:::\n\n\n## Plot autocorrelation of the MCMC chains\n\n::: {.cell execution_count=8}\n``` {.python .cell-code}\nm.diag.autocor()\n```\n\n::: {.cell-output .cell-output-display}\n```\nUnable to display output for mime type(s): text/html\n```\n:::\n:::\n\n\n## Create rank plots for MCMC chains\n\n::: {.cell execution_count=9}\n``` {.python .cell-code}\nm.diag.rank()\n```\n\n::: {.cell-output .cell-output-display}\n![](Diagnostics_files/figure-pdf/cell-10-output-1.pdf){fig-pos='H'}\n:::\n:::\n\n\n## Evolution of effective sample size across iterations\n\n::: {.cell execution_count=10}\n``` {.python .cell-code}\nm.diag.plot_ess()\n```\n\n::: {.cell-output .cell-output-display}\n![](Diagnostics_files/figure-pdf/cell-11-output-1.pdf){fig-pos='H'}\n:::\n:::\n\n\n## Pareto-smoothed\n\n::: {.cell execution_count=11}\n``` {.python .cell-code}\nm.diag.loo()\n```\n\n::: {.cell-output .cell-output-display execution_count=11}\n```\nComputed from 2000 posterior samples and 346 observations log-likelihood matrix.\n\n         Estimate       SE\nelpd_loo -1058.52    14.68\np_loo        3.23        -\n------\n\nPareto k diagnostic values:\n                         Count   Pct.\n(-Inf, 0.70]   (good)      346  100.0%\n   (0.70, 1]   (bad)         0    0.0%\n   (1, Inf)   (very bad)    0    0.0%\n```\n:::\n:::\n\n\n##  Widely applicable information criterion\n\n::: {.cell execution_count=12}\n``` {.python .cell-code}\nm.diag.WAIC()\n```\n\n::: {.cell-output .cell-output-display execution_count=12}\n```\nComputed from 2000 posterior samples and 346 observations log-likelihood matrix.\n\n          Estimate       SE\nelpd_waic -1058.51    14.68\np_waic        3.21        -\n```\n:::\n:::\n\n\n",
    "supporting": [
      "Diagnostics_files/figure-pdf"
    ],
    "filters": []
  }
}