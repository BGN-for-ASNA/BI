{
  "hash": "7d729973b8ddbeb7244952fa318beb6c",
  "result": {
    "engine": "jupyter",
    "markdown": "---\ntitle: \"Gamma-Poisson Model\"\ndescription: \"An extension of the Poisson model for count data that exhibits overdispersion.\"\ncategories: [Regression, Count Data, GLM]\nimage: \"Figures/8.png\"\norder: 10\n---\n\n## General Principles \nTo model the relationship between a count outcome variable and one or more independent variables with [<span style=\"color:#0D6EFD\">overdispersion ðŸ›ˆ</span>]{#overdispersion}, we can use the _Negative Binomial model_. \n\n## Considerations\n::: callout-caution \n- We have the same considerations as for the [Poisson model](7.&#32;Poisson&#32;model.qmd).\n  \n- Overdispersion is handled because the Gamma-Poisson model assumes that each Poisson count observation has its own rate. This is an additional parameter specified in the model (in the code, it is `log_days`).\n:::\n \n## Example\nBelow is an example code snippet demonstrating a Bayesian Gamma-Poisson model using the Bayesian Inference (BI) package. \n\n::: {.panel-tabset group=\"language\"}\n### Python\n\n::: {.cell execution_count=1}\n``` {.python .cell-code}\nfrom BI import bi, jnp\n\n# Setup device ------------------------------------------------\nm = bi(platform='cpu') # Import\n\n# Import Data & Data Manipulation ------------------------------------------------\n# Import\nfrom importlib.resources import files\ndata_path = files('BI.resources.data') / 'Sim dat Gamma poisson.csv'\nm.data(data_path, sep=',') \nm.data_to_model(['log_days', 'monastery', 'y']) # Send to model (convert to jax array)\n\n# Define model ------------------------------------------------\ndef model(log_days, monastery, y):\n    a = m.dist.normal(0, 1, name = 'a', shape=(1,))\n    b = m.dist.normal(0, 1, name = 'b', shape=(1,))\n    phi = m.dist.exponential(1, name = 'phi', shape=(1,))\n    mu = jnp.exp(log_days + a + b * monastery)\n    Lambda =  m.dist.gamma(rate = mu*phi, concentration = phi, name = 'Lambda')\n    m.dist.poisson(rate = Lambda, obs=y)\n# Run MCMC ------------------------------------------------\nm.fit(model) # Optimize model parameters through MCMC sampling\n\n# Summary ------------------------------------------------\nm.summary() # Get posterior distributions\n```\n\n::: {.cell-output .cell-output-stdout}\n```\njax.local_device_count 16\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\n\r  0%|          | 0/1000 [00:00<?, ?it/s]\rwarmup:   0%|          | 1/1000 [00:01<30:28,  1.83s/it, 1 steps of size 2.34e+00. acc. prob=0.00]\rwarmup:   1%|          | 6/1000 [00:01<04:08,  4.00it/s, 511 steps of size 1.14e-02. acc. prob=0.43]\rwarmup:   1%|          | 9/1000 [00:02<02:37,  6.28it/s, 255 steps of size 2.33e-02. acc. prob=0.59]\rwarmup:   1%|          | 12/1000 [00:02<01:54,  8.62it/s, 255 steps of size 9.79e-03. acc. prob=0.62]\rwarmup:   2%|â–         | 16/1000 [00:02<01:30, 10.87it/s, 1023 steps of size 4.14e-03. acc. prob=0.64]\rwarmup:   2%|â–         | 19/1000 [00:02<01:17, 12.73it/s, 127 steps of size 2.52e-02. acc. prob=0.70] \rwarmup:   2%|â–         | 22/1000 [00:02<01:16, 12.71it/s, 511 steps of size 8.18e-03. acc. prob=0.69]\rwarmup:   2%|â–Ž         | 25/1000 [00:03<01:14, 13.14it/s, 1023 steps of size 3.45e-03. acc. prob=0.69]\rwarmup:   3%|â–Ž         | 27/1000 [00:03<01:10, 13.84it/s, 255 steps of size 1.12e-02. acc. prob=0.71] \rwarmup:   3%|â–Ž         | 31/1000 [00:03<00:54, 17.67it/s, 255 steps of size 1.43e-02. acc. prob=0.72]\rwarmup:   3%|â–Ž         | 34/1000 [00:03<01:00, 15.88it/s, 511 steps of size 5.87e-03. acc. prob=0.72]\rwarmup:   4%|â–Ž         | 37/1000 [00:03<00:52, 18.21it/s, 255 steps of size 1.05e-02. acc. prob=0.73]\rwarmup:   4%|â–         | 40/1000 [00:03<00:47, 20.24it/s, 511 steps of size 4.09e-03. acc. prob=0.72]\rwarmup:   4%|â–         | 44/1000 [00:03<00:41, 23.22it/s, 255 steps of size 6.81e-03. acc. prob=0.73]\rwarmup:   5%|â–         | 48/1000 [00:04<00:38, 24.48it/s, 511 steps of size 3.45e-03. acc. prob=0.73]\rwarmup:   5%|â–Œ         | 51/1000 [00:04<00:42, 22.41it/s, 127 steps of size 7.90e-03. acc. prob=0.74]\rwarmup:   6%|â–Œ         | 55/1000 [00:04<00:37, 24.89it/s, 127 steps of size 9.28e-03. acc. prob=0.74]\rwarmup:   6%|â–Œ         | 59/1000 [00:04<00:39, 23.87it/s, 511 steps of size 4.71e-03. acc. prob=0.74]\rwarmup:   6%|â–Œ         | 62/1000 [00:04<00:40, 23.43it/s, 58 steps of size 4.16e-03. acc. prob=0.74] \rwarmup:   6%|â–‹         | 65/1000 [00:04<00:40, 22.87it/s, 127 steps of size 1.21e-02. acc. prob=0.75]\rwarmup:   7%|â–‹         | 68/1000 [00:04<00:42, 22.15it/s, 255 steps of size 5.74e-03. acc. prob=0.75]\rwarmup:   7%|â–‹         | 73/1000 [00:05<00:39, 23.75it/s, 511 steps of size 3.49e-03. acc. prob=0.75]\rwarmup:   8%|â–Š         | 76/1000 [00:05<00:37, 24.34it/s, 127 steps of size 1.10e-02. acc. prob=0.76]\rwarmup:   8%|â–Š         | 79/1000 [00:05<00:38, 23.92it/s, 255 steps of size 5.91e-03. acc. prob=0.75]\rwarmup:   8%|â–Š         | 83/1000 [00:05<00:34, 26.27it/s, 255 steps of size 5.87e-03. acc. prob=0.75]\rwarmup:   9%|â–Š         | 87/1000 [00:05<00:32, 28.04it/s, 127 steps of size 3.71e-03. acc. prob=0.75]\rwarmup:   9%|â–‰         | 90/1000 [00:05<00:39, 22.87it/s, 511 steps of size 3.86e-03. acc. prob=0.75]\rwarmup:   9%|â–‰         | 93/1000 [00:05<00:39, 22.95it/s, 127 steps of size 1.03e-02. acc. prob=0.76]\rwarmup:  10%|â–‰         | 96/1000 [00:06<00:42, 21.31it/s, 255 steps of size 5.14e-03. acc. prob=0.76]\rwarmup:  10%|â–‰         | 99/1000 [00:06<00:43, 20.55it/s, 127 steps of size 6.86e-03. acc. prob=0.76]\rwarmup:  10%|â–ˆ         | 102/1000 [00:06<00:40, 22.13it/s, 31 steps of size 2.60e-01. acc. prob=0.77]\rwarmup:  11%|â–ˆ         | 112/1000 [00:06<00:23, 38.34it/s, 127 steps of size 6.13e-02. acc. prob=0.76]\rwarmup:  12%|â–ˆâ–        | 124/1000 [00:06<00:15, 56.69it/s, 31 steps of size 2.94e-01. acc. prob=0.77] \rwarmup:  14%|â–ˆâ–Ž        | 136/1000 [00:06<00:11, 72.37it/s, 15 steps of size 5.93e-02. acc. prob=0.77]\rwarmup:  14%|â–ˆâ–        | 144/1000 [00:06<00:11, 72.96it/s, 31 steps of size 9.61e-02. acc. prob=0.77]\rwarmup:  16%|â–ˆâ–Œ        | 156/1000 [00:06<00:10, 83.93it/s, 31 steps of size 1.77e-01. acc. prob=0.77]\rwarmup:  17%|â–ˆâ–‹        | 169/1000 [00:07<00:08, 93.31it/s, 63 steps of size 1.21e-01. acc. prob=0.77]\rwarmup:  18%|â–ˆâ–Š        | 180/1000 [00:07<00:08, 96.58it/s, 31 steps of size 1.91e-01. acc. prob=0.78]\rwarmup:  19%|â–ˆâ–‰        | 190/1000 [00:07<00:08, 96.69it/s, 31 steps of size 1.94e-01. acc. prob=0.78]\rwarmup:  20%|â–ˆâ–ˆ        | 202/1000 [00:07<00:07, 101.64it/s, 31 steps of size 1.72e-01. acc. prob=0.78]\rwarmup:  21%|â–ˆâ–ˆâ–       | 214/1000 [00:07<00:07, 105.44it/s, 15 steps of size 1.70e-01. acc. prob=0.78]\rwarmup:  23%|â–ˆâ–ˆâ–Ž       | 227/1000 [00:07<00:06, 110.49it/s, 31 steps of size 1.78e-01. acc. prob=0.78]\rwarmup:  24%|â–ˆâ–ˆâ–       | 239/1000 [00:07<00:06, 111.51it/s, 15 steps of size 1.22e-01. acc. prob=0.78]\rwarmup:  25%|â–ˆâ–ˆâ–Œ       | 253/1000 [00:07<00:06, 119.44it/s, 15 steps of size 7.93e-02. acc. prob=0.78]\rwarmup:  27%|â–ˆâ–ˆâ–‹       | 266/1000 [00:07<00:06, 114.60it/s, 6 steps of size 3.52e-02. acc. prob=0.78] \rwarmup:  28%|â–ˆâ–ˆâ–Š       | 278/1000 [00:07<00:06, 111.45it/s, 63 steps of size 8.79e-02. acc. prob=0.78]\rwarmup:  29%|â–ˆâ–ˆâ–‰       | 290/1000 [00:08<00:06, 113.69it/s, 31 steps of size 1.50e-01. acc. prob=0.78]\rwarmup:  31%|â–ˆâ–ˆâ–ˆ       | 307/1000 [00:08<00:05, 128.60it/s, 15 steps of size 1.67e-01. acc. prob=0.78]\rwarmup:  32%|â–ˆâ–ˆâ–ˆâ–      | 321/1000 [00:08<00:05, 129.13it/s, 31 steps of size 1.15e-01. acc. prob=0.78]\rwarmup:  33%|â–ˆâ–ˆâ–ˆâ–Ž      | 334/1000 [00:08<00:05, 124.83it/s, 31 steps of size 1.38e-01. acc. prob=0.78]\rwarmup:  35%|â–ˆâ–ˆâ–ˆâ–      | 347/1000 [00:08<00:05, 121.42it/s, 63 steps of size 1.20e-01. acc. prob=0.78]\rwarmup:  36%|â–ˆâ–ˆâ–ˆâ–Œ      | 360/1000 [00:08<00:05, 115.89it/s, 31 steps of size 1.34e-01. acc. prob=0.78]\rwarmup:  37%|â–ˆâ–ˆâ–ˆâ–‹      | 372/1000 [00:08<00:05, 112.86it/s, 31 steps of size 1.78e-01. acc. prob=0.78]\rwarmup:  38%|â–ˆâ–ˆâ–ˆâ–Š      | 384/1000 [00:08<00:05, 113.59it/s, 15 steps of size 1.15e-01. acc. prob=0.78]\rwarmup:  40%|â–ˆâ–ˆâ–ˆâ–‰      | 396/1000 [00:08<00:05, 115.17it/s, 31 steps of size 1.53e-01. acc. prob=0.78]\rwarmup:  41%|â–ˆâ–ˆâ–ˆâ–ˆ      | 408/1000 [00:09<00:05, 115.40it/s, 31 steps of size 1.58e-01. acc. prob=0.78]\rwarmup:  42%|â–ˆâ–ˆâ–ˆâ–ˆâ–     | 420/1000 [00:09<00:05, 112.28it/s, 31 steps of size 2.17e-01. acc. prob=0.79]\rwarmup:  43%|â–ˆâ–ˆâ–ˆâ–ˆâ–Ž     | 432/1000 [00:09<00:05, 112.72it/s, 31 steps of size 1.51e-01. acc. prob=0.78]\rwarmup:  45%|â–ˆâ–ˆâ–ˆâ–ˆâ–     | 446/1000 [00:09<00:04, 120.45it/s, 31 steps of size 2.10e-01. acc. prob=0.79]\rwarmup:  46%|â–ˆâ–ˆâ–ˆâ–ˆâ–Œ     | 459/1000 [00:09<00:04, 117.02it/s, 63 steps of size 1.03e-01. acc. prob=0.78]\rwarmup:  47%|â–ˆâ–ˆâ–ˆâ–ˆâ–‹     | 471/1000 [00:09<00:04, 116.00it/s, 31 steps of size 2.90e-01. acc. prob=0.78]\rwarmup:  48%|â–ˆâ–ˆâ–ˆâ–ˆâ–Š     | 483/1000 [00:09<00:04, 106.64it/s, 31 steps of size 1.37e-01. acc. prob=0.78]\rwarmup:  50%|â–ˆâ–ˆâ–ˆâ–ˆâ–‰     | 496/1000 [00:09<00:04, 111.45it/s, 31 steps of size 1.98e-01. acc. prob=0.78]\rsample:  51%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 510/1000 [00:09<00:04, 117.56it/s, 31 steps of size 1.33e-01. acc. prob=0.90]\rsample:  52%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–    | 523/1000 [00:10<00:03, 120.71it/s, 31 steps of size 1.33e-01. acc. prob=0.89]\rsample:  54%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž    | 537/1000 [00:10<00:03, 123.82it/s, 31 steps of size 1.33e-01. acc. prob=0.89]\rsample:  55%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ    | 551/1000 [00:10<00:03, 128.21it/s, 31 steps of size 1.33e-01. acc. prob=0.88]\rsample:  56%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹    | 565/1000 [00:10<00:03, 130.56it/s, 31 steps of size 1.33e-01. acc. prob=0.88]\rsample:  58%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š    | 579/1000 [00:10<00:03, 130.15it/s, 31 steps of size 1.33e-01. acc. prob=0.87]\rsample:  59%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰    | 593/1000 [00:10<00:03, 131.54it/s, 31 steps of size 1.33e-01. acc. prob=0.87]\rsample:  61%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ    | 607/1000 [00:10<00:03, 130.44it/s, 31 steps of size 1.33e-01. acc. prob=0.87]\rsample:  62%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–   | 621/1000 [00:10<00:02, 131.71it/s, 31 steps of size 1.33e-01. acc. prob=0.88]\rsample:  64%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž   | 635/1000 [00:10<00:02, 134.10it/s, 31 steps of size 1.33e-01. acc. prob=0.88]\rsample:  65%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–   | 649/1000 [00:11<00:02, 133.76it/s, 31 steps of size 1.33e-01. acc. prob=0.88]\rsample:  66%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹   | 663/1000 [00:11<00:02, 135.38it/s, 31 steps of size 1.33e-01. acc. prob=0.89]\rsample:  68%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š   | 677/1000 [00:11<00:02, 134.20it/s, 31 steps of size 1.33e-01. acc. prob=0.89]\rsample:  69%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰   | 691/1000 [00:11<00:02, 134.03it/s, 31 steps of size 1.33e-01. acc. prob=0.89]\rsample:  70%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ   | 705/1000 [00:11<00:02, 134.77it/s, 31 steps of size 1.33e-01. acc. prob=0.89]\rsample:  72%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–  | 719/1000 [00:11<00:02, 111.52it/s, 31 steps of size 1.33e-01. acc. prob=0.89]\rsample:  73%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž  | 731/1000 [00:11<00:02, 106.63it/s, 31 steps of size 1.33e-01. acc. prob=0.89]\rsample:  74%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–  | 743/1000 [00:11<00:02, 92.42it/s, 31 steps of size 1.33e-01. acc. prob=0.89] \rsample:  76%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 755/1000 [00:12<00:02, 97.69it/s, 31 steps of size 1.33e-01. acc. prob=0.89]\rsample:  77%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹  | 768/1000 [00:12<00:02, 103.79it/s, 31 steps of size 1.33e-01. acc. prob=0.89]\rsample:  78%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š  | 779/1000 [00:12<00:02, 105.19it/s, 31 steps of size 1.33e-01. acc. prob=0.89]\rsample:  79%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰  | 791/1000 [00:12<00:01, 108.48it/s, 31 steps of size 1.33e-01. acc. prob=0.89]\rsample:  80%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ  | 804/1000 [00:12<00:01, 113.54it/s, 31 steps of size 1.33e-01. acc. prob=0.89]\rsample:  82%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ– | 817/1000 [00:12<00:01, 115.84it/s, 31 steps of size 1.33e-01. acc. prob=0.90]\rsample:  83%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž | 830/1000 [00:12<00:01, 118.41it/s, 31 steps of size 1.33e-01. acc. prob=0.90]\rsample:  84%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ– | 843/1000 [00:12<00:01, 119.86it/s, 31 steps of size 1.33e-01. acc. prob=0.90]\rsample:  86%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ | 856/1000 [00:12<00:01, 119.10it/s, 31 steps of size 1.33e-01. acc. prob=0.90]\rsample:  87%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹ | 869/1000 [00:12<00:01, 121.20it/s, 31 steps of size 1.33e-01. acc. prob=0.89]\rsample:  88%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š | 882/1000 [00:13<00:00, 121.51it/s, 31 steps of size 1.33e-01. acc. prob=0.89]\rsample:  90%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰ | 895/1000 [00:13<00:00, 121.40it/s, 31 steps of size 1.33e-01. acc. prob=0.89]\rsample:  91%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ | 908/1000 [00:13<00:00, 122.47it/s, 31 steps of size 1.33e-01. acc. prob=0.89]\rsample:  92%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–| 922/1000 [00:13<00:00, 125.53it/s, 31 steps of size 1.33e-01. acc. prob=0.89]\rsample:  94%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž| 935/1000 [00:13<00:00, 124.50it/s, 31 steps of size 1.33e-01. acc. prob=0.89]\rsample:  95%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–| 948/1000 [00:13<00:00, 125.25it/s, 31 steps of size 1.33e-01. acc. prob=0.89]\rsample:  96%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ| 961/1000 [00:13<00:00, 125.33it/s, 31 steps of size 1.33e-01. acc. prob=0.89]\rsample:  97%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹| 974/1000 [00:13<00:00, 125.62it/s, 31 steps of size 1.33e-01. acc. prob=0.89]\rsample:  99%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š| 987/1000 [00:13<00:00, 126.42it/s, 31 steps of size 1.33e-01. acc. prob=0.89]\rsample: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1000/1000 [00:14<00:00, 117.56it/s, 31 steps of size 1.33e-01. acc. prob=0.89]\rsample: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1000/1000 [00:14<00:00, 71.33it/s, 31 steps of size 1.33e-01. acc. prob=0.89] \narviz - WARNING - Shape validation failed: input_shape: (1, 500), minimum_shape: (chains=2, draws=4)\n```\n:::\n\n::: {.cell-output .cell-output-display execution_count=1}\n```{=html}\n<div>\n<style scoped>\n    .dataframe tbody tr th:only-of-type {\n        vertical-align: middle;\n    }\n\n    .dataframe tbody tr th {\n        vertical-align: top;\n    }\n\n    .dataframe thead th {\n        text-align: right;\n    }\n</style>\n<table border=\"1\" class=\"dataframe\">\n  <thead>\n    <tr style=\"text-align: right;\">\n      <th></th>\n      <th>mean</th>\n      <th>sd</th>\n      <th>hdi_5.5%</th>\n      <th>hdi_94.5%</th>\n      <th>mcse_mean</th>\n      <th>mcse_sd</th>\n      <th>ess_bulk</th>\n      <th>ess_tail</th>\n      <th>r_hat</th>\n    </tr>\n  </thead>\n  <tbody>\n    <tr>\n      <th>Lambda[0]</th>\n      <td>1.39</td>\n      <td>0.36</td>\n      <td>0.83</td>\n      <td>1.91</td>\n      <td>0.01</td>\n      <td>0.02</td>\n      <td>537.43</td>\n      <td>299.02</td>\n      <td>NaN</td>\n    </tr>\n    <tr>\n      <th>Lambda[1]</th>\n      <td>1.76</td>\n      <td>0.40</td>\n      <td>1.13</td>\n      <td>2.34</td>\n      <td>0.01</td>\n      <td>0.02</td>\n      <td>713.23</td>\n      <td>285.08</td>\n      <td>NaN</td>\n    </tr>\n    <tr>\n      <th>Lambda[2]</th>\n      <td>1.57</td>\n      <td>0.42</td>\n      <td>0.92</td>\n      <td>2.17</td>\n      <td>0.01</td>\n      <td>0.02</td>\n      <td>826.04</td>\n      <td>397.99</td>\n      <td>NaN</td>\n    </tr>\n    <tr>\n      <th>Lambda[3]</th>\n      <td>1.47</td>\n      <td>0.36</td>\n      <td>0.86</td>\n      <td>1.97</td>\n      <td>0.01</td>\n      <td>0.02</td>\n      <td>850.98</td>\n      <td>414.15</td>\n      <td>NaN</td>\n    </tr>\n    <tr>\n      <th>Lambda[4]</th>\n      <td>1.53</td>\n      <td>0.38</td>\n      <td>0.95</td>\n      <td>2.14</td>\n      <td>0.01</td>\n      <td>0.02</td>\n      <td>630.33</td>\n      <td>428.36</td>\n      <td>NaN</td>\n    </tr>\n    <tr>\n      <th>...</th>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n    </tr>\n    <tr>\n      <th>Lambda[3398]</th>\n      <td>3.04</td>\n      <td>0.77</td>\n      <td>1.93</td>\n      <td>4.19</td>\n      <td>0.03</td>\n      <td>0.04</td>\n      <td>854.46</td>\n      <td>465.41</td>\n      <td>NaN</td>\n    </tr>\n    <tr>\n      <th>Lambda[3399]</th>\n      <td>2.86</td>\n      <td>0.73</td>\n      <td>1.76</td>\n      <td>3.95</td>\n      <td>0.03</td>\n      <td>0.04</td>\n      <td>341.11</td>\n      <td>200.88</td>\n      <td>NaN</td>\n    </tr>\n    <tr>\n      <th>a[0]</th>\n      <td>-0.42</td>\n      <td>0.01</td>\n      <td>-0.44</td>\n      <td>-0.40</td>\n      <td>0.00</td>\n      <td>0.00</td>\n      <td>51.13</td>\n      <td>111.55</td>\n      <td>NaN</td>\n    </tr>\n    <tr>\n      <th>b[0]</th>\n      <td>-2.78</td>\n      <td>0.03</td>\n      <td>-2.83</td>\n      <td>-2.73</td>\n      <td>0.00</td>\n      <td>0.00</td>\n      <td>63.60</td>\n      <td>188.73</td>\n      <td>NaN</td>\n    </tr>\n    <tr>\n      <th>phi[0]</th>\n      <td>16.10</td>\n      <td>1.92</td>\n      <td>13.30</td>\n      <td>19.15</td>\n      <td>0.55</td>\n      <td>0.14</td>\n      <td>12.83</td>\n      <td>101.44</td>\n      <td>NaN</td>\n    </tr>\n  </tbody>\n</table>\n<p>3403 rows Ã— 9 columns</p>\n</div>\n```\n:::\n:::\n\n\n### R\n```R\nlibrary(BI)\n\n# Setup platform------------------------------------------------\nm=importbi(platform='cpu')\n\n# Import data ------------------------------------------------\nm$data(paste(system.file(package = \"BI\"),\"/data/Sim dat Gamma poisson.csv\", sep = ''), sep=',')\nm$data_to_model(list('log_days', 'monastery', 'y' )) # Send to model (convert to jax array)\n\n# Define model ------------------------------------------------\nmodel <- function(log_days, monastery, y){\n  # Parameter prior distributions\n  alpha = bi.dist.normal(0, 1, name='alpha', shape=c(1))\n  beta = bi.dist.normal(0, 1, name='beta', shape=c(1))\n  phi = bi.dist.exponential(1, name='phi', shape=c(1))\n  mu = jnp$exp(log_days + alpha + beta * monastery)\n  Lambda =  m.dist.gamma(rate = mu*phi, concentration = phi, name = 'Lambda')\n  # Likelihood\n  m$poisson(rate=Lambda, obs=y)\n}\n\n# Run MCMC ------------------------------------------------\nm$fit(model) # Optimize model parameters through MCMC sampling\n\n# Summary ------------------------------------------------\nm$summary() # Get posterior distributions\n\n\n\n```\n:::\n\n## Mathematical Details\n### *Bayesian model*\nIn the Bayesian formulation, we define each parameter with [<span style=\"color:#0D6EFD\">priors ðŸ›ˆ</span>]{#prior}. We can express the Bayesian regression model accounting for prior distributions as follows:\n\n$$\nY_i \\sim \\text{Poisson}(\\lambda_i)\n$$\n\n$$\n\\lambda_i \\sim \\text{Gamma}(\\mu_i \\phi, \\phi)\n$$\n\n$$\n\\log(\\mu_i) = \\text{rates}_i + \\alpha + \\beta X_i\n$$\n\n$$\n\\alpha \\sim \\text{Normal}(0,1)\n$$\n\n$$\n\\beta \\sim \\text{Normal}(0,1)\n$$\n\n$$\n\\phi \\sim \\text{Exponential}(1)\n$$\n\nWhere:\n\n- $Y_i$ is the dependent variable for observation *i*. \n  \n- $\\lambda_i$ is the rate parameter of the Poisson distribution for observation *i*, assuming that each Poisson count observation has its own $rate_i$.\n  \n- $\\mu_i$ is the mean rate parameter.\n- \n- $\\phi$ controls the level of overdispersion in the rates.\n  \n- $\\alpha$ is the intercept term.\n  \n- $\\beta$ is the regression coefficient.\n  \n- $X_i$ is the value of the predictor variable for observation *i*.\n\n\n## Notes\n\n::: callout-note \n- We can apply multiple variables similarly as in [chapter 2](2.&#32;Multiple&#32;continuous&#32;variables.qmd).\n\n- We can apply interaction terms similarly as in [chapter 3](3.&#32;Interaction&#32;between&#32;Continuous&#32;Variables.qmd).\n\n- We can apply categorical variables similarly as in [chapter 4](4.&#32;Categorical&#32;variable.qmd).\n:::\n\n## Reference(s)\n\n",
    "supporting": [
      "8. Gamma-Poisson_files/figure-pdf"
    ],
    "filters": []
  }
}