{
  "hash": "10ba04cc44c46214c9225cf13458af64",
  "result": {
    "engine": "jupyter",
    "markdown": "---\ntitle: \"Build in models\"\nsidebar: start\n---\n\n# PCA\n\n::: {#c1a8892c .cell execution_count=1}\n``` {.python .cell-code}\nfrom BI import bi, jnp\n\nm=bi()\nm.data('iris.csv', sep=',') # Data is already scaled\nm.data_on_model = dict(\n    X=jnp.array(m.df.iloc[:,0:-2].values)\n)\nm.fit(m.models.pca(type=\"ARD\"), progress_bar=False) # or robust, sparse, classic, sparse_robust_ard\n\nm.models.pca.plot(\n    X=m.df.iloc[:,0:-2].values,\n    y=m.df.iloc[:,-2].values, \n    feature_names=m.df.columns[0:-2], \n    target_names=m.df.iloc[:,-1].unique(),\n    color_var=m.df.iloc[:,0].values,\n    shape_var=m.df.iloc[:,-2].values\n)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\njax.local_device_count 16\n```\n:::\n\n::: {.cell-output .cell-output-display}\n![](Build in models_files/figure-html/cell-2-output-2.png){}\n:::\n:::\n\n\n# Survival analysis\n\n::: {#5aae1dcc .cell execution_count=2}\n``` {.python .cell-code}\nfrom BI import bi, jnp\n\nm = bi()\nm.data('mastectomy.csv', sep=',').head()\n\nm.df.metastasized = (m.df.metastasized.values == \"yes\").astype(jnp.int64)\nm.models.survival.import_time_even(\n    m.df.time.values, \n    m.df.event.values, interval_length=3\n) # Import time-steps and events\nm.models.survival.import_covF(\n    m.df.metastasized.values, ['metastasized']\n) # Import time-fixed covariates\n# m.models.survival.import_covV # To import time-varying covariates\n\nm.fit(m.models.survival.model, num_samples=500) \nm.summary()\n\nm.models.survival.plot_surv( beta = 'Hazard_rate_metastasized')\n```\n\n::: {.cell-output .cell-output-stdout}\n```\njax.local_device_count 16\n------------------------------------------------------------------------------\nSurvival concern 44 individuals in 76 intervals.\n18.0 individuals experienced the event.\n------------------------------------------------------------------------------\nCovariates imported: ['metastasized']\nSurv object now has 1 covariates: ['metastasized']\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\n\r  0%|          | 0/1000 [00:00<?, ?it/s]\rwarmup:   0%|          | 1/1000 [00:01<25:34,  1.54s/it, 1 steps of size 2.34e+00. acc. prob=0.00]\rwarmup:   2%|▏         | 18/1000 [00:01<01:06, 14.68it/s, 1023 steps of size 2.28e-01. acc. prob=0.73]\rwarmup:   3%|▎         | 26/1000 [00:02<00:57, 16.92it/s, 1023 steps of size 2.42e-01. acc. prob=0.75]\rwarmup:   3%|▎         | 32/1000 [00:02<00:48, 19.90it/s, 34 steps of size 8.24e-02. acc. prob=0.74]  \rwarmup:   4%|▎         | 37/1000 [00:02<00:47, 20.15it/s, 1023 steps of size 2.82e-01. acc. prob=0.76]\rwarmup:   4%|▍         | 41/1000 [00:02<00:44, 21.76it/s, 13 steps of size 6.20e-02. acc. prob=0.75]  \rwarmup:   4%|▍         | 45/1000 [00:02<00:41, 23.09it/s, 149 steps of size 8.58e-02. acc. prob=0.76]\rwarmup:   5%|▍         | 49/1000 [00:02<00:39, 24.20it/s, 25 steps of size 1.03e-01. acc. prob=0.76] \rwarmup:   5%|▌         | 53/1000 [00:03<00:38, 24.58it/s, 67 steps of size 1.68e-01. acc. prob=0.77]\rwarmup:   6%|▌         | 56/1000 [00:03<00:41, 22.92it/s, 1023 steps of size 2.82e-01. acc. prob=0.77]\rwarmup:   6%|▌         | 59/1000 [00:03<00:38, 24.24it/s, 1023 steps of size 2.50e-01. acc. prob=0.77]\rwarmup:   6%|▌         | 62/1000 [00:03<00:39, 23.46it/s, 1023 steps of size 2.71e-01. acc. prob=0.77]\rwarmup:   6%|▋         | 65/1000 [00:03<00:40, 23.08it/s, 1023 steps of size 2.51e-01. acc. prob=0.77]\rwarmup:   7%|▋         | 69/1000 [00:03<00:37, 24.84it/s, 1023 steps of size 1.74e-01. acc. prob=0.77]\rwarmup:   7%|▋         | 72/1000 [00:03<00:36, 25.31it/s, 1023 steps of size 2.46e-01. acc. prob=0.78]\rwarmup:   8%|▊         | 75/1000 [00:03<00:41, 22.09it/s, 1023 steps of size 2.88e-01. acc. prob=0.78]\rwarmup:   8%|▊         | 79/1000 [00:04<00:36, 25.29it/s, 1023 steps of size 2.48e-01. acc. prob=0.78]\rwarmup:   8%|▊         | 82/1000 [00:04<00:37, 24.56it/s, 1023 steps of size 1.39e-01. acc. prob=0.77]\rwarmup:   9%|▊         | 86/1000 [00:04<00:35, 25.95it/s, 1023 steps of size 1.80e-01. acc. prob=0.78]\rwarmup:   9%|▉         | 89/1000 [00:04<00:34, 26.45it/s, 468 steps of size 2.46e-01. acc. prob=0.78] \rwarmup:   9%|▉         | 92/1000 [00:04<00:34, 26.06it/s, 511 steps of size 3.42e-01. acc. prob=0.78]\rwarmup:  10%|▉         | 96/1000 [00:04<00:33, 26.89it/s, 1023 steps of size 2.73e-01. acc. prob=0.78]\rwarmup:  10%|█         | 100/1000 [00:04<00:30, 29.15it/s, 511 steps of size 3.11e-01. acc. prob=0.78]\rwarmup:  11%|█         | 106/1000 [00:04<00:24, 35.76it/s, 509 steps of size 2.34e-03. acc. prob=0.76]\rwarmup:  11%|█         | 110/1000 [00:05<00:27, 32.36it/s, 511 steps of size 1.93e-02. acc. prob=0.77]\rwarmup:  11%|█▏        | 114/1000 [00:05<00:27, 32.40it/s, 511 steps of size 1.56e-02. acc. prob=0.77]\rwarmup:  12%|█▏        | 118/1000 [00:05<00:26, 33.90it/s, 1023 steps of size 8.59e-03. acc. prob=0.77]\rwarmup:  12%|█▏        | 122/1000 [00:05<00:26, 32.88it/s, 1023 steps of size 9.81e-03. acc. prob=0.77]\rwarmup:  13%|█▎        | 126/1000 [00:05<00:28, 30.61it/s, 1023 steps of size 1.26e-02. acc. prob=0.77]\rwarmup:  13%|█▎        | 130/1000 [00:05<00:27, 31.50it/s, 198 steps of size 5.00e-03. acc. prob=0.77] \rwarmup:  13%|█▎        | 134/1000 [00:05<00:30, 28.33it/s, 1023 steps of size 1.72e-02. acc. prob=0.77]\rwarmup:  14%|█▍        | 139/1000 [00:06<00:28, 30.69it/s, 1023 steps of size 4.45e-03. acc. prob=0.77]\rwarmup:  14%|█▍        | 143/1000 [00:06<00:28, 30.46it/s, 511 steps of size 1.49e-02. acc. prob=0.77] \rwarmup:  15%|█▍        | 147/1000 [00:06<00:26, 32.42it/s, 1023 steps of size 9.29e-03. acc. prob=0.77]\rwarmup:  15%|█▌        | 154/1000 [00:06<00:21, 40.17it/s, 1023 steps of size 2.55e-03. acc. prob=0.76]\rwarmup:  16%|█▌        | 159/1000 [00:06<00:23, 35.85it/s, 511 steps of size 8.84e-03. acc. prob=0.77] \rwarmup:  16%|█▋        | 163/1000 [00:06<00:22, 36.80it/s, 277 steps of size 3.32e-03. acc. prob=0.77]\rwarmup:  17%|█▋        | 167/1000 [00:06<00:23, 35.31it/s, 1023 steps of size 3.52e-03. acc. prob=0.77]\rwarmup:  17%|█▋        | 171/1000 [00:06<00:23, 34.79it/s, 493 steps of size 2.51e-03. acc. prob=0.77] \rwarmup:  18%|█▊        | 175/1000 [00:07<00:23, 35.26it/s, 255 steps of size 5.26e-03. acc. prob=0.77]\rwarmup:  18%|█▊        | 179/1000 [00:07<00:24, 33.58it/s, 1023 steps of size 1.08e-02. acc. prob=0.77]\rwarmup:  18%|█▊        | 183/1000 [00:07<00:26, 30.89it/s, 1023 steps of size 6.28e-03. acc. prob=0.77]\rwarmup:  19%|█▉        | 188/1000 [00:07<00:24, 32.67it/s, 1023 steps of size 7.36e-03. acc. prob=0.77]\rwarmup:  19%|█▉        | 193/1000 [00:07<00:21, 36.85it/s, 244 steps of size 9.82e-03. acc. prob=0.77] \rwarmup:  20%|█▉        | 198/1000 [00:07<00:20, 38.66it/s, 1023 steps of size 4.88e-03. acc. prob=0.77]\rwarmup:  20%|██        | 202/1000 [00:07<00:20, 38.56it/s, 393 steps of size 3.74e-03. acc. prob=0.77] \rwarmup:  21%|██        | 206/1000 [00:07<00:20, 38.78it/s, 272 steps of size 4.18e-03. acc. prob=0.77]\rwarmup:  21%|██        | 211/1000 [00:08<00:19, 39.53it/s, 511 steps of size 4.36e-03. acc. prob=0.77]\rwarmup:  22%|██▏       | 216/1000 [00:08<00:20, 38.37it/s, 1023 steps of size 8.67e-03. acc. prob=0.77]\rwarmup:  22%|██▏       | 220/1000 [00:08<00:53, 14.51it/s, 428 steps of size 6.65e-03. acc. prob=0.77] \rwarmup:  22%|██▎       | 225/1000 [00:09<00:41, 18.53it/s, 308 steps of size 4.04e-03. acc. prob=0.77]\rwarmup:  23%|██▎       | 229/1000 [00:09<00:37, 20.32it/s, 1023 steps of size 3.79e-03. acc. prob=0.77]\rwarmup:  23%|██▎       | 234/1000 [00:09<00:31, 24.35it/s, 511 steps of size 1.05e-02. acc. prob=0.78] \rwarmup:  24%|██▍       | 238/1000 [00:09<00:27, 27.22it/s, 1023 steps of size 8.16e-03. acc. prob=0.78]\rwarmup:  24%|██▍       | 242/1000 [00:09<00:28, 26.96it/s, 1023 steps of size 7.33e-03. acc. prob=0.78]\rwarmup:  25%|██▍       | 246/1000 [00:09<00:25, 29.41it/s, 511 steps of size 1.01e-02. acc. prob=0.78] \rwarmup:  25%|██▌       | 251/1000 [00:09<00:22, 33.37it/s, 255 steps of size 7.96e-02. acc. prob=0.78]\rwarmup:  26%|██▌       | 256/1000 [00:09<00:20, 36.45it/s, 255 steps of size 5.90e-03. acc. prob=0.77]\rwarmup:  26%|██▌       | 261/1000 [00:09<00:19, 37.35it/s, 255 steps of size 8.52e-03. acc. prob=0.78]\rwarmup:  26%|██▋       | 265/1000 [00:10<00:20, 36.06it/s, 511 steps of size 4.82e-03. acc. prob=0.77]\rwarmup:  27%|██▋       | 270/1000 [00:10<00:19, 37.84it/s, 511 steps of size 1.26e-02. acc. prob=0.78]\rwarmup:  27%|██▋       | 274/1000 [00:10<00:19, 37.18it/s, 255 steps of size 1.05e-02. acc. prob=0.78]\rwarmup:  28%|██▊       | 278/1000 [00:10<00:19, 36.81it/s, 511 steps of size 2.20e-03. acc. prob=0.77]\rwarmup:  28%|██▊       | 282/1000 [00:10<00:20, 34.59it/s, 34 steps of size 1.24e-02. acc. prob=0.78] \rwarmup:  29%|██▊       | 287/1000 [00:10<00:20, 35.23it/s, 1023 steps of size 5.72e-03. acc. prob=0.78]\rwarmup:  29%|██▉       | 291/1000 [00:10<00:21, 32.26it/s, 511 steps of size 1.01e-02. acc. prob=0.78] \rwarmup:  30%|██▉       | 297/1000 [00:10<00:18, 37.89it/s, 511 steps of size 8.21e-03. acc. prob=0.78]\rwarmup:  30%|███       | 302/1000 [00:11<00:18, 37.02it/s, 1023 steps of size 8.44e-03. acc. prob=0.78]\rwarmup:  31%|███       | 307/1000 [00:11<00:18, 37.37it/s, 1023 steps of size 7.32e-03. acc. prob=0.78]\rwarmup:  31%|███       | 312/1000 [00:11<00:17, 39.02it/s, 511 steps of size 8.15e-03. acc. prob=0.78] \rwarmup:  32%|███▏      | 317/1000 [00:11<00:16, 40.96it/s, 255 steps of size 6.07e-03. acc. prob=0.78]\rwarmup:  32%|███▏      | 322/1000 [00:11<00:16, 40.18it/s, 511 steps of size 7.11e-03. acc. prob=0.78]\rwarmup:  33%|███▎      | 327/1000 [00:11<00:18, 36.81it/s, 511 steps of size 7.51e-03. acc. prob=0.78]\rwarmup:  33%|███▎      | 332/1000 [00:11<00:17, 38.41it/s, 511 steps of size 1.13e-02. acc. prob=0.78]\rwarmup:  34%|███▎      | 337/1000 [00:11<00:16, 39.23it/s, 511 steps of size 7.43e-03. acc. prob=0.78]\rwarmup:  34%|███▍      | 341/1000 [00:12<00:17, 37.52it/s, 1023 steps of size 6.40e-03. acc. prob=0.78]\rwarmup:  34%|███▍      | 345/1000 [00:12<00:17, 36.65it/s, 1023 steps of size 6.36e-03. acc. prob=0.78]\rwarmup:  35%|███▍      | 349/1000 [00:12<00:17, 36.51it/s, 1023 steps of size 4.28e-03. acc. prob=0.78]\rwarmup:  35%|███▌      | 353/1000 [00:12<00:17, 36.10it/s, 255 steps of size 3.71e-03. acc. prob=0.78] \rwarmup:  36%|███▌      | 357/1000 [00:12<00:18, 34.71it/s, 298 steps of size 6.09e-03. acc. prob=0.78]\rwarmup:  36%|███▌      | 362/1000 [00:12<00:17, 37.24it/s, 511 steps of size 4.78e-03. acc. prob=0.78]\rwarmup:  37%|███▋      | 366/1000 [00:12<00:17, 36.36it/s, 511 steps of size 6.39e-03. acc. prob=0.78]\rwarmup:  37%|███▋      | 372/1000 [00:12<00:16, 38.31it/s, 1023 steps of size 5.92e-03. acc. prob=0.78]\rwarmup:  38%|███▊      | 376/1000 [00:13<00:16, 38.39it/s, 215 steps of size 6.27e-03. acc. prob=0.78] \rwarmup:  38%|███▊      | 381/1000 [00:13<00:15, 40.89it/s, 511 steps of size 4.62e-03. acc. prob=0.78]\rwarmup:  39%|███▊      | 386/1000 [00:13<00:14, 43.24it/s, 511 steps of size 9.20e-03. acc. prob=0.78]\rwarmup:  39%|███▉      | 391/1000 [00:13<00:14, 42.34it/s, 255 steps of size 6.51e-03. acc. prob=0.78]\rwarmup:  40%|███▉      | 396/1000 [00:13<00:15, 38.85it/s, 511 steps of size 7.74e-03. acc. prob=0.78]\rwarmup:  40%|████      | 400/1000 [00:13<00:16, 36.23it/s, 1023 steps of size 7.00e-03. acc. prob=0.78]\rwarmup:  40%|████      | 405/1000 [00:13<00:15, 38.35it/s, 1023 steps of size 5.37e-03. acc. prob=0.78]\rwarmup:  41%|████      | 409/1000 [00:13<00:16, 35.71it/s, 1023 steps of size 7.17e-03. acc. prob=0.78]\rwarmup:  42%|████▏     | 415/1000 [00:14<00:14, 40.15it/s, 511 steps of size 8.35e-03. acc. prob=0.78] \rwarmup:  42%|████▏     | 420/1000 [00:14<00:14, 39.19it/s, 511 steps of size 1.11e-02. acc. prob=0.78]\rwarmup:  42%|████▏     | 424/1000 [00:14<00:15, 38.09it/s, 511 steps of size 9.91e-03. acc. prob=0.78]\rwarmup:  43%|████▎     | 428/1000 [00:14<00:15, 36.95it/s, 1023 steps of size 5.94e-03. acc. prob=0.78]\rwarmup:  43%|████▎     | 432/1000 [00:14<00:15, 36.80it/s, 511 steps of size 8.81e-03. acc. prob=0.78] \rwarmup:  44%|████▎     | 437/1000 [00:14<00:15, 36.73it/s, 1023 steps of size 6.33e-03. acc. prob=0.78]\rwarmup:  44%|████▍     | 443/1000 [00:14<00:14, 39.45it/s, 1023 steps of size 5.93e-03. acc. prob=0.78]\rwarmup:  45%|████▍     | 447/1000 [00:14<00:14, 39.08it/s, 372 steps of size 4.69e-03. acc. prob=0.78] \rwarmup:  45%|████▌     | 451/1000 [00:15<00:15, 34.40it/s, 1023 steps of size 7.33e-02. acc. prob=0.78]\rwarmup:  46%|████▌     | 456/1000 [00:15<00:14, 37.96it/s, 511 steps of size 9.88e-03. acc. prob=0.78] \rwarmup:  46%|████▌     | 461/1000 [00:15<00:13, 41.03it/s, 255 steps of size 1.16e-02. acc. prob=0.78]\rwarmup:  47%|████▋     | 467/1000 [00:15<00:12, 43.11it/s, 1023 steps of size 2.74e-03. acc. prob=0.78]\rwarmup:  47%|████▋     | 472/1000 [00:15<00:13, 38.53it/s, 1023 steps of size 6.48e-03. acc. prob=0.78]\rwarmup:  48%|████▊     | 477/1000 [00:15<00:12, 40.24it/s, 255 steps of size 5.46e-03. acc. prob=0.78] \rwarmup:  48%|████▊     | 483/1000 [00:15<00:11, 44.18it/s, 511 steps of size 1.14e-02. acc. prob=0.78]\rwarmup:  49%|████▉     | 489/1000 [00:15<00:10, 47.16it/s, 511 steps of size 3.94e-03. acc. prob=0.78]\rwarmup:  49%|████▉     | 494/1000 [00:16<00:11, 42.78it/s, 511 steps of size 9.55e-03. acc. prob=0.78]\rwarmup:  50%|█████     | 500/1000 [00:16<00:10, 46.91it/s, 208 steps of size 7.57e-03. acc. prob=0.78]\rsample:  50%|█████     | 505/1000 [00:16<00:10, 47.50it/s, 511 steps of size 7.57e-03. acc. prob=0.64]\rsample:  51%|█████     | 510/1000 [00:16<00:10, 46.74it/s, 511 steps of size 7.57e-03. acc. prob=0.74]\rsample:  52%|█████▏    | 515/1000 [00:16<00:10, 46.18it/s, 511 steps of size 7.57e-03. acc. prob=0.77]\rsample:  52%|█████▏    | 520/1000 [00:16<00:10, 47.23it/s, 511 steps of size 7.57e-03. acc. prob=0.76]\rsample:  52%|█████▎    | 525/1000 [00:16<00:10, 46.55it/s, 511 steps of size 7.57e-03. acc. prob=0.80]\rsample:  53%|█████▎    | 531/1000 [00:16<00:09, 48.09it/s, 511 steps of size 7.57e-03. acc. prob=0.82]\rsample:  54%|█████▎    | 536/1000 [00:16<00:09, 47.23it/s, 511 steps of size 7.57e-03. acc. prob=0.83]\rsample:  54%|█████▍    | 541/1000 [00:16<00:09, 46.43it/s, 511 steps of size 7.57e-03. acc. prob=0.84]\rsample:  55%|█████▍    | 546/1000 [00:17<00:09, 46.10it/s, 511 steps of size 7.57e-03. acc. prob=0.85]\rsample:  55%|█████▌    | 551/1000 [00:17<00:09, 45.03it/s, 511 steps of size 7.57e-03. acc. prob=0.85]\rsample:  56%|█████▌    | 556/1000 [00:17<00:09, 45.34it/s, 511 steps of size 7.57e-03. acc. prob=0.84]\rsample:  56%|█████▌    | 561/1000 [00:17<00:09, 46.30it/s, 511 steps of size 7.57e-03. acc. prob=0.83]\rsample:  57%|█████▋    | 567/1000 [00:17<00:08, 48.16it/s, 511 steps of size 7.57e-03. acc. prob=0.82]\rsample:  57%|█████▋    | 572/1000 [00:17<00:09, 47.28it/s, 511 steps of size 7.57e-03. acc. prob=0.83]\rsample:  58%|█████▊    | 577/1000 [00:17<00:09, 46.73it/s, 511 steps of size 7.57e-03. acc. prob=0.84]\rsample:  58%|█████▊    | 582/1000 [00:17<00:09, 46.19it/s, 511 steps of size 7.57e-03. acc. prob=0.84]\rsample:  59%|█████▊    | 587/1000 [00:17<00:09, 45.70it/s, 511 steps of size 7.57e-03. acc. prob=0.84]\rsample:  59%|█████▉    | 592/1000 [00:18<00:08, 46.25it/s, 511 steps of size 7.57e-03. acc. prob=0.83]\rsample:  60%|█████▉    | 597/1000 [00:18<00:08, 45.79it/s, 511 steps of size 7.57e-03. acc. prob=0.84]\rsample:  60%|██████    | 602/1000 [00:18<00:08, 45.35it/s, 511 steps of size 7.57e-03. acc. prob=0.84]\rsample:  61%|██████    | 607/1000 [00:18<00:08, 45.12it/s, 511 steps of size 7.57e-03. acc. prob=0.85]\rsample:  61%|██████    | 612/1000 [00:18<00:08, 44.93it/s, 511 steps of size 7.57e-03. acc. prob=0.85]\rsample:  62%|██████▏   | 618/1000 [00:18<00:08, 46.37it/s, 511 steps of size 7.57e-03. acc. prob=0.86]\rsample:  62%|██████▏   | 623/1000 [00:18<00:08, 46.08it/s, 511 steps of size 7.57e-03. acc. prob=0.85]\rsample:  63%|██████▎   | 628/1000 [00:18<00:08, 45.59it/s, 511 steps of size 7.57e-03. acc. prob=0.85]\rsample:  63%|██████▎   | 633/1000 [00:19<00:08, 44.13it/s, 511 steps of size 7.57e-03. acc. prob=0.85]\rsample:  64%|██████▍   | 638/1000 [00:19<00:08, 42.32it/s, 511 steps of size 7.57e-03. acc. prob=0.86]\rsample:  64%|██████▍   | 643/1000 [00:19<00:08, 43.15it/s, 511 steps of size 7.57e-03. acc. prob=0.85]\rsample:  65%|██████▍   | 648/1000 [00:19<00:08, 43.86it/s, 511 steps of size 7.57e-03. acc. prob=0.85]\rsample:  65%|██████▌   | 653/1000 [00:19<00:07, 44.06it/s, 511 steps of size 7.57e-03. acc. prob=0.85]\rsample:  66%|██████▌   | 658/1000 [00:19<00:07, 44.33it/s, 511 steps of size 7.57e-03. acc. prob=0.85]\rsample:  66%|██████▋   | 663/1000 [00:19<00:07, 45.81it/s, 511 steps of size 7.57e-03. acc. prob=0.85]\rsample:  67%|██████▋   | 668/1000 [00:19<00:07, 45.04it/s, 511 steps of size 7.57e-03. acc. prob=0.85]\rsample:  67%|██████▋   | 673/1000 [00:19<00:07, 46.32it/s, 511 steps of size 7.57e-03. acc. prob=0.84]\rsample:  68%|██████▊   | 678/1000 [00:20<00:07, 45.88it/s, 511 steps of size 7.57e-03. acc. prob=0.84]\rsample:  68%|██████▊   | 684/1000 [00:20<00:06, 48.44it/s, 511 steps of size 7.57e-03. acc. prob=0.84]\rsample:  69%|██████▉   | 689/1000 [00:20<00:06, 47.63it/s, 511 steps of size 7.57e-03. acc. prob=0.84]\rsample:  69%|██████▉   | 694/1000 [00:20<00:06, 47.69it/s, 511 steps of size 7.57e-03. acc. prob=0.84]\rsample:  70%|██████▉   | 699/1000 [00:20<00:06, 46.85it/s, 511 steps of size 7.57e-03. acc. prob=0.85]\rsample:  70%|███████   | 704/1000 [00:20<00:06, 46.20it/s, 511 steps of size 7.57e-03. acc. prob=0.85]\rsample:  71%|███████   | 709/1000 [00:20<00:06, 46.18it/s, 511 steps of size 7.57e-03. acc. prob=0.85]\rsample:  71%|███████▏  | 714/1000 [00:20<00:06, 46.05it/s, 511 steps of size 7.57e-03. acc. prob=0.85]\rsample:  72%|███████▏  | 719/1000 [00:20<00:06, 45.59it/s, 511 steps of size 7.57e-03. acc. prob=0.85]\rsample:  72%|███████▏  | 724/1000 [00:20<00:06, 45.57it/s, 511 steps of size 7.57e-03. acc. prob=0.85]\rsample:  73%|███████▎  | 729/1000 [00:21<00:05, 45.72it/s, 511 steps of size 7.57e-03. acc. prob=0.85]\rsample:  73%|███████▎  | 734/1000 [00:21<00:05, 45.62it/s, 511 steps of size 7.57e-03. acc. prob=0.85]\rsample:  74%|███████▍  | 739/1000 [00:21<00:05, 45.58it/s, 511 steps of size 7.57e-03. acc. prob=0.85]\rsample:  74%|███████▍  | 744/1000 [00:21<00:05, 45.21it/s, 511 steps of size 7.57e-03. acc. prob=0.85]\rsample:  75%|███████▍  | 749/1000 [00:21<00:05, 45.19it/s, 511 steps of size 7.57e-03. acc. prob=0.85]\rsample:  75%|███████▌  | 754/1000 [00:21<00:05, 45.69it/s, 511 steps of size 7.57e-03. acc. prob=0.85]\rsample:  76%|███████▌  | 759/1000 [00:21<00:05, 43.87it/s, 511 steps of size 7.57e-03. acc. prob=0.86]\rsample:  76%|███████▋  | 764/1000 [00:21<00:05, 45.53it/s, 511 steps of size 7.57e-03. acc. prob=0.86]\rsample:  77%|███████▋  | 769/1000 [00:21<00:05, 45.39it/s, 511 steps of size 7.57e-03. acc. prob=0.86]\rsample:  77%|███████▋  | 774/1000 [00:22<00:04, 45.52it/s, 511 steps of size 7.57e-03. acc. prob=0.86]\rsample:  78%|███████▊  | 779/1000 [00:22<00:04, 45.84it/s, 511 steps of size 7.57e-03. acc. prob=0.85]\rsample:  78%|███████▊  | 784/1000 [00:22<00:04, 45.28it/s, 511 steps of size 7.57e-03. acc. prob=0.86]\rsample:  79%|███████▉  | 789/1000 [00:22<00:04, 44.95it/s, 511 steps of size 7.57e-03. acc. prob=0.85]\rsample:  79%|███████▉  | 794/1000 [00:22<00:04, 44.64it/s, 511 steps of size 7.57e-03. acc. prob=0.85]\rsample:  80%|████████  | 800/1000 [00:22<00:04, 47.58it/s, 511 steps of size 7.57e-03. acc. prob=0.86]\rsample:  80%|████████  | 805/1000 [00:22<00:04, 47.05it/s, 511 steps of size 7.57e-03. acc. prob=0.85]\rsample:  81%|████████  | 810/1000 [00:22<00:04, 46.47it/s, 511 steps of size 7.57e-03. acc. prob=0.85]\rsample:  82%|████████▏ | 816/1000 [00:22<00:03, 47.91it/s, 511 steps of size 7.57e-03. acc. prob=0.85]\rsample:  82%|████████▏ | 821/1000 [00:23<00:03, 46.50it/s, 511 steps of size 7.57e-03. acc. prob=0.85]\rsample:  83%|████████▎ | 827/1000 [00:23<00:03, 47.51it/s, 511 steps of size 7.57e-03. acc. prob=0.85]\rsample:  83%|████████▎ | 832/1000 [00:23<00:03, 46.25it/s, 511 steps of size 7.57e-03. acc. prob=0.85]\rsample:  84%|████████▍ | 838/1000 [00:23<00:03, 47.53it/s, 511 steps of size 7.57e-03. acc. prob=0.85]\rsample:  84%|████████▍ | 843/1000 [00:23<00:03, 47.82it/s, 255 steps of size 7.57e-03. acc. prob=0.85]\rsample:  85%|████████▍ | 849/1000 [00:23<00:03, 48.40it/s, 511 steps of size 7.57e-03. acc. prob=0.85]\rsample:  85%|████████▌ | 854/1000 [00:23<00:03, 47.29it/s, 511 steps of size 7.57e-03. acc. prob=0.85]\rsample:  86%|████████▌ | 859/1000 [00:23<00:03, 46.62it/s, 511 steps of size 7.57e-03. acc. prob=0.85]\rsample:  86%|████████▋ | 864/1000 [00:24<00:02, 46.31it/s, 511 steps of size 7.57e-03. acc. prob=0.85]\rsample:  87%|████████▋ | 869/1000 [00:24<00:02, 47.25it/s, 511 steps of size 7.57e-03. acc. prob=0.86]\rsample:  87%|████████▋ | 874/1000 [00:24<00:02, 46.77it/s, 511 steps of size 7.57e-03. acc. prob=0.86]\rsample:  88%|████████▊ | 879/1000 [00:24<00:02, 46.20it/s, 511 steps of size 7.57e-03. acc. prob=0.86]\rsample:  88%|████████▊ | 885/1000 [00:24<00:02, 48.28it/s, 511 steps of size 7.57e-03. acc. prob=0.86]\rsample:  89%|████████▉ | 890/1000 [00:24<00:02, 47.34it/s, 511 steps of size 7.57e-03. acc. prob=0.86]\rsample:  90%|████████▉ | 895/1000 [00:24<00:02, 48.07it/s, 511 steps of size 7.57e-03. acc. prob=0.86]\rsample:  90%|█████████ | 901/1000 [00:24<00:01, 49.64it/s, 511 steps of size 7.57e-03. acc. prob=0.86]\rsample:  91%|█████████ | 906/1000 [00:24<00:01, 48.13it/s, 511 steps of size 7.57e-03. acc. prob=0.86]\rsample:  91%|█████████ | 911/1000 [00:25<00:01, 44.81it/s, 511 steps of size 7.57e-03. acc. prob=0.86]\rsample:  92%|█████████▏| 916/1000 [00:25<00:01, 44.72it/s, 511 steps of size 7.57e-03. acc. prob=0.86]\rsample:  92%|█████████▏| 921/1000 [00:25<00:01, 44.66it/s, 511 steps of size 7.57e-03. acc. prob=0.86]\rsample:  93%|█████████▎| 926/1000 [00:25<00:01, 44.64it/s, 511 steps of size 7.57e-03. acc. prob=0.86]\rsample:  93%|█████████▎| 931/1000 [00:25<00:01, 44.78it/s, 511 steps of size 7.57e-03. acc. prob=0.86]\rsample:  94%|█████████▎| 936/1000 [00:25<00:01, 43.93it/s, 511 steps of size 7.57e-03. acc. prob=0.86]\rsample:  94%|█████████▍| 941/1000 [00:25<00:01, 44.18it/s, 511 steps of size 7.57e-03. acc. prob=0.86]\rsample:  95%|█████████▍| 946/1000 [00:25<00:01, 43.03it/s, 511 steps of size 7.57e-03. acc. prob=0.86]\rsample:  95%|█████████▌| 951/1000 [00:25<00:01, 44.66it/s, 511 steps of size 7.57e-03. acc. prob=0.86]\rsample:  96%|█████████▌| 956/1000 [00:26<00:00, 44.90it/s, 511 steps of size 7.57e-03. acc. prob=0.86]\rsample:  96%|█████████▌| 962/1000 [00:26<00:00, 48.97it/s, 511 steps of size 7.57e-03. acc. prob=0.86]\rsample:  97%|█████████▋| 967/1000 [00:26<00:00, 47.88it/s, 511 steps of size 7.57e-03. acc. prob=0.86]\rsample:  97%|█████████▋| 972/1000 [00:26<00:00, 47.06it/s, 511 steps of size 7.57e-03. acc. prob=0.86]\rsample:  98%|█████████▊| 977/1000 [00:26<00:00, 46.55it/s, 511 steps of size 7.57e-03. acc. prob=0.86]\rsample:  98%|█████████▊| 982/1000 [00:26<00:00, 47.49it/s, 511 steps of size 7.57e-03. acc. prob=0.86]\rsample:  99%|█████████▊| 987/1000 [00:26<00:00, 45.50it/s, 255 steps of size 7.57e-03. acc. prob=0.86]\rsample:  99%|█████████▉| 993/1000 [00:26<00:00, 47.62it/s, 511 steps of size 7.57e-03. acc. prob=0.86]\rsample: 100%|█████████▉| 998/1000 [00:26<00:00, 46.72it/s, 511 steps of size 7.57e-03. acc. prob=0.86]\rsample: 100%|██████████| 1000/1000 [00:26<00:00, 37.09it/s, 511 steps of size 7.57e-03. acc. prob=0.86]\narviz - WARNING - Shape validation failed: input_shape: (1, 500), minimum_shape: (chains=2, draws=4)\n/home/sosa/work/.venv/lib/python3.12/site-packages/arviz/plots/hdiplot.py:166: FutureWarning:\n\nhdi currently interprets 2d data as (draw, shape) but this will change in a future release to (chain, draw) for coherence with other functions\n\n/home/sosa/work/.venv/lib/python3.12/site-packages/arviz/plots/hdiplot.py:166: FutureWarning:\n\nhdi currently interprets 2d data as (draw, shape) but this will change in a future release to (chain, draw) for coherence with other functions\n\n/home/sosa/work/.venv/lib/python3.12/site-packages/arviz/plots/hdiplot.py:166: FutureWarning:\n\nhdi currently interprets 2d data as (draw, shape) but this will change in a future release to (chain, draw) for coherence with other functions\n\n/home/sosa/work/.venv/lib/python3.12/site-packages/arviz/plots/hdiplot.py:166: FutureWarning:\n\nhdi currently interprets 2d data as (draw, shape) but this will change in a future release to (chain, draw) for coherence with other functions\n\n```\n:::\n\n::: {.cell-output .cell-output-display}\n![](Build in models_files/figure-html/cell-3-output-3.png){}\n:::\n:::\n\n\n# Gaussian Mixture Models\n\n::: {#03af2f7d .cell execution_count=3}\n``` {.python .cell-code}\nfrom BI import bi\nfrom sklearn.datasets import make_blobs\n\n# Generate synthetic data\ndata, true_labels = make_blobs(\n    n_samples=500, centers=8, cluster_std=0.8,\n    center_box=(-10,10), random_state=101\n)\n\n\nm.data_on_model = {\"data\": data,\"K\": 8 }\nm.fit(m.models.gmm) # Optimize model parameters through MCMC sampling\nm.plot(X=data,sampler=m.sampler) # Prebuild plot function for GMM\n```\n\n::: {.cell-output .cell-output-stderr}\n```\n\r  0%|          | 0/1000 [00:00<?, ?it/s]\rwarmup:   0%|          | 1/1000 [00:02<46:46,  2.81s/it, 1 steps of size 2.34e+00. acc. prob=0.00]\rwarmup:   3%|▎         | 28/1000 [00:02<01:12, 13.40it/s, 15 steps of size 1.96e-02. acc. prob=0.72]\rwarmup:   4%|▍         | 44/1000 [00:03<00:41, 22.82it/s, 7 steps of size 1.20e-01. acc. prob=0.76] \rwarmup:   8%|▊         | 76/1000 [00:03<00:19, 47.80it/s, 7 steps of size 3.01e-02. acc. prob=0.76]\rwarmup:  10%|█         | 101/1000 [00:03<00:13, 69.03it/s, 127 steps of size 4.61e-01. acc. prob=0.77]\rwarmup:  13%|█▎        | 126/1000 [00:03<00:09, 92.91it/s, 15 steps of size 6.26e-01. acc. prob=0.78] \rwarmup:  15%|█▌        | 154/1000 [00:03<00:06, 121.93it/s, 31 steps of size 1.50e-01. acc. prob=0.77]\rwarmup:  18%|█▊        | 180/1000 [00:03<00:05, 147.30it/s, 7 steps of size 2.76e-01. acc. prob=0.78] \rwarmup:  21%|██        | 207/1000 [00:03<00:04, 172.09it/s, 15 steps of size 4.68e-01. acc. prob=0.78]\rwarmup:  24%|██▎       | 235/1000 [00:03<00:03, 196.10it/s, 15 steps of size 5.92e-01. acc. prob=0.78]\rwarmup:  26%|██▋       | 264/1000 [00:03<00:03, 217.70it/s, 15 steps of size 4.06e-01. acc. prob=0.78]\rwarmup:  29%|██▉       | 291/1000 [00:03<00:03, 217.93it/s, 7 steps of size 2.92e-01. acc. prob=0.78] \rwarmup:  32%|███▏      | 321/1000 [00:04<00:02, 238.62it/s, 15 steps of size 3.90e-01. acc. prob=0.78]\rwarmup:  35%|███▌      | 353/1000 [00:04<00:02, 257.70it/s, 15 steps of size 3.73e-01. acc. prob=0.78]\rwarmup:  39%|███▊      | 387/1000 [00:04<00:02, 280.05it/s, 7 steps of size 5.77e-01. acc. prob=0.79] \rwarmup:  42%|████▏     | 423/1000 [00:04<00:01, 302.44it/s, 15 steps of size 4.64e-01. acc. prob=0.79]\rwarmup:  46%|████▌     | 457/1000 [00:04<00:01, 311.88it/s, 15 steps of size 5.59e-01. acc. prob=0.79]\rwarmup:  49%|████▉     | 490/1000 [00:04<00:01, 310.42it/s, 7 steps of size 1.28e-01. acc. prob=0.78] \rsample:  52%|█████▏    | 522/1000 [00:04<00:01, 295.07it/s, 15 steps of size 4.07e-01. acc. prob=0.87]\rsample:  55%|█████▌    | 553/1000 [00:04<00:01, 290.93it/s, 15 steps of size 4.07e-01. acc. prob=0.89]\rsample:  58%|█████▊    | 584/1000 [00:04<00:01, 293.47it/s, 15 steps of size 4.07e-01. acc. prob=0.89]\rsample:  61%|██████▏   | 614/1000 [00:05<00:01, 281.86it/s, 7 steps of size 4.07e-01. acc. prob=0.90] \rsample:  64%|██████▍   | 643/1000 [00:05<00:01, 283.74it/s, 7 steps of size 4.07e-01. acc. prob=0.90]\rsample:  67%|██████▋   | 672/1000 [00:05<00:01, 283.40it/s, 7 steps of size 4.07e-01. acc. prob=0.90]\rsample:  70%|███████   | 701/1000 [00:05<00:01, 284.00it/s, 15 steps of size 4.07e-01. acc. prob=0.90]\rsample:  73%|███████▎  | 730/1000 [00:05<00:00, 274.07it/s, 15 steps of size 4.07e-01. acc. prob=0.90]\rsample:  76%|███████▌  | 760/1000 [00:05<00:00, 279.13it/s, 15 steps of size 4.07e-01. acc. prob=0.90]\rsample:  79%|███████▉  | 789/1000 [00:05<00:00, 273.04it/s, 7 steps of size 4.07e-01. acc. prob=0.90] \rsample:  82%|████████▏ | 818/1000 [00:05<00:00, 277.64it/s, 7 steps of size 4.07e-01. acc. prob=0.89]\rsample:  85%|████████▍ | 846/1000 [00:05<00:00, 275.29it/s, 15 steps of size 4.07e-01. acc. prob=0.89]\rsample:  87%|████████▋ | 874/1000 [00:05<00:00, 273.87it/s, 15 steps of size 4.07e-01. acc. prob=0.90]\rsample:  90%|█████████ | 904/1000 [00:06<00:00, 281.37it/s, 7 steps of size 4.07e-01. acc. prob=0.90] \rsample:  93%|█████████▎| 933/1000 [00:06<00:00, 280.85it/s, 15 steps of size 4.07e-01. acc. prob=0.90]\rsample:  96%|█████████▌| 962/1000 [00:06<00:00, 280.39it/s, 7 steps of size 4.07e-01. acc. prob=0.89] \rsample:  99%|█████████▉| 991/1000 [00:06<00:00, 282.27it/s, 15 steps of size 4.07e-01. acc. prob=0.89]\rsample: 100%|██████████| 1000/1000 [00:06<00:00, 156.02it/s, 15 steps of size 4.07e-01. acc. prob=0.90]\n```\n:::\n\n::: {.cell-output .cell-output-display}\n![](Build in models_files/figure-html/cell-4-output-2.png){}\n:::\n\n::: {.cell-output .cell-output-stdout}\n```\nModel not supported\n```\n:::\n:::\n\n\n# Dirichlet Process Mixture Models\n\n\n## Python\n\n::: {#ea1ad1d8 .cell execution_count=4}\n``` {.python .cell-code}\nfrom BI import bi\nfrom sklearn.datasets import make_blobs\n\n# Generate synthetic data\ndata, true_labels = make_blobs(\n    n_samples=500, centers=8, cluster_std=0.8,\n    center_box=(-10,10), random_state=101\n)\n\nm.data_on_model = {\"data\": data, \"T\": 10 } # T = Number of maximum cluster to test for\nm.fit(m.models.dpmm) \nm.plot(X=data,sampler=m.sampler) # Prebuild plot function for GMM\n```\n\n::: {.cell-output .cell-output-stderr}\n```\n\r  0%|          | 0/1000 [00:00<?, ?it/s]\rwarmup:   0%|          | 1/1000 [00:04<1:07:36,  4.06s/it, 1 steps of size 2.34e+00. acc. prob=0.00]\rwarmup:   2%|▏         | 15/1000 [00:04<03:26,  4.77it/s, 511 steps of size 9.88e-03. acc. prob=0.65]\rwarmup:   2%|▏         | 19/1000 [00:04<02:43,  6.01it/s, 511 steps of size 5.50e-03. acc. prob=0.67]\rwarmup:   2%|▏         | 22/1000 [00:04<02:24,  6.75it/s, 127 steps of size 1.59e-02. acc. prob=0.70]\rwarmup:   2%|▎         | 25/1000 [00:04<02:00,  8.08it/s, 63 steps of size 5.95e-02. acc. prob=0.73] \rwarmup:   3%|▎         | 28/1000 [00:05<01:39,  9.79it/s, 127 steps of size 2.94e-02. acc. prob=0.73]\rwarmup:   3%|▎         | 31/1000 [00:05<01:21, 11.94it/s, 255 steps of size 1.59e-02. acc. prob=0.72]\rwarmup:   4%|▎         | 37/1000 [00:05<01:01, 15.55it/s, 511 steps of size 2.80e-02. acc. prob=0.74]\rwarmup:   4%|▍         | 40/1000 [00:05<01:03, 15.21it/s, 31 steps of size 3.96e-02. acc. prob=0.75] \rwarmup:   4%|▍         | 45/1000 [00:05<00:47, 19.98it/s, 159 steps of size 8.74e-02. acc. prob=0.76]\rwarmup:   5%|▍         | 48/1000 [00:05<00:53, 17.73it/s, 383 steps of size 3.51e-02. acc. prob=0.75]\rwarmup:   5%|▌         | 53/1000 [00:06<00:41, 22.84it/s, 31 steps of size 1.22e-01. acc. prob=0.76] \rwarmup:   6%|▌         | 57/1000 [00:06<00:39, 23.69it/s, 127 steps of size 7.05e-02. acc. prob=0.76]\rwarmup:   6%|▋         | 64/1000 [00:06<00:28, 32.71it/s, 55 steps of size 4.99e-02. acc. prob=0.76] \rwarmup:   7%|▋         | 70/1000 [00:06<00:26, 35.76it/s, 127 steps of size 3.14e-02. acc. prob=0.76]\rwarmup:   8%|▊         | 76/1000 [00:06<00:23, 39.16it/s, 127 steps of size 8.55e-02. acc. prob=0.77]\rwarmup:   8%|▊         | 81/1000 [00:06<00:23, 39.16it/s, 71 steps of size 8.10e-02. acc. prob=0.77] \rwarmup:   9%|▉         | 88/1000 [00:06<00:19, 45.69it/s, 23 steps of size 9.41e-02. acc. prob=0.77]\rwarmup:  10%|▉         | 95/1000 [00:06<00:17, 50.39it/s, 95 steps of size 5.95e-02. acc. prob=0.77]\rwarmup:  10%|█         | 101/1000 [00:07<00:17, 51.60it/s, 63 steps of size 1.04e+00. acc. prob=0.78]\rwarmup:  11%|█         | 107/1000 [00:07<00:20, 42.55it/s, 127 steps of size 1.08e-01. acc. prob=0.77]\rwarmup:  11%|█         | 112/1000 [00:07<00:20, 42.30it/s, 31 steps of size 1.23e-02. acc. prob=0.76] \rwarmup:  12%|█▏        | 117/1000 [00:07<00:25, 34.46it/s, 31 steps of size 1.84e-02. acc. prob=0.77]\rwarmup:  12%|█▏        | 121/1000 [00:07<00:27, 32.04it/s, 63 steps of size 1.35e-01. acc. prob=0.77]\rwarmup:  12%|█▎        | 125/1000 [00:07<00:27, 31.48it/s, 127 steps of size 5.72e-02. acc. prob=0.77]\rwarmup:  13%|█▎        | 129/1000 [00:08<00:31, 27.91it/s, 255 steps of size 4.65e-02. acc. prob=0.77]\rwarmup:  14%|█▎        | 135/1000 [00:08<00:25, 34.19it/s, 63 steps of size 1.61e-01. acc. prob=0.78] \rwarmup:  14%|█▍        | 139/1000 [00:08<00:26, 32.81it/s, 63 steps of size 8.10e-02. acc. prob=0.77]\rwarmup:  14%|█▍        | 143/1000 [00:08<00:27, 31.15it/s, 127 steps of size 6.67e-02. acc. prob=0.77]\rwarmup:  15%|█▌        | 150/1000 [00:08<00:22, 38.42it/s, 63 steps of size 8.31e-02. acc. prob=0.78] \rwarmup:  16%|█▌        | 156/1000 [00:08<00:19, 42.50it/s, 63 steps of size 1.53e-01. acc. prob=0.77]\rwarmup:  16%|█▋        | 163/1000 [00:08<00:17, 49.09it/s, 31 steps of size 2.88e-02. acc. prob=0.77]\rwarmup:  17%|█▋        | 169/1000 [00:08<00:17, 46.63it/s, 127 steps of size 4.86e-02. acc. prob=0.77]\rwarmup:  17%|█▋        | 174/1000 [00:09<00:24, 33.19it/s, 127 steps of size 7.51e-02. acc. prob=0.77]\rwarmup:  18%|█▊        | 180/1000 [00:09<00:21, 38.08it/s, 63 steps of size 1.57e-01. acc. prob=0.78] \rwarmup:  19%|█▉        | 188/1000 [00:09<00:17, 45.65it/s, 63 steps of size 1.08e-01. acc. prob=0.78]\rwarmup:  20%|█▉        | 196/1000 [00:09<00:14, 53.61it/s, 31 steps of size 2.67e-01. acc. prob=0.78]\rwarmup:  21%|██        | 207/1000 [00:09<00:11, 66.48it/s, 63 steps of size 1.53e-01. acc. prob=0.78]\rwarmup:  22%|██▏       | 215/1000 [00:09<00:12, 64.06it/s, 15 steps of size 7.63e-02. acc. prob=0.78]\rwarmup:  22%|██▎       | 225/1000 [00:09<00:10, 73.01it/s, 31 steps of size 2.22e-01. acc. prob=0.78]\rwarmup:  23%|██▎       | 233/1000 [00:09<00:10, 73.46it/s, 15 steps of size 2.23e-01. acc. prob=0.78]\rwarmup:  24%|██▍       | 242/1000 [00:10<00:10, 74.40it/s, 63 steps of size 1.26e-01. acc. prob=0.78]\rwarmup:  25%|██▌       | 251/1000 [00:10<00:09, 78.15it/s, 31 steps of size 1.21e+00. acc. prob=0.78]\rwarmup:  26%|██▌       | 260/1000 [00:10<00:10, 69.48it/s, 63 steps of size 8.54e-03. acc. prob=0.78]\rwarmup:  27%|██▋       | 268/1000 [00:10<00:18, 39.32it/s, 127 steps of size 5.43e-02. acc. prob=0.78]\rwarmup:  27%|██▋       | 274/1000 [00:10<00:17, 42.25it/s, 31 steps of size 1.37e-01. acc. prob=0.78] \rwarmup:  28%|██▊       | 281/1000 [00:10<00:15, 45.67it/s, 63 steps of size 8.61e-02. acc. prob=0.78]\rwarmup:  29%|██▊       | 287/1000 [00:11<00:15, 45.68it/s, 127 steps of size 5.90e-02. acc. prob=0.78]\rwarmup:  29%|██▉       | 293/1000 [00:11<00:17, 40.39it/s, 31 steps of size 1.70e-01. acc. prob=0.78] \rwarmup:  30%|███       | 301/1000 [00:11<00:14, 47.96it/s, 31 steps of size 9.80e-02. acc. prob=0.78]\rwarmup:  31%|███       | 307/1000 [00:11<00:16, 40.96it/s, 127 steps of size 7.81e-03. acc. prob=0.78]\rwarmup:  31%|███       | 312/1000 [00:12<00:25, 26.77it/s, 127 steps of size 5.03e-02. acc. prob=0.78]\rwarmup:  32%|███▏      | 321/1000 [00:12<00:18, 36.37it/s, 63 steps of size 9.57e-02. acc. prob=0.78] \rwarmup:  33%|███▎      | 328/1000 [00:12<00:16, 41.50it/s, 63 steps of size 1.32e-01. acc. prob=0.78]\rwarmup:  34%|███▎      | 335/1000 [00:12<00:14, 45.99it/s, 63 steps of size 6.82e-02. acc. prob=0.78]\rwarmup:  34%|███▍      | 341/1000 [00:12<00:14, 46.74it/s, 63 steps of size 2.19e-02. acc. prob=0.78]\rwarmup:  35%|███▍      | 347/1000 [00:12<00:15, 41.48it/s, 31 steps of size 1.53e-01. acc. prob=0.78]\rwarmup:  35%|███▌      | 352/1000 [00:12<00:15, 42.04it/s, 63 steps of size 5.96e-02. acc. prob=0.78]\rwarmup:  36%|███▌      | 358/1000 [00:12<00:14, 44.03it/s, 95 steps of size 1.07e-01. acc. prob=0.78]\rwarmup:  36%|███▋      | 365/1000 [00:13<00:13, 48.50it/s, 63 steps of size 7.18e-02. acc. prob=0.78]\rwarmup:  37%|███▋      | 371/1000 [00:13<00:12, 48.69it/s, 63 steps of size 7.15e-02. acc. prob=0.78]\rwarmup:  38%|███▊      | 377/1000 [00:13<00:12, 48.25it/s, 127 steps of size 5.55e-02. acc. prob=0.78]\rwarmup:  38%|███▊      | 383/1000 [00:13<00:12, 50.14it/s, 63 steps of size 9.71e-02. acc. prob=0.78] \rwarmup:  39%|███▉      | 389/1000 [00:13<00:12, 48.92it/s, 127 steps of size 5.07e-02. acc. prob=0.78]\rwarmup:  39%|███▉      | 394/1000 [00:13<00:12, 47.39it/s, 127 steps of size 4.60e-02. acc. prob=0.78]\rwarmup:  40%|███▉      | 399/1000 [00:13<00:13, 44.14it/s, 63 steps of size 6.21e-02. acc. prob=0.78] \rwarmup:  40%|████      | 404/1000 [00:13<00:13, 43.63it/s, 63 steps of size 7.85e-02. acc. prob=0.78]\rwarmup:  41%|████      | 409/1000 [00:14<00:17, 32.84it/s, 127 steps of size 4.02e-02. acc. prob=0.78]\rwarmup:  41%|████▏     | 413/1000 [00:14<00:18, 31.86it/s, 63 steps of size 8.14e-02. acc. prob=0.78] \rwarmup:  42%|████▏     | 420/1000 [00:14<00:15, 38.46it/s, 63 steps of size 1.17e-01. acc. prob=0.79]\rwarmup:  43%|████▎     | 429/1000 [00:14<00:11, 48.74it/s, 63 steps of size 1.02e-01. acc. prob=0.79]\rwarmup:  44%|████▎     | 435/1000 [00:14<00:11, 49.66it/s, 63 steps of size 9.54e-02. acc. prob=0.79]\rwarmup:  44%|████▍     | 441/1000 [00:14<00:10, 50.96it/s, 31 steps of size 1.28e-01. acc. prob=0.79]\rwarmup:  45%|████▍     | 447/1000 [00:14<00:11, 49.07it/s, 63 steps of size 5.09e-02. acc. prob=0.78]\rwarmup:  45%|████▌     | 453/1000 [00:15<00:14, 38.32it/s, 63 steps of size 1.02e-02. acc. prob=0.78]\rwarmup:  46%|████▌     | 458/1000 [00:15<00:17, 31.71it/s, 63 steps of size 5.24e-02. acc. prob=0.78]\rwarmup:  46%|████▋     | 465/1000 [00:15<00:15, 34.17it/s, 255 steps of size 2.61e-02. acc. prob=0.78]\rwarmup:  47%|████▋     | 469/1000 [00:15<00:15, 34.34it/s, 63 steps of size 1.63e-01. acc. prob=0.78] \rwarmup:  47%|████▋     | 473/1000 [00:15<00:15, 32.98it/s, 63 steps of size 9.14e-02. acc. prob=0.78]\rwarmup:  48%|████▊     | 477/1000 [00:15<00:16, 31.99it/s, 127 steps of size 4.32e-02. acc. prob=0.78]\rwarmup:  48%|████▊     | 481/1000 [00:16<00:26, 19.90it/s, 255 steps of size 2.60e-02. acc. prob=0.78]\rwarmup:  48%|████▊     | 484/1000 [00:16<00:25, 20.54it/s, 63 steps of size 8.64e-02. acc. prob=0.78] \rwarmup:  49%|████▉     | 488/1000 [00:16<00:21, 23.93it/s, 63 steps of size 8.34e-02. acc. prob=0.78]\rwarmup:  49%|████▉     | 491/1000 [00:16<00:20, 25.05it/s, 63 steps of size 1.05e-01. acc. prob=0.78]\rwarmup:  50%|████▉     | 496/1000 [00:16<00:16, 30.31it/s, 63 steps of size 2.10e-02. acc. prob=0.78]\rwarmup:  50%|█████     | 500/1000 [00:16<00:17, 27.80it/s, 63 steps of size 4.79e-02. acc. prob=0.78]\rsample:  50%|█████     | 505/1000 [00:17<00:15, 31.54it/s, 63 steps of size 4.79e-02. acc. prob=0.97]\rsample:  51%|█████     | 509/1000 [00:17<00:15, 32.26it/s, 127 steps of size 4.79e-02. acc. prob=0.96]\rsample:  52%|█████▏    | 515/1000 [00:17<00:12, 37.64it/s, 63 steps of size 4.79e-02. acc. prob=0.96] \rsample:  52%|█████▏    | 521/1000 [00:17<00:11, 41.81it/s, 63 steps of size 4.79e-02. acc. prob=0.96]\rsample:  53%|█████▎    | 526/1000 [00:17<00:11, 41.86it/s, 63 steps of size 4.79e-02. acc. prob=0.96]\rsample:  53%|█████▎    | 532/1000 [00:17<00:10, 44.53it/s, 63 steps of size 4.79e-02. acc. prob=0.96]\rsample:  54%|█████▎    | 537/1000 [00:17<00:11, 41.48it/s, 127 steps of size 4.79e-02. acc. prob=0.95]\rsample:  54%|█████▍    | 542/1000 [00:17<00:11, 39.04it/s, 63 steps of size 4.79e-02. acc. prob=0.96] \rsample:  55%|█████▍    | 546/1000 [00:17<00:11, 38.09it/s, 127 steps of size 4.79e-02. acc. prob=0.96]\rsample:  55%|█████▌    | 550/1000 [00:18<00:11, 38.37it/s, 63 steps of size 4.79e-02. acc. prob=0.96] \rsample:  56%|█████▌    | 555/1000 [00:18<00:11, 39.97it/s, 63 steps of size 4.79e-02. acc. prob=0.96]\rsample:  56%|█████▌    | 561/1000 [00:18<00:10, 43.79it/s, 63 steps of size 4.79e-02. acc. prob=0.95]\rsample:  57%|█████▋    | 566/1000 [00:18<00:10, 43.35it/s, 127 steps of size 4.79e-02. acc. prob=0.96]\rsample:  57%|█████▋    | 571/1000 [00:18<00:09, 42.97it/s, 63 steps of size 4.79e-02. acc. prob=0.95] \rsample:  58%|█████▊    | 576/1000 [00:18<00:09, 42.92it/s, 63 steps of size 4.79e-02. acc. prob=0.95]\rsample:  58%|█████▊    | 581/1000 [00:18<00:10, 41.51it/s, 127 steps of size 4.79e-02. acc. prob=0.95]\rsample:  59%|█████▊    | 587/1000 [00:18<00:09, 44.30it/s, 63 steps of size 4.79e-02. acc. prob=0.95] \rsample:  59%|█████▉    | 592/1000 [00:19<00:08, 45.78it/s, 63 steps of size 4.79e-02. acc. prob=0.95]\rsample:  60%|█████▉    | 598/1000 [00:19<00:08, 47.80it/s, 63 steps of size 4.79e-02. acc. prob=0.95]\rsample:  60%|██████    | 603/1000 [00:19<00:08, 46.55it/s, 127 steps of size 4.79e-02. acc. prob=0.95]\rsample:  61%|██████    | 608/1000 [00:19<00:08, 47.40it/s, 63 steps of size 4.79e-02. acc. prob=0.95] \rsample:  61%|██████▏   | 613/1000 [00:19<00:08, 43.80it/s, 63 steps of size 4.79e-02. acc. prob=0.95]\rsample:  62%|██████▏   | 619/1000 [00:19<00:08, 45.66it/s, 63 steps of size 4.79e-02. acc. prob=0.95]\rsample:  62%|██████▏   | 624/1000 [00:19<00:08, 46.77it/s, 63 steps of size 4.79e-02. acc. prob=0.95]\rsample:  63%|██████▎   | 630/1000 [00:19<00:07, 47.68it/s, 63 steps of size 4.79e-02. acc. prob=0.96]\rsample:  64%|██████▎   | 635/1000 [00:19<00:07, 47.65it/s, 63 steps of size 4.79e-02. acc. prob=0.96]\rsample:  64%|██████▍   | 640/1000 [00:20<00:07, 46.02it/s, 63 steps of size 4.79e-02. acc. prob=0.96]\rsample:  64%|██████▍   | 645/1000 [00:20<00:07, 45.85it/s, 63 steps of size 4.79e-02. acc. prob=0.95]\rsample:  65%|██████▌   | 650/1000 [00:20<00:07, 44.93it/s, 127 steps of size 4.79e-02. acc. prob=0.96]\rsample:  66%|██████▌   | 655/1000 [00:20<00:07, 43.89it/s, 63 steps of size 4.79e-02. acc. prob=0.96] \rsample:  66%|██████▌   | 660/1000 [00:20<00:08, 38.23it/s, 63 steps of size 4.79e-02. acc. prob=0.96]\rsample:  66%|██████▋   | 664/1000 [00:20<00:08, 38.46it/s, 63 steps of size 4.79e-02. acc. prob=0.96]\rsample:  67%|██████▋   | 670/1000 [00:20<00:08, 39.84it/s, 127 steps of size 4.79e-02. acc. prob=0.96]\rsample:  68%|██████▊   | 675/1000 [00:20<00:07, 41.03it/s, 63 steps of size 4.79e-02. acc. prob=0.96] \rsample:  68%|██████▊   | 680/1000 [00:21<00:07, 41.55it/s, 63 steps of size 4.79e-02. acc. prob=0.95]\rsample:  69%|██████▊   | 686/1000 [00:21<00:06, 45.01it/s, 63 steps of size 4.79e-02. acc. prob=0.95]\rsample:  69%|██████▉   | 692/1000 [00:21<00:06, 46.92it/s, 63 steps of size 4.79e-02. acc. prob=0.95]\rsample:  70%|██████▉   | 697/1000 [00:21<00:06, 46.10it/s, 63 steps of size 4.79e-02. acc. prob=0.95]\rsample:  70%|███████   | 703/1000 [00:21<00:06, 47.49it/s, 63 steps of size 4.79e-02. acc. prob=0.95]\rsample:  71%|███████   | 709/1000 [00:21<00:05, 48.80it/s, 63 steps of size 4.79e-02. acc. prob=0.95]\rsample:  71%|███████▏  | 714/1000 [00:21<00:06, 43.34it/s, 63 steps of size 4.79e-02. acc. prob=0.95]\rsample:  72%|███████▏  | 719/1000 [00:21<00:06, 42.94it/s, 63 steps of size 4.79e-02. acc. prob=0.95]\rsample:  72%|███████▎  | 725/1000 [00:22<00:06, 45.12it/s, 63 steps of size 4.79e-02. acc. prob=0.95]\rsample:  73%|███████▎  | 731/1000 [00:22<00:05, 46.76it/s, 63 steps of size 4.79e-02. acc. prob=0.95]\rsample:  74%|███████▎  | 736/1000 [00:22<00:05, 45.40it/s, 63 steps of size 4.79e-02. acc. prob=0.95]\rsample:  74%|███████▍  | 741/1000 [00:22<00:05, 44.14it/s, 63 steps of size 4.79e-02. acc. prob=0.95]\rsample:  75%|███████▍  | 746/1000 [00:22<00:05, 44.27it/s, 63 steps of size 4.79e-02. acc. prob=0.95]\rsample:  75%|███████▌  | 751/1000 [00:22<00:05, 44.01it/s, 63 steps of size 4.79e-02. acc. prob=0.95]\rsample:  76%|███████▌  | 757/1000 [00:22<00:05, 45.87it/s, 63 steps of size 4.79e-02. acc. prob=0.95]\rsample:  76%|███████▌  | 762/1000 [00:22<00:05, 42.77it/s, 63 steps of size 4.79e-02. acc. prob=0.95]\rsample:  77%|███████▋  | 768/1000 [00:22<00:05, 45.08it/s, 63 steps of size 4.79e-02. acc. prob=0.95]\rsample:  77%|███████▋  | 774/1000 [00:23<00:04, 46.79it/s, 63 steps of size 4.79e-02. acc. prob=0.95]\rsample:  78%|███████▊  | 779/1000 [00:23<00:12, 17.13it/s, 63 steps of size 4.79e-02. acc. prob=0.95]\rsample:  78%|███████▊  | 784/1000 [00:24<00:10, 20.18it/s, 191 steps of size 4.79e-02. acc. prob=0.95]\rsample:  79%|███████▉  | 788/1000 [00:24<00:09, 21.81it/s, 127 steps of size 4.79e-02. acc. prob=0.94]\rsample:  79%|███████▉  | 793/1000 [00:24<00:07, 26.30it/s, 63 steps of size 4.79e-02. acc. prob=0.94] \rsample:  80%|███████▉  | 798/1000 [00:24<00:06, 30.14it/s, 127 steps of size 4.79e-02. acc. prob=0.94]\rsample:  80%|████████  | 803/1000 [00:24<00:06, 31.67it/s, 127 steps of size 4.79e-02. acc. prob=0.95]\rsample:  81%|████████  | 807/1000 [00:24<00:05, 32.27it/s, 63 steps of size 4.79e-02. acc. prob=0.94] \rsample:  81%|████████  | 812/1000 [00:24<00:05, 35.41it/s, 63 steps of size 4.79e-02. acc. prob=0.95]\rsample:  82%|████████▏ | 816/1000 [00:24<00:05, 33.68it/s, 63 steps of size 4.79e-02. acc. prob=0.94]\rsample:  82%|████████▏ | 820/1000 [00:25<00:05, 30.83it/s, 63 steps of size 4.79e-02. acc. prob=0.95]\rsample:  82%|████████▏ | 824/1000 [00:25<00:05, 32.45it/s, 63 steps of size 4.79e-02. acc. prob=0.95]\rsample:  83%|████████▎ | 828/1000 [00:25<00:05, 31.97it/s, 63 steps of size 4.79e-02. acc. prob=0.95]\rsample:  83%|████████▎ | 832/1000 [00:25<00:05, 31.57it/s, 63 steps of size 4.79e-02. acc. prob=0.95]\rsample:  84%|████████▎ | 837/1000 [00:25<00:04, 33.69it/s, 127 steps of size 4.79e-02. acc. prob=0.95]\rsample:  84%|████████▍ | 842/1000 [00:25<00:04, 36.85it/s, 63 steps of size 4.79e-02. acc. prob=0.95] \rsample:  85%|████████▍ | 846/1000 [00:25<00:04, 36.84it/s, 63 steps of size 4.79e-02. acc. prob=0.94]\rsample:  85%|████████▌ | 850/1000 [00:25<00:04, 34.42it/s, 127 steps of size 4.79e-02. acc. prob=0.94]\rsample:  85%|████████▌ | 854/1000 [00:25<00:04, 35.85it/s, 63 steps of size 4.79e-02. acc. prob=0.94] \rsample:  86%|████████▌ | 859/1000 [00:26<00:03, 38.27it/s, 63 steps of size 4.79e-02. acc. prob=0.94]\rsample:  86%|████████▋ | 865/1000 [00:26<00:03, 42.00it/s, 63 steps of size 4.79e-02. acc. prob=0.95]\rsample:  87%|████████▋ | 870/1000 [00:26<00:02, 43.62it/s, 63 steps of size 4.79e-02. acc. prob=0.95]\rsample:  88%|████████▊ | 875/1000 [00:26<00:02, 44.90it/s, 63 steps of size 4.79e-02. acc. prob=0.94]\rsample:  88%|████████▊ | 881/1000 [00:26<00:02, 44.17it/s, 127 steps of size 4.79e-02. acc. prob=0.94]\rsample:  89%|████████▊ | 886/1000 [00:26<00:02, 43.50it/s, 127 steps of size 4.79e-02. acc. prob=0.94]\rsample:  89%|████████▉ | 891/1000 [00:26<00:02, 39.59it/s, 127 steps of size 4.79e-02. acc. prob=0.94]\rsample:  90%|████████▉ | 896/1000 [00:26<00:02, 41.93it/s, 63 steps of size 4.79e-02. acc. prob=0.94] \rsample:  90%|█████████ | 902/1000 [00:27<00:02, 44.79it/s, 63 steps of size 4.79e-02. acc. prob=0.94]\rsample:  91%|█████████ | 907/1000 [00:27<00:02, 46.08it/s, 63 steps of size 4.79e-02. acc. prob=0.94]\rsample:  91%|█████████ | 912/1000 [00:27<00:01, 44.96it/s, 63 steps of size 4.79e-02. acc. prob=0.95]\rsample:  92%|█████████▏| 917/1000 [00:27<00:02, 40.46it/s, 63 steps of size 4.79e-02. acc. prob=0.95]\rsample:  92%|█████████▏| 922/1000 [00:27<00:01, 41.19it/s, 127 steps of size 4.79e-02. acc. prob=0.94]\rsample:  93%|█████████▎| 927/1000 [00:27<00:01, 40.55it/s, 63 steps of size 4.79e-02. acc. prob=0.94] \rsample:  93%|█████████▎| 932/1000 [00:27<00:01, 40.55it/s, 63 steps of size 4.79e-02. acc. prob=0.94]\rsample:  94%|█████████▎| 937/1000 [00:27<00:01, 39.47it/s, 63 steps of size 4.79e-02. acc. prob=0.94]\rsample:  94%|█████████▍| 942/1000 [00:28<00:01, 40.30it/s, 63 steps of size 4.79e-02. acc. prob=0.94]\rsample:  95%|█████████▍| 947/1000 [00:28<00:01, 41.09it/s, 127 steps of size 4.79e-02. acc. prob=0.95]\rsample:  95%|█████████▌| 952/1000 [00:28<00:01, 43.28it/s, 63 steps of size 4.79e-02. acc. prob=0.94] \rsample:  96%|█████████▌| 957/1000 [00:28<00:01, 39.55it/s, 127 steps of size 4.79e-02. acc. prob=0.95]\rsample:  96%|█████████▌| 962/1000 [00:28<00:00, 40.93it/s, 63 steps of size 4.79e-02. acc. prob=0.94] \rsample:  97%|█████████▋| 968/1000 [00:28<00:00, 44.07it/s, 63 steps of size 4.79e-02. acc. prob=0.95]\rsample:  97%|█████████▋| 973/1000 [00:28<00:00, 43.97it/s, 63 steps of size 4.79e-02. acc. prob=0.94]\rsample:  98%|█████████▊| 979/1000 [00:28<00:00, 45.74it/s, 63 steps of size 4.79e-02. acc. prob=0.94]\rsample:  98%|█████████▊| 985/1000 [00:28<00:00, 45.65it/s, 127 steps of size 4.79e-02. acc. prob=0.94]\rsample:  99%|█████████▉| 990/1000 [00:29<00:00, 44.97it/s, 63 steps of size 4.79e-02. acc. prob=0.95] \rsample: 100%|█████████▉| 995/1000 [00:29<00:00, 42.45it/s, 127 steps of size 4.79e-02. acc. prob=0.94]\rsample: 100%|██████████| 1000/1000 [00:29<00:00, 38.89it/s, 63 steps of size 4.79e-02. acc. prob=0.94]\rsample: 100%|██████████| 1000/1000 [00:29<00:00, 34.01it/s, 63 steps of size 4.79e-02. acc. prob=0.94]\n```\n:::\n\n::: {.cell-output .cell-output-stdout}\n```\nModel found 9 clusters.\n```\n:::\n\n::: {.cell-output .cell-output-display}\n![](Build in models_files/figure-html/cell-5-output-3.png){}\n:::\n:::\n\n\n# Network Models\n\n::: {.panel-tabset group=\"language\"}\n## Python\n```Python\nfrom BI import bi\n\n# Setup device------------------------------------------------\nfrom BI import bi\n# Setup device------------------------------------------------\nm = bi(platform='cpu')\n\nm.data_on_model = dict(\n    idx = idx,\n    Any = Any-1, \n    Merica = Merica-1, \n    Quantum = Quantum-1,\n    result_outcomes = m.net.mat_to_edgl(data['outcomes']), \n    kinship = m.net.mat_to_edgl(kinship),\n    focal_individual_predictors = data['individual_predictors'],\n    target_individual_predictors = data['individual_predictors'],\n    exposure_mat = data['exposure']\n)\n\n\ndef model(idx, result_outcomes, \n    exposure,\n    kinship, \n    focal_individual_predictors, target_individual_predictors, \n    Any, Merica, Quantum):\n      # Block ---------------------------------------\n      B_any = m.net.block_model(Any,1)\n      B_Merica = m.net.block_model(Merica,3)\n      B_Quantum = m.net.block_model(Quantum,2)\n\n      ## SR shape =  N individuals---------------------------------------\n      sr =  m.net.sender_receiver(focal_individual_predictors,target_individual_predictors)\n\n      # Dyadic shape = N dyads--------------------------------------  \n      dr = m.net.dyadic_effect(dyadic_predictors)\n\n      m.dist.poisson(jnp.exp(B_any + B_Merica + B_Quantum + sender_receiver + dr), obs = result_outcomes, name= 'latent network' )\n\n\n\nm.fit(model) \nsummary = m.summary()\nsummary.loc[['focal_effects[0]', 'target_effects[0]', 'dyad_effects[0]']]\n\nm.fit(model2) \nsummary = m.summary()\nsummary\n```\n## R\n```r\nlibrary(BI)\n# Setup platform------------------------------------------------\nm=importbi(platform='cpu')\n\n# Import data ------------------------------------------------\n\nload(paste(system.file(package = \"BI\"),'/data/STRAND sim sr only.Rdata', sep = ''))\n\nids = 0:(model_dat$N_id-1)\nidx = m$net$vec_node_to_edgle(jnp$stack(jnp$array(list(ids, ids)), axis = -as.integer(1)))\n\nkeys <- c(\"idx\",\n          'idxShape',\n          \"result_outcomes\",\n          'focal_individual_predictors',\n          'target_individual_predictors')\n\nvalues <- list(\n  idx,\n  idx$shape[[1]],\n  m$net$mat_to_edgl(model_dat$outcomes[,,1]),\n  jnp$array(model_dat$individual_predictors)$reshape(as.integer(1),as.integer(50)),\n  jnp$array(model_dat$individual_predictors)$reshape(as.integer(1),as.integer(50))\n)\ndata = py_dict(keys, values, convert = TRUE)\nm$data_on_model=data\n\n# Define model ------------------------------------------------\nmodel <- function(idx, idxShape, result_outcomes,focal_individual_predictors, target_individual_predictors){\n  N_id = 50\n  x=0.1/jnp$sqrt(N_id)\n  tmp=jnp$log(x / (1 - x))\n  \n  ## Block ---------------------------------------\n  B = bi.dist.normal(tmp, 2.5, shape=c(1), name = 'block')\n  \n  #SR ---------------------------------------\n  sr =  m$net$sender_receiver(focal_individual_predictors,target_individual_predictors)\n  \n  ### Dyadic--------------------------------------  \n  #dr, dr_raw, dr_sigma, dr_L = m.net.dyadic_random_effects(idx.shape[0], cholesky_density = 2)# shape = n dyads\n  dr = m$net$dyadic_effect(shape = c(idxShape))\n\n  ## SR ---------------------------------------                                                      \n  m$poisson(jnp$exp(B + sr + dr), obs=result_outcomes)  \n}\n\n# Run MCMC ------------------------------------------------\nm$fit(model) # Optimize model parameters through MCMC sampling\n\n# Summary ------------------------------------------------\nsummary =m$summary()\n\nsummary[rownames(summary) %in% c('focal_effects[0]', 'target_effects[0]', 'block[0]'),]\n\n```\n:::\n\n",
    "supporting": [
      "Build in models_files"
    ],
    "filters": [],
    "includes": {}
  }
}