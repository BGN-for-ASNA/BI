{
  "hash": "a9b165a371033e1c379a3f4c96245929",
  "result": {
    "engine": "jupyter",
    "markdown": "---\ntitle: \"Build in models\"\nsidebar: start\n---\n\n# PCA\n\n::: {.cell execution_count=1}\n``` {.python .cell-code}\nfrom BI import bi, jnp\n\nm=bi()\nm.data('iris.csv', sep=',') # Data is already scaled\nm.data_on_model = dict(\n    X=jnp.array(m.df.iloc[:,0:-2].values)\n)\nm.fit(m.models.pca(type=\"classic\"), progress_bar=False) # or robust, sparse, classic, sparse_robust_ard\n\nm.models.pca.plot(\n    X=m.df.iloc[:,0:-2].values,\n    y=m.df.iloc[:,-2].values, \n    feature_names=m.df.columns[0:-2], \n    target_names=m.df.iloc[:,-1].unique(),\n    color_var=m.df.iloc[:,0].values,\n    shape_var=m.df.iloc[:,-2].values\n)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\njax.local_device_count 16\n```\n:::\n\n::: {.cell-output .cell-output-display}\n![](Build in models_files/figure-pdf/cell-2-output-2.png){fig-pos='H'}\n:::\n:::\n\n\n# Survival analysis\n\n::: {.cell execution_count=2}\n``` {.python .cell-code}\nfrom BI import bi, jnp\n\nm = bi()\nm.data('mastectomy.csv', sep=',').head()\nm.df.metastasized = (m.df.metastasized.values == \"yes\").astype(jnp.int64)\n\n# Import time-steps and events\nm.models.survival.import_time_even(\n    m.df.time.values, \n    m.df.event.values, interval_length=3\n)\n\n# To import time-fixed covariates\nm.models.survival.import_covF(\n    m.df.metastasized.values, ['metastasized']\n) \n\n# To import time-varying covariates ⚠️ Experimental feature\n# m.models.survival.import_covV \n\nm.fit(m.models.survival.model, num_samples=500) \n\nm.summary()\n\nm.models.survival.plot_surv( beta = 'Hazard_rate_metastasized')\n```\n\n::: {.cell-output .cell-output-stdout}\n```\njax.local_device_count 16\n------------------------------------------------------------------------------\nSurvival concern 44 individuals in 76 intervals.\n18.0 individuals experienced the event.\n------------------------------------------------------------------------------\nCovariates imported: ['metastasized']\nSurv object now has 1 covariates: ['metastasized']\n⚠️This function is still in development. Use it with caution. ⚠️\n⚠️This function is still in development. Use it with caution. ⚠️\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\n\r  0%|          | 0/1000 [00:00<?, ?it/s]\n```\n:::\n\n::: {.cell-output .cell-output-stdout}\n```\n⚠️This function is still in development. Use it with caution. ⚠️\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\n\rwarmup:   0%|          | 1/1000 [00:02<46:26,  2.79s/it, 1 steps of size 2.34e+00. acc. prob=0.00]\rwarmup:   2%|▏         | 18/1000 [00:02<01:54,  8.55it/s, 1023 steps of size 2.28e-01. acc. prob=0.73]\rwarmup:   3%|▎         | 27/1000 [00:03<01:19, 12.20it/s, 1023 steps of size 3.79e-01. acc. prob=0.76]\rwarmup:   3%|▎         | 33/1000 [00:03<01:03, 15.19it/s, 1023 steps of size 1.43e-01. acc. prob=0.75]\rwarmup:   4%|▍         | 39/1000 [00:03<00:56, 17.16it/s, 1023 steps of size 2.71e-01. acc. prob=0.76]\rwarmup:   4%|▍         | 44/1000 [00:03<00:50, 19.04it/s, 1023 steps of size 2.70e-01. acc. prob=0.77]\rwarmup:   5%|▍         | 48/1000 [00:03<00:45, 20.74it/s, 1023 steps of size 3.67e-01. acc. prob=0.77]\rwarmup:   5%|▌         | 52/1000 [00:04<00:41, 22.57it/s, 1023 steps of size 3.01e-01. acc. prob=0.77]\rwarmup:   6%|▌         | 56/1000 [00:04<00:39, 24.20it/s, 1023 steps of size 2.82e-01. acc. prob=0.77]\rwarmup:   6%|▌         | 60/1000 [00:04<00:37, 25.37it/s, 1023 steps of size 1.20e-01. acc. prob=0.77]\rwarmup:   6%|▋         | 64/1000 [00:04<00:37, 24.72it/s, 1023 steps of size 2.20e-01. acc. prob=0.77]\rwarmup:   7%|▋         | 68/1000 [00:04<00:35, 26.16it/s, 1023 steps of size 1.15e-01. acc. prob=0.77]\rwarmup:   7%|▋         | 71/1000 [00:04<00:35, 26.51it/s, 511 steps of size 1.62e-01. acc. prob=0.77] \rwarmup:   7%|▋         | 74/1000 [00:04<00:36, 25.66it/s, 1023 steps of size 1.90e-01. acc. prob=0.77]\rwarmup:   8%|▊         | 78/1000 [00:04<00:32, 28.51it/s, 1023 steps of size 1.96e-01. acc. prob=0.77]\rwarmup:   8%|▊         | 82/1000 [00:05<00:34, 26.77it/s, 1023 steps of size 1.39e-01. acc. prob=0.77]\rwarmup:   9%|▊         | 86/1000 [00:05<00:33, 27.50it/s, 1023 steps of size 1.80e-01. acc. prob=0.78]\rwarmup:   9%|▉         | 89/1000 [00:05<00:32, 27.68it/s, 468 steps of size 2.46e-01. acc. prob=0.78] \rwarmup:   9%|▉         | 92/1000 [00:05<00:32, 27.68it/s, 511 steps of size 3.42e-01. acc. prob=0.78]\rwarmup:  10%|▉         | 96/1000 [00:05<00:31, 28.34it/s, 1023 steps of size 2.73e-01. acc. prob=0.78]\rwarmup:  10%|█         | 100/1000 [00:05<00:29, 30.52it/s, 511 steps of size 3.11e-01. acc. prob=0.78]\rwarmup:  11%|█         | 106/1000 [00:05<00:24, 37.19it/s, 509 steps of size 2.34e-03. acc. prob=0.76]\rwarmup:  11%|█         | 110/1000 [00:05<00:26, 33.23it/s, 511 steps of size 1.93e-02. acc. prob=0.77]\rwarmup:  11%|█▏        | 114/1000 [00:06<00:26, 32.96it/s, 511 steps of size 1.56e-02. acc. prob=0.77]\rwarmup:  12%|█▏        | 118/1000 [00:06<00:25, 34.63it/s, 1023 steps of size 8.59e-03. acc. prob=0.77]\rwarmup:  12%|█▏        | 122/1000 [00:06<00:25, 34.05it/s, 1023 steps of size 9.81e-03. acc. prob=0.77]\rwarmup:  13%|█▎        | 126/1000 [00:06<00:28, 31.03it/s, 1023 steps of size 1.26e-02. acc. prob=0.77]\rwarmup:  13%|█▎        | 130/1000 [00:06<00:27, 31.65it/s, 198 steps of size 5.00e-03. acc. prob=0.77] \rwarmup:  13%|█▎        | 134/1000 [00:06<00:30, 28.29it/s, 1023 steps of size 1.72e-02. acc. prob=0.77]\rwarmup:  14%|█▍        | 139/1000 [00:06<00:28, 30.74it/s, 1023 steps of size 4.45e-03. acc. prob=0.77]\rwarmup:  14%|█▍        | 143/1000 [00:07<00:28, 30.55it/s, 511 steps of size 1.49e-02. acc. prob=0.77] \rwarmup:  15%|█▍        | 147/1000 [00:07<00:26, 32.67it/s, 1023 steps of size 9.29e-03. acc. prob=0.77]\rwarmup:  15%|█▌        | 154/1000 [00:07<00:20, 40.77it/s, 1023 steps of size 2.55e-03. acc. prob=0.76]\rwarmup:  16%|█▌        | 159/1000 [00:07<00:23, 36.55it/s, 511 steps of size 8.84e-03. acc. prob=0.77] \rwarmup:  16%|█▋        | 164/1000 [00:07<00:23, 35.97it/s, 1023 steps of size 6.21e-03. acc. prob=0.77]\rwarmup:  17%|█▋        | 168/1000 [00:07<00:23, 34.90it/s, 1023 steps of size 6.63e-03. acc. prob=0.77]\rwarmup:  17%|█▋        | 172/1000 [00:07<00:23, 34.82it/s, 1023 steps of size 4.67e-03. acc. prob=0.77]\rwarmup:  18%|█▊        | 176/1000 [00:07<00:23, 35.02it/s, 1023 steps of size 9.50e-03. acc. prob=0.77]\rwarmup:  18%|█▊        | 180/1000 [00:08<00:23, 35.59it/s, 511 steps of size 2.24e-03. acc. prob=0.77] \rwarmup:  18%|█▊        | 184/1000 [00:08<00:26, 30.99it/s, 1023 steps of size 8.84e-03. acc. prob=0.77]\rwarmup:  19%|█▉        | 189/1000 [00:08<00:23, 34.78it/s, 511 steps of size 1.24e-02. acc. prob=0.77] \rwarmup:  20%|█▉        | 195/1000 [00:08<00:20, 39.86it/s, 511 steps of size 8.28e-03. acc. prob=0.77]\rwarmup:  20%|██        | 200/1000 [00:08<00:21, 36.43it/s, 511 steps of size 7.31e-03. acc. prob=0.77]\rwarmup:  20%|██        | 204/1000 [00:08<00:23, 34.46it/s, 511 steps of size 9.67e-03. acc. prob=0.77]\rwarmup:  21%|██        | 208/1000 [00:08<00:24, 31.96it/s, 511 steps of size 1.05e-02. acc. prob=0.77]\rwarmup:  21%|██        | 212/1000 [00:09<00:30, 25.93it/s, 1023 steps of size 6.88e-03. acc. prob=0.77]\rwarmup:  22%|██▏       | 215/1000 [00:09<00:29, 26.41it/s, 255 steps of size 5.76e-03. acc. prob=0.77] \rwarmup:  22%|██▏       | 218/1000 [00:09<00:35, 22.00it/s, 511 steps of size 5.51e-03. acc. prob=0.77]\rwarmup:  22%|██▏       | 222/1000 [00:09<00:30, 25.14it/s, 255 steps of size 9.82e-03. acc. prob=0.78]\rwarmup:  22%|██▎       | 225/1000 [00:09<00:31, 24.69it/s, 308 steps of size 4.04e-03. acc. prob=0.77]\rwarmup:  23%|██▎       | 228/1000 [00:09<00:34, 22.29it/s, 366 steps of size 4.27e-03. acc. prob=0.77]\rwarmup:  23%|██▎       | 231/1000 [00:10<00:37, 20.68it/s, 511 steps of size 8.20e-03. acc. prob=0.78]\rwarmup:  24%|██▎       | 237/1000 [00:10<00:27, 27.80it/s, 511 steps of size 5.50e-03. acc. prob=0.78]\rwarmup:  24%|██▍       | 241/1000 [00:10<00:28, 26.65it/s, 1023 steps of size 4.96e-03. acc. prob=0.78]\rwarmup:  24%|██▍       | 245/1000 [00:10<00:28, 26.13it/s, 1023 steps of size 7.12e-03. acc. prob=0.78]\rwarmup:  25%|██▍       | 249/1000 [00:10<00:26, 28.66it/s, 228 steps of size 5.22e-03. acc. prob=0.78] \rwarmup:  25%|██▌       | 254/1000 [00:10<00:23, 31.49it/s, 1023 steps of size 6.18e-03. acc. prob=0.77]\rwarmup:  26%|██▌       | 258/1000 [00:10<00:23, 31.60it/s, 1023 steps of size 8.99e-03. acc. prob=0.77]\rwarmup:  26%|██▋       | 263/1000 [00:10<00:21, 34.54it/s, 1023 steps of size 4.40e-03. acc. prob=0.77]\rwarmup:  27%|██▋       | 268/1000 [00:11<00:20, 34.99it/s, 1023 steps of size 8.42e-03. acc. prob=0.78]\rwarmup:  27%|██▋       | 272/1000 [00:11<00:20, 36.07it/s, 1023 steps of size 6.01e-03. acc. prob=0.78]\rwarmup:  28%|██▊       | 276/1000 [00:11<00:21, 34.27it/s, 1023 steps of size 7.57e-03. acc. prob=0.78]\rwarmup:  28%|██▊       | 280/1000 [00:11<00:21, 32.75it/s, 1023 steps of size 6.77e-03. acc. prob=0.78]\rwarmup:  28%|██▊       | 285/1000 [00:11<00:20, 35.39it/s, 1023 steps of size 6.13e-03. acc. prob=0.78]\rwarmup:  29%|██▉       | 289/1000 [00:11<00:21, 32.65it/s, 1023 steps of size 3.90e-03. acc. prob=0.78]\rwarmup:  29%|██▉       | 294/1000 [00:11<00:19, 35.91it/s, 255 steps of size 6.78e-03. acc. prob=0.78] \rwarmup:  30%|██▉       | 299/1000 [00:11<00:18, 38.57it/s, 511 steps of size 1.32e-02. acc. prob=0.78]\rwarmup:  30%|███       | 303/1000 [00:12<00:18, 36.83it/s, 511 steps of size 8.10e-03. acc. prob=0.78]\rwarmup:  31%|███       | 307/1000 [00:12<00:21, 32.65it/s, 1023 steps of size 7.32e-03. acc. prob=0.78]\rwarmup:  31%|███       | 312/1000 [00:12<00:19, 35.43it/s, 511 steps of size 8.15e-03. acc. prob=0.78] \rwarmup:  32%|███▏      | 316/1000 [00:12<00:18, 36.15it/s, 511 steps of size 1.01e-02. acc. prob=0.78]\rwarmup:  32%|███▏      | 320/1000 [00:12<00:18, 36.84it/s, 1023 steps of size 7.06e-03. acc. prob=0.78]\rwarmup:  32%|███▎      | 325/1000 [00:12<00:18, 36.55it/s, 1023 steps of size 3.26e-03. acc. prob=0.78]\rwarmup:  33%|███▎      | 330/1000 [00:12<00:18, 36.65it/s, 1023 steps of size 6.10e-03. acc. prob=0.78]\rwarmup:  34%|███▎      | 335/1000 [00:12<00:16, 39.95it/s, 511 steps of size 3.42e-03. acc. prob=0.78] \rwarmup:  34%|███▍      | 340/1000 [00:13<00:17, 38.19it/s, 1023 steps of size 4.34e-03. acc. prob=0.78]\rwarmup:  34%|███▍      | 344/1000 [00:13<00:17, 37.14it/s, 1023 steps of size 4.37e-03. acc. prob=0.78]\rwarmup:  35%|███▍      | 348/1000 [00:13<00:17, 36.74it/s, 511 steps of size 2.93e-03. acc. prob=0.78] \rwarmup:  35%|███▌      | 352/1000 [00:13<00:19, 33.51it/s, 255 steps of size 1.03e-02. acc. prob=0.78]\rwarmup:  36%|███▌      | 356/1000 [00:13<00:19, 33.44it/s, 511 steps of size 9.23e-03. acc. prob=0.78]\rwarmup:  36%|███▌      | 361/1000 [00:13<00:17, 37.53it/s, 511 steps of size 6.02e-03. acc. prob=0.78]\rwarmup:  36%|███▋      | 365/1000 [00:13<00:17, 37.29it/s, 1023 steps of size 7.54e-03. acc. prob=0.78]\rwarmup:  37%|███▋      | 371/1000 [00:13<00:15, 41.58it/s, 511 steps of size 4.20e-03. acc. prob=0.78] \rwarmup:  38%|███▊      | 376/1000 [00:14<00:15, 39.45it/s, 215 steps of size 6.27e-03. acc. prob=0.78]\rwarmup:  38%|███▊      | 381/1000 [00:14<00:14, 41.98it/s, 511 steps of size 4.62e-03. acc. prob=0.78]\rwarmup:  39%|███▊      | 386/1000 [00:14<00:13, 43.93it/s, 511 steps of size 9.20e-03. acc. prob=0.78]\rwarmup:  39%|███▉      | 391/1000 [00:14<00:14, 42.80it/s, 255 steps of size 6.51e-03. acc. prob=0.78]\rwarmup:  40%|███▉      | 396/1000 [00:14<00:15, 37.77it/s, 511 steps of size 7.74e-03. acc. prob=0.78]\rwarmup:  40%|████      | 400/1000 [00:14<00:17, 33.40it/s, 1023 steps of size 7.00e-03. acc. prob=0.78]\rwarmup:  40%|████      | 405/1000 [00:14<00:16, 35.00it/s, 1023 steps of size 5.37e-03. acc. prob=0.78]\rwarmup:  41%|████      | 409/1000 [00:14<00:17, 32.97it/s, 1023 steps of size 7.17e-03. acc. prob=0.78]\rwarmup:  42%|████▏     | 415/1000 [00:15<00:15, 37.50it/s, 511 steps of size 8.35e-03. acc. prob=0.78] \rwarmup:  42%|████▏     | 419/1000 [00:15<00:15, 37.22it/s, 511 steps of size 8.28e-03. acc. prob=0.78]\rwarmup:  42%|████▏     | 423/1000 [00:15<00:15, 36.79it/s, 511 steps of size 8.20e-03. acc. prob=0.78]\rwarmup:  43%|████▎     | 428/1000 [00:15<00:15, 37.01it/s, 1023 steps of size 5.94e-03. acc. prob=0.78]\rwarmup:  43%|████▎     | 432/1000 [00:15<00:15, 36.36it/s, 511 steps of size 8.81e-03. acc. prob=0.78] \rwarmup:  44%|████▎     | 437/1000 [00:15<00:15, 37.10it/s, 1023 steps of size 6.33e-03. acc. prob=0.78]\rwarmup:  44%|████▍     | 443/1000 [00:15<00:13, 40.46it/s, 1023 steps of size 5.93e-03. acc. prob=0.78]\rwarmup:  45%|████▍     | 448/1000 [00:15<00:14, 37.37it/s, 1023 steps of size 6.16e-03. acc. prob=0.78]\rwarmup:  45%|████▌     | 452/1000 [00:16<00:14, 37.38it/s, 2 steps of size 1.22e-02. acc. prob=0.78]   \rwarmup:  46%|████▌     | 456/1000 [00:16<00:14, 36.39it/s, 511 steps of size 9.88e-03. acc. prob=0.78]\rwarmup:  46%|████▌     | 462/1000 [00:16<00:12, 41.51it/s, 255 steps of size 1.06e-02. acc. prob=0.78]\rwarmup:  47%|████▋     | 467/1000 [00:16<00:12, 41.73it/s, 1023 steps of size 2.74e-03. acc. prob=0.78]\rwarmup:  47%|████▋     | 472/1000 [00:16<00:14, 36.83it/s, 1023 steps of size 6.48e-03. acc. prob=0.78]\rwarmup:  48%|████▊     | 476/1000 [00:16<00:14, 37.22it/s, 511 steps of size 1.07e-02. acc. prob=0.78] \rwarmup:  48%|████▊     | 481/1000 [00:16<00:13, 39.57it/s, 255 steps of size 1.06e-02. acc. prob=0.78]\rwarmup:  49%|████▊     | 487/1000 [00:16<00:11, 44.75it/s, 511 steps of size 7.08e-03. acc. prob=0.78]\rwarmup:  49%|████▉     | 492/1000 [00:17<00:11, 43.20it/s, 255 steps of size 6.21e-03. acc. prob=0.78]\rwarmup:  50%|████▉     | 497/1000 [00:17<00:11, 42.11it/s, 255 steps of size 7.04e-03. acc. prob=0.78]\rsample:  50%|█████     | 504/1000 [00:17<00:10, 47.03it/s, 511 steps of size 7.57e-03. acc. prob=0.56]\rsample:  51%|█████     | 509/1000 [00:17<00:10, 47.11it/s, 511 steps of size 7.57e-03. acc. prob=0.73]\rsample:  51%|█████▏    | 514/1000 [00:17<00:10, 47.08it/s, 511 steps of size 7.57e-03. acc. prob=0.76]\rsample:  52%|█████▏    | 520/1000 [00:17<00:09, 48.50it/s, 511 steps of size 7.57e-03. acc. prob=0.76]\rsample:  52%|█████▎    | 525/1000 [00:17<00:09, 48.18it/s, 511 steps of size 7.57e-03. acc. prob=0.80]\rsample:  53%|█████▎    | 530/1000 [00:17<00:09, 48.18it/s, 511 steps of size 7.57e-03. acc. prob=0.81]\rsample:  54%|█████▎    | 535/1000 [00:17<00:10, 43.62it/s, 511 steps of size 7.57e-03. acc. prob=0.83]\rsample:  54%|█████▍    | 540/1000 [00:18<00:10, 43.95it/s, 511 steps of size 7.57e-03. acc. prob=0.84]\rsample:  55%|█████▍    | 545/1000 [00:18<00:10, 41.47it/s, 511 steps of size 7.57e-03. acc. prob=0.85]\rsample:  55%|█████▌    | 550/1000 [00:18<00:10, 42.57it/s, 511 steps of size 7.57e-03. acc. prob=0.85]\rsample:  56%|█████▌    | 555/1000 [00:18<00:10, 43.22it/s, 511 steps of size 7.57e-03. acc. prob=0.84]\rsample:  56%|█████▌    | 560/1000 [00:18<00:09, 44.77it/s, 511 steps of size 7.57e-03. acc. prob=0.83]\rsample:  57%|█████▋    | 566/1000 [00:18<00:09, 47.33it/s, 511 steps of size 7.57e-03. acc. prob=0.82]\rsample:  57%|█████▋    | 571/1000 [00:18<00:09, 44.80it/s, 511 steps of size 7.57e-03. acc. prob=0.83]\rsample:  58%|█████▊    | 576/1000 [00:18<00:09, 44.85it/s, 511 steps of size 7.57e-03. acc. prob=0.83]\rsample:  58%|█████▊    | 581/1000 [00:18<00:09, 44.81it/s, 511 steps of size 7.57e-03. acc. prob=0.84]\rsample:  59%|█████▊    | 586/1000 [00:19<00:09, 44.77it/s, 511 steps of size 7.57e-03. acc. prob=0.84]\rsample:  59%|█████▉    | 591/1000 [00:19<00:08, 45.67it/s, 511 steps of size 7.57e-03. acc. prob=0.84]\rsample:  60%|█████▉    | 596/1000 [00:19<00:08, 45.07it/s, 511 steps of size 7.57e-03. acc. prob=0.84]\rsample:  60%|██████    | 601/1000 [00:19<00:08, 45.38it/s, 511 steps of size 7.57e-03. acc. prob=0.84]\rsample:  61%|██████    | 606/1000 [00:19<00:09, 40.84it/s, 511 steps of size 7.57e-03. acc. prob=0.85]\rsample:  61%|██████    | 611/1000 [00:19<00:09, 41.60it/s, 511 steps of size 7.57e-03. acc. prob=0.85]\rsample:  62%|██████▏   | 617/1000 [00:19<00:08, 43.96it/s, 511 steps of size 7.57e-03. acc. prob=0.85]\rsample:  62%|██████▏   | 622/1000 [00:19<00:08, 44.45it/s, 511 steps of size 7.57e-03. acc. prob=0.86]\rsample:  63%|██████▎   | 627/1000 [00:20<00:08, 44.77it/s, 511 steps of size 7.57e-03. acc. prob=0.85]\rsample:  63%|██████▎   | 632/1000 [00:20<00:08, 44.13it/s, 511 steps of size 7.57e-03. acc. prob=0.85]\rsample:  64%|██████▎   | 637/1000 [00:20<00:08, 44.77it/s, 511 steps of size 7.57e-03. acc. prob=0.86]\rsample:  64%|██████▍   | 642/1000 [00:20<00:07, 45.03it/s, 511 steps of size 7.57e-03. acc. prob=0.85]\rsample:  65%|██████▍   | 647/1000 [00:20<00:07, 44.93it/s, 511 steps of size 7.57e-03. acc. prob=0.85]\rsample:  65%|██████▌   | 652/1000 [00:20<00:07, 45.33it/s, 511 steps of size 7.57e-03. acc. prob=0.85]\rsample:  66%|██████▌   | 657/1000 [00:20<00:07, 45.66it/s, 511 steps of size 7.57e-03. acc. prob=0.85]\rsample:  66%|██████▋   | 663/1000 [00:20<00:07, 46.98it/s, 511 steps of size 7.57e-03. acc. prob=0.85]\rsample:  67%|██████▋   | 668/1000 [00:20<00:07, 46.57it/s, 511 steps of size 7.57e-03. acc. prob=0.85]\rsample:  67%|██████▋   | 674/1000 [00:21<00:06, 47.66it/s, 511 steps of size 7.57e-03. acc. prob=0.84]\rsample:  68%|██████▊   | 680/1000 [00:21<00:06, 48.74it/s, 511 steps of size 7.57e-03. acc. prob=0.84]\rsample:  69%|██████▊   | 686/1000 [00:21<00:06, 49.38it/s, 511 steps of size 7.57e-03. acc. prob=0.84]\rsample:  69%|██████▉   | 691/1000 [00:21<00:06, 47.62it/s, 511 steps of size 7.57e-03. acc. prob=0.85]\rsample:  70%|██████▉   | 696/1000 [00:21<00:06, 46.95it/s, 511 steps of size 7.57e-03. acc. prob=0.85]\rsample:  70%|███████   | 701/1000 [00:21<00:06, 46.48it/s, 511 steps of size 7.57e-03. acc. prob=0.85]\rsample:  71%|███████   | 706/1000 [00:21<00:06, 45.93it/s, 511 steps of size 7.57e-03. acc. prob=0.85]\rsample:  71%|███████   | 711/1000 [00:21<00:06, 45.42it/s, 495 steps of size 7.57e-03. acc. prob=0.85]\rsample:  72%|███████▏  | 716/1000 [00:21<00:06, 45.90it/s, 511 steps of size 7.57e-03. acc. prob=0.85]\rsample:  72%|███████▏  | 721/1000 [00:22<00:06, 46.12it/s, 511 steps of size 7.57e-03. acc. prob=0.85]\rsample:  73%|███████▎  | 726/1000 [00:22<00:05, 46.45it/s, 511 steps of size 7.57e-03. acc. prob=0.85]\rsample:  73%|███████▎  | 731/1000 [00:22<00:05, 46.72it/s, 511 steps of size 7.57e-03. acc. prob=0.85]\rsample:  74%|███████▎  | 736/1000 [00:22<00:05, 46.51it/s, 511 steps of size 7.57e-03. acc. prob=0.85]\rsample:  74%|███████▍  | 741/1000 [00:22<00:05, 46.58it/s, 511 steps of size 7.57e-03. acc. prob=0.85]\rsample:  75%|███████▍  | 746/1000 [00:22<00:05, 46.78it/s, 511 steps of size 7.57e-03. acc. prob=0.85]\rsample:  75%|███████▌  | 751/1000 [00:22<00:05, 47.15it/s, 383 steps of size 7.57e-03. acc. prob=0.85]\rsample:  76%|███████▌  | 757/1000 [00:22<00:05, 48.09it/s, 511 steps of size 7.57e-03. acc. prob=0.86]\rsample:  76%|███████▌  | 762/1000 [00:22<00:05, 46.28it/s, 511 steps of size 7.57e-03. acc. prob=0.86]\rsample:  77%|███████▋  | 767/1000 [00:23<00:05, 46.50it/s, 511 steps of size 7.57e-03. acc. prob=0.86]\rsample:  77%|███████▋  | 772/1000 [00:23<00:04, 46.52it/s, 511 steps of size 7.57e-03. acc. prob=0.85]\rsample:  78%|███████▊  | 777/1000 [00:23<00:04, 46.79it/s, 511 steps of size 7.57e-03. acc. prob=0.85]\rsample:  78%|███████▊  | 782/1000 [00:23<00:04, 46.33it/s, 511 steps of size 7.57e-03. acc. prob=0.85]\rsample:  79%|███████▊  | 787/1000 [00:23<00:04, 46.69it/s, 511 steps of size 7.57e-03. acc. prob=0.86]\rsample:  79%|███████▉  | 792/1000 [00:23<00:04, 46.91it/s, 511 steps of size 7.57e-03. acc. prob=0.85]\rsample:  80%|███████▉  | 798/1000 [00:23<00:04, 49.56it/s, 255 steps of size 7.57e-03. acc. prob=0.85]\rsample:  80%|████████  | 803/1000 [00:23<00:04, 48.84it/s, 511 steps of size 7.57e-03. acc. prob=0.85]\rsample:  81%|████████  | 808/1000 [00:23<00:03, 48.20it/s, 511 steps of size 7.57e-03. acc. prob=0.85]\rsample:  81%|████████▏ | 813/1000 [00:23<00:03, 47.84it/s, 511 steps of size 7.57e-03. acc. prob=0.85]\rsample:  82%|████████▏ | 819/1000 [00:24<00:03, 49.87it/s, 511 steps of size 7.57e-03. acc. prob=0.85]\rsample:  82%|████████▎ | 825/1000 [00:24<00:03, 50.19it/s, 511 steps of size 7.57e-03. acc. prob=0.85]\rsample:  83%|████████▎ | 831/1000 [00:24<00:03, 48.84it/s, 511 steps of size 7.57e-03. acc. prob=0.85]\rsample:  84%|████████▎ | 837/1000 [00:24<00:03, 49.75it/s, 454 steps of size 7.57e-03. acc. prob=0.85]\rsample:  84%|████████▍ | 842/1000 [00:24<00:03, 49.15it/s, 511 steps of size 7.57e-03. acc. prob=0.85]\rsample:  85%|████████▍ | 848/1000 [00:24<00:02, 51.04it/s, 511 steps of size 7.57e-03. acc. prob=0.85]\rsample:  85%|████████▌ | 854/1000 [00:24<00:02, 49.45it/s, 511 steps of size 7.57e-03. acc. prob=0.85]\rsample:  86%|████████▌ | 859/1000 [00:24<00:02, 48.65it/s, 511 steps of size 7.57e-03. acc. prob=0.85]\rsample:  86%|████████▋ | 864/1000 [00:25<00:02, 48.14it/s, 511 steps of size 7.57e-03. acc. prob=0.85]\rsample:  87%|████████▋ | 870/1000 [00:25<00:02, 49.03it/s, 511 steps of size 7.57e-03. acc. prob=0.86]\rsample:  88%|████████▊ | 875/1000 [00:25<00:02, 47.97it/s, 511 steps of size 7.57e-03. acc. prob=0.86]\rsample:  88%|████████▊ | 880/1000 [00:25<00:02, 46.45it/s, 511 steps of size 7.57e-03. acc. prob=0.86]\rsample:  88%|████████▊ | 885/1000 [00:25<00:02, 47.03it/s, 511 steps of size 7.57e-03. acc. prob=0.86]\rsample:  89%|████████▉ | 890/1000 [00:25<00:02, 46.76it/s, 511 steps of size 7.57e-03. acc. prob=0.86]\rsample:  90%|████████▉ | 896/1000 [00:25<00:02, 49.31it/s, 255 steps of size 7.57e-03. acc. prob=0.86]\rsample:  90%|█████████ | 901/1000 [00:25<00:02, 49.06it/s, 511 steps of size 7.57e-03. acc. prob=0.86]\rsample:  91%|█████████ | 906/1000 [00:25<00:01, 48.12it/s, 511 steps of size 7.57e-03. acc. prob=0.86]\rsample:  91%|█████████ | 911/1000 [00:26<00:01, 45.24it/s, 511 steps of size 7.57e-03. acc. prob=0.86]\rsample:  92%|█████████▏| 916/1000 [00:26<00:01, 45.75it/s, 511 steps of size 7.57e-03. acc. prob=0.86]\rsample:  92%|█████████▏| 921/1000 [00:26<00:01, 45.78it/s, 511 steps of size 7.57e-03. acc. prob=0.86]\rsample:  93%|█████████▎| 926/1000 [00:26<00:01, 46.16it/s, 511 steps of size 7.57e-03. acc. prob=0.86]\rsample:  93%|█████████▎| 931/1000 [00:26<00:01, 46.08it/s, 511 steps of size 7.57e-03. acc. prob=0.86]\rsample:  94%|█████████▎| 936/1000 [00:26<00:01, 45.15it/s, 511 steps of size 7.57e-03. acc. prob=0.86]\rsample:  94%|█████████▍| 941/1000 [00:26<00:01, 45.74it/s, 511 steps of size 7.57e-03. acc. prob=0.86]\rsample:  95%|█████████▍| 946/1000 [00:26<00:01, 44.47it/s, 511 steps of size 7.57e-03. acc. prob=0.86]\rsample:  95%|█████████▌| 952/1000 [00:26<00:01, 46.37it/s, 511 steps of size 7.57e-03. acc. prob=0.86]\rsample:  96%|█████████▌| 957/1000 [00:27<00:00, 46.53it/s, 511 steps of size 7.57e-03. acc. prob=0.86]\rsample:  96%|█████████▋| 964/1000 [00:27<00:00, 50.20it/s, 511 steps of size 7.57e-03. acc. prob=0.86]\rsample:  97%|█████████▋| 970/1000 [00:27<00:00, 48.63it/s, 511 steps of size 7.57e-03. acc. prob=0.86]\rsample:  98%|█████████▊| 975/1000 [00:27<00:00, 47.11it/s, 511 steps of size 7.57e-03. acc. prob=0.86]\rsample:  98%|█████████▊| 980/1000 [00:27<00:00, 47.25it/s, 255 steps of size 7.57e-03. acc. prob=0.86]\rsample:  98%|█████████▊| 985/1000 [00:27<00:00, 43.69it/s, 511 steps of size 7.57e-03. acc. prob=0.86]\rsample:  99%|█████████▉| 990/1000 [00:27<00:00, 44.74it/s, 511 steps of size 7.57e-03. acc. prob=0.86]\rsample: 100%|█████████▉| 996/1000 [00:27<00:00, 46.56it/s, 511 steps of size 7.57e-03. acc. prob=0.86]\rsample: 100%|██████████| 1000/1000 [00:27<00:00, 35.80it/s, 511 steps of size 7.57e-03. acc. prob=0.86]\n```\n:::\n\n::: {.cell-output .cell-output-stdout}\n```\n⚠️This function is still in development. Use it with caution. ⚠️\n⚠️This function is still in development. Use it with caution. ⚠️\n⚠️This function is still in development. Use it with caution. ⚠️\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\narviz - WARNING - Shape validation failed: input_shape: (1, 500), minimum_shape: (chains=2, draws=4)\n/home/sosa/work/.venv/lib/python3.12/site-packages/arviz/plots/hdiplot.py:166: FutureWarning:\n\nhdi currently interprets 2d data as (draw, shape) but this will change in a future release to (chain, draw) for coherence with other functions\n\n/home/sosa/work/.venv/lib/python3.12/site-packages/arviz/plots/hdiplot.py:166: FutureWarning:\n\nhdi currently interprets 2d data as (draw, shape) but this will change in a future release to (chain, draw) for coherence with other functions\n\n/home/sosa/work/.venv/lib/python3.12/site-packages/arviz/plots/hdiplot.py:166: FutureWarning:\n\nhdi currently interprets 2d data as (draw, shape) but this will change in a future release to (chain, draw) for coherence with other functions\n\n/home/sosa/work/.venv/lib/python3.12/site-packages/arviz/plots/hdiplot.py:166: FutureWarning:\n\nhdi currently interprets 2d data as (draw, shape) but this will change in a future release to (chain, draw) for coherence with other functions\n\n```\n:::\n\n::: {.cell-output .cell-output-display}\n![](Build in models_files/figure-pdf/cell-3-output-7.png){fig-pos='H'}\n:::\n:::\n\n\n# Gaussian Mixture Models\n\n::: {.cell execution_count=3}\n``` {.python .cell-code}\nfrom BI import bi\nfrom sklearn.datasets import make_blobs\nm = bi()\n\n# Generate synthetic data\ndata, true_labels = make_blobs(\n    n_samples=500, centers=8, cluster_std=0.8,\n    center_box=(-10,10), random_state=101\n)\n\nm.data_on_model = {\"data\": data,\"K\": 8 }\nm.fit(m.models.gmm) # Optimize model parameters through MCMC sampling\nm.plot(X=data,sampler=m.sampler)  # ⚠️ Experimental feature\n```\n\n::: {.cell-output .cell-output-stdout}\n```\njax.local_device_count 16\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\n\r  0%|          | 0/1000 [00:00<?, ?it/s]\rwarmup:   0%|          | 1/1000 [00:02<43:32,  2.61s/it, 1 steps of size 2.34e+00. acc. prob=0.00]\rwarmup:   3%|▎         | 27/1000 [00:02<01:10, 13.81it/s, 31 steps of size 2.67e-02. acc. prob=0.72]\rwarmup:   4%|▍         | 42/1000 [00:02<00:41, 22.90it/s, 63 steps of size 4.18e-02. acc. prob=0.75]\rwarmup:   7%|▋         | 68/1000 [00:02<00:21, 43.74it/s, 7 steps of size 3.22e-02. acc. prob=0.76] \rwarmup:  10%|▉         | 96/1000 [00:03<00:12, 69.86it/s, 15 steps of size 3.26e-02. acc. prob=0.77]\rwarmup:  12%|█▏        | 118/1000 [00:03<00:09, 88.49it/s, 7 steps of size 5.52e-01. acc. prob=0.77]\rwarmup:  14%|█▍        | 143/1000 [00:03<00:07, 114.29it/s, 7 steps of size 6.94e-01. acc. prob=0.78]\rwarmup:  17%|█▋        | 170/1000 [00:03<00:05, 142.94it/s, 7 steps of size 3.39e-01. acc. prob=0.78]\rwarmup:  20%|██        | 200/1000 [00:03<00:04, 175.50it/s, 7 steps of size 1.41e-01. acc. prob=0.78]\rwarmup:  23%|██▎       | 226/1000 [00:03<00:04, 191.75it/s, 31 steps of size 2.68e-01. acc. prob=0.78]\rwarmup:  26%|██▌       | 255/1000 [00:03<00:03, 215.69it/s, 31 steps of size 1.81e-01. acc. prob=0.78]\rwarmup:  28%|██▊       | 282/1000 [00:03<00:03, 210.43it/s, 15 steps of size 4.06e-01. acc. prob=0.78]\rwarmup:  31%|███       | 307/1000 [00:03<00:03, 216.03it/s, 7 steps of size 3.29e-01. acc. prob=0.78] \rwarmup:  33%|███▎      | 331/1000 [00:04<00:03, 221.64it/s, 7 steps of size 6.35e-01. acc. prob=0.78]\rwarmup:  36%|███▌      | 359/1000 [00:04<00:02, 235.21it/s, 15 steps of size 4.50e-01. acc. prob=0.78]\rwarmup:  39%|███▉      | 388/1000 [00:04<00:02, 250.24it/s, 7 steps of size 5.61e-01. acc. prob=0.79] \rwarmup:  42%|████▏     | 418/1000 [00:04<00:02, 263.79it/s, 7 steps of size 4.84e-01. acc. prob=0.79]\rwarmup:  45%|████▍     | 446/1000 [00:04<00:02, 265.98it/s, 7 steps of size 5.37e-01. acc. prob=0.79]\rwarmup:  47%|████▋     | 474/1000 [00:04<00:02, 262.76it/s, 7 steps of size 1.20e+00. acc. prob=0.79]\rsample:  50%|█████     | 501/1000 [00:04<00:01, 251.30it/s, 15 steps of size 4.07e-01. acc. prob=0.97]\rsample:  53%|█████▎    | 527/1000 [00:04<00:02, 226.37it/s, 7 steps of size 4.07e-01. acc. prob=0.88] \rsample:  55%|█████▌    | 551/1000 [00:04<00:02, 208.59it/s, 7 steps of size 4.07e-01. acc. prob=0.89]\rsample:  57%|█████▋    | 573/1000 [00:05<00:02, 206.61it/s, 15 steps of size 4.07e-01. acc. prob=0.90]\rsample:  60%|█████▉    | 595/1000 [00:05<00:01, 204.31it/s, 15 steps of size 4.07e-01. acc. prob=0.89]\rsample:  62%|██████▏   | 616/1000 [00:05<00:02, 190.33it/s, 23 steps of size 4.07e-01. acc. prob=0.90]\rsample:  64%|██████▎   | 636/1000 [00:05<00:01, 188.98it/s, 15 steps of size 4.07e-01. acc. prob=0.90]\rsample:  66%|██████▌   | 656/1000 [00:05<00:01, 189.19it/s, 15 steps of size 4.07e-01. acc. prob=0.90]\rsample:  68%|██████▊   | 676/1000 [00:05<00:01, 186.18it/s, 15 steps of size 4.07e-01. acc. prob=0.90]\rsample:  70%|██████▉   | 695/1000 [00:05<00:01, 186.94it/s, 31 steps of size 4.07e-01. acc. prob=0.90]\rsample:  72%|███████▏  | 716/1000 [00:05<00:01, 191.68it/s, 15 steps of size 4.07e-01. acc. prob=0.90]\rsample:  74%|███████▎  | 736/1000 [00:05<00:01, 174.71it/s, 7 steps of size 4.07e-01. acc. prob=0.90] \rsample:  75%|███████▌  | 754/1000 [00:06<00:01, 175.62it/s, 15 steps of size 4.07e-01. acc. prob=0.90]\rsample:  77%|███████▋  | 773/1000 [00:06<00:01, 177.18it/s, 15 steps of size 4.07e-01. acc. prob=0.90]\rsample:  79%|███████▉  | 791/1000 [00:06<00:01, 175.13it/s, 15 steps of size 4.07e-01. acc. prob=0.90]\rsample:  81%|████████▏ | 813/1000 [00:06<00:01, 186.39it/s, 15 steps of size 4.07e-01. acc. prob=0.89]\rsample:  84%|████████▎ | 836/1000 [00:06<00:00, 196.84it/s, 15 steps of size 4.07e-01. acc. prob=0.89]\rsample:  86%|████████▌ | 859/1000 [00:06<00:00, 204.98it/s, 15 steps of size 4.07e-01. acc. prob=0.89]\rsample:  88%|████████▊ | 881/1000 [00:06<00:00, 207.91it/s, 7 steps of size 4.07e-01. acc. prob=0.90] \rsample:  90%|█████████ | 902/1000 [00:06<00:00, 207.72it/s, 15 steps of size 4.07e-01. acc. prob=0.90]\rsample:  93%|█████████▎| 930/1000 [00:06<00:00, 226.23it/s, 15 steps of size 4.07e-01. acc. prob=0.90]\rsample:  95%|█████████▌| 953/1000 [00:06<00:00, 226.75it/s, 15 steps of size 4.07e-01. acc. prob=0.90]\rsample:  98%|█████████▊| 978/1000 [00:07<00:00, 232.01it/s, 15 steps of size 4.07e-01. acc. prob=0.90]\rsample: 100%|██████████| 1000/1000 [00:07<00:00, 139.24it/s, 15 steps of size 4.07e-01. acc. prob=0.90]\n```\n:::\n:::\n\n\n# Dirichlet Process Mixture Models\n\n\n## Python\n\n::: {.cell execution_count=4}\n``` {.python .cell-code}\nfrom BI import bi\nfrom sklearn.datasets import make_blobs\nm = bi()\n\n# Generate synthetic data\ndata, true_labels = make_blobs(\n    n_samples=500, centers=8, cluster_std=0.8,\n    center_box=(-10,10), random_state=101\n)\nm.data_on_model = dict(data=data,T=10)\nm.fit(m.models.dpmm)\nm.plot(data,m.sampler) # ⚠️ Experimental feature\n```\n\n::: {.cell-output .cell-output-stdout}\n```\njax.local_device_count 16\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\n\r  0%|          | 0/1000 [00:00<?, ?it/s]\rwarmup:   0%|          | 1/1000 [00:02<46:26,  2.79s/it, 1 steps of size 2.34e+00. acc. prob=0.00]\rwarmup:   2%|▏         | 15/1000 [00:02<02:23,  6.87it/s, 511 steps of size 9.88e-03. acc. prob=0.65]\rwarmup:   2%|▏         | 20/1000 [00:03<01:56,  8.43it/s, 511 steps of size 1.06e-02. acc. prob=0.69]\rwarmup:   2%|▏         | 24/1000 [00:03<01:39,  9.85it/s, 127 steps of size 3.20e-02. acc. prob=0.72]\rwarmup:   3%|▎         | 28/1000 [00:03<01:19, 12.24it/s, 127 steps of size 2.94e-02. acc. prob=0.73]\rwarmup:   3%|▎         | 32/1000 [00:03<01:05, 14.75it/s, 127 steps of size 2.57e-02. acc. prob=0.73]\rwarmup:   4%|▎         | 37/1000 [00:03<00:55, 17.21it/s, 511 steps of size 2.80e-02. acc. prob=0.74]\rwarmup:   4%|▍         | 40/1000 [00:04<00:58, 16.46it/s, 31 steps of size 3.96e-02. acc. prob=0.75] \rwarmup:   4%|▍         | 45/1000 [00:04<00:44, 21.47it/s, 159 steps of size 8.74e-02. acc. prob=0.76]\rwarmup:   5%|▍         | 49/1000 [00:04<00:48, 19.73it/s, 127 steps of size 5.86e-02. acc. prob=0.76]\rwarmup:   6%|▌         | 55/1000 [00:04<00:37, 24.95it/s, 255 steps of size 3.37e-02. acc. prob=0.75]\rwarmup:   6%|▌         | 60/1000 [00:04<00:31, 29.41it/s, 63 steps of size 3.53e-02. acc. prob=0.76] \rwarmup:   7%|▋         | 67/1000 [00:04<00:25, 36.52it/s, 127 steps of size 5.84e-02. acc. prob=0.76]\rwarmup:   7%|▋         | 73/1000 [00:04<00:22, 41.48it/s, 7 steps of size 1.05e-01. acc. prob=0.77]  \rwarmup:   8%|▊         | 78/1000 [00:05<00:22, 40.97it/s, 63 steps of size 3.30e-02. acc. prob=0.76]\rwarmup:   8%|▊         | 83/1000 [00:05<00:21, 41.97it/s, 63 steps of size 4.88e-02. acc. prob=0.77]\rwarmup:   9%|▉         | 91/1000 [00:05<00:17, 51.07it/s, 15 steps of size 8.34e-02. acc. prob=0.77]\rwarmup:  10%|▉         | 98/1000 [00:05<00:16, 53.91it/s, 127 steps of size 7.94e-02. acc. prob=0.77]\rwarmup:  10%|█         | 104/1000 [00:05<00:17, 51.58it/s, 255 steps of size 2.52e-02. acc. prob=0.76]\rwarmup:  11%|█         | 110/1000 [00:05<00:20, 43.65it/s, 255 steps of size 7.47e-02. acc. prob=0.77]\rwarmup:  12%|█▏        | 115/1000 [00:05<00:24, 36.49it/s, 127 steps of size 7.26e-02. acc. prob=0.77]\rwarmup:  12%|█▏        | 120/1000 [00:06<00:24, 36.06it/s, 63 steps of size 7.45e-02. acc. prob=0.77] \rwarmup:  12%|█▏        | 124/1000 [00:06<00:24, 36.49it/s, 255 steps of size 3.41e-02. acc. prob=0.77]\rwarmup:  13%|█▎        | 128/1000 [00:06<00:25, 34.55it/s, 31 steps of size 2.62e-02. acc. prob=0.77] \rwarmup:  13%|█▎        | 132/1000 [00:06<00:25, 33.47it/s, 63 steps of size 1.02e-01. acc. prob=0.77]\rwarmup:  14%|█▎        | 137/1000 [00:06<00:24, 35.60it/s, 255 steps of size 3.71e-02. acc. prob=0.77]\rwarmup:  14%|█▍        | 142/1000 [00:06<00:24, 34.62it/s, 255 steps of size 4.23e-02. acc. prob=0.77]\rwarmup:  15%|█▍        | 147/1000 [00:06<00:22, 38.13it/s, 63 steps of size 8.59e-02. acc. prob=0.78] \rwarmup:  15%|█▌        | 154/1000 [00:06<00:18, 44.74it/s, 127 steps of size 5.55e-02. acc. prob=0.77]\rwarmup:  16%|█▌        | 161/1000 [00:07<00:16, 49.71it/s, 63 steps of size 1.56e-01. acc. prob=0.77] \rwarmup:  17%|█▋        | 168/1000 [00:07<00:15, 54.50it/s, 31 steps of size 2.59e-02. acc. prob=0.77]\rwarmup:  17%|█▋        | 174/1000 [00:07<00:20, 40.65it/s, 127 steps of size 7.51e-02. acc. prob=0.77]\rwarmup:  18%|█▊        | 180/1000 [00:07<00:18, 44.83it/s, 63 steps of size 1.57e-01. acc. prob=0.78] \rwarmup:  19%|█▉        | 188/1000 [00:07<00:15, 51.93it/s, 63 steps of size 1.08e-01. acc. prob=0.78]\rwarmup:  20%|█▉        | 198/1000 [00:07<00:12, 63.00it/s, 31 steps of size 1.99e-01. acc. prob=0.78]\rwarmup:  21%|██        | 209/1000 [00:07<00:10, 75.20it/s, 15 steps of size 1.03e-01. acc. prob=0.78]\rwarmup:  22%|██▏       | 218/1000 [00:07<00:10, 77.28it/s, 31 steps of size 2.50e-01. acc. prob=0.78]\rwarmup:  23%|██▎       | 229/1000 [00:08<00:09, 84.48it/s, 63 steps of size 8.33e-02. acc. prob=0.78]\rwarmup:  24%|██▍       | 238/1000 [00:08<00:09, 83.14it/s, 31 steps of size 1.42e-01. acc. prob=0.78]\rwarmup:  25%|██▍       | 247/1000 [00:08<00:08, 83.97it/s, 31 steps of size 1.92e-01. acc. prob=0.78]\rwarmup:  26%|██▌       | 257/1000 [00:08<00:09, 80.85it/s, 127 steps of size 3.09e-02. acc. prob=0.78]\rwarmup:  27%|██▋       | 266/1000 [00:08<00:15, 47.98it/s, 31 steps of size 1.58e-02. acc. prob=0.78] \rwarmup:  27%|██▋       | 273/1000 [00:08<00:16, 43.67it/s, 31 steps of size 8.12e-02. acc. prob=0.78]\rwarmup:  28%|██▊       | 280/1000 [00:09<00:15, 47.63it/s, 127 steps of size 4.96e-02. acc. prob=0.78]\rwarmup:  29%|██▊       | 286/1000 [00:09<00:14, 48.71it/s, 63 steps of size 3.49e-02. acc. prob=0.78] \rwarmup:  29%|██▉       | 292/1000 [00:09<00:17, 40.55it/s, 63 steps of size 1.03e-01. acc. prob=0.78]\rwarmup:  30%|███       | 301/1000 [00:09<00:14, 49.47it/s, 31 steps of size 9.80e-02. acc. prob=0.78]\rwarmup:  31%|███       | 307/1000 [00:09<00:16, 42.17it/s, 127 steps of size 7.81e-03. acc. prob=0.78]\rwarmup:  31%|███       | 312/1000 [00:10<00:24, 28.24it/s, 127 steps of size 5.03e-02. acc. prob=0.78]\rwarmup:  32%|███▏      | 321/1000 [00:10<00:17, 37.84it/s, 63 steps of size 9.57e-02. acc. prob=0.78] \rwarmup:  33%|███▎      | 328/1000 [00:10<00:15, 43.32it/s, 63 steps of size 1.32e-01. acc. prob=0.78]\rwarmup:  34%|███▎      | 335/1000 [00:10<00:13, 47.87it/s, 63 steps of size 6.82e-02. acc. prob=0.78]\rwarmup:  34%|███▍      | 341/1000 [00:10<00:13, 48.68it/s, 63 steps of size 2.19e-02. acc. prob=0.78]\rwarmup:  35%|███▍      | 347/1000 [00:10<00:14, 43.61it/s, 31 steps of size 1.53e-01. acc. prob=0.78]\rwarmup:  35%|███▌      | 353/1000 [00:10<00:14, 44.28it/s, 63 steps of size 7.71e-02. acc. prob=0.78]\rwarmup:  36%|███▌      | 358/1000 [00:10<00:14, 45.16it/s, 95 steps of size 1.07e-01. acc. prob=0.78]\rwarmup:  36%|███▋      | 365/1000 [00:11<00:12, 51.02it/s, 63 steps of size 7.18e-02. acc. prob=0.78]\rwarmup:  37%|███▋      | 371/1000 [00:11<00:12, 51.30it/s, 63 steps of size 7.15e-02. acc. prob=0.78]\rwarmup:  38%|███▊      | 377/1000 [00:11<00:12, 50.44it/s, 127 steps of size 5.55e-02. acc. prob=0.78]\rwarmup:  38%|███▊      | 383/1000 [00:11<00:11, 52.51it/s, 63 steps of size 9.71e-02. acc. prob=0.78] \rwarmup:  39%|███▉      | 389/1000 [00:11<00:11, 51.82it/s, 127 steps of size 5.07e-02. acc. prob=0.78]\rwarmup:  40%|███▉      | 395/1000 [00:11<00:11, 50.72it/s, 63 steps of size 6.12e-02. acc. prob=0.78] \rwarmup:  40%|████      | 401/1000 [00:11<00:13, 46.08it/s, 63 steps of size 7.02e-02. acc. prob=0.78]\rwarmup:  41%|████      | 406/1000 [00:11<00:12, 45.84it/s, 127 steps of size 1.64e-02. acc. prob=0.78]\rwarmup:  41%|████      | 411/1000 [00:12<00:17, 33.15it/s, 127 steps of size 5.93e-02. acc. prob=0.78]\rwarmup:  42%|████▏     | 415/1000 [00:12<00:17, 34.29it/s, 63 steps of size 1.13e-01. acc. prob=0.78] \rwarmup:  42%|████▏     | 420/1000 [00:12<00:15, 37.46it/s, 63 steps of size 1.17e-01. acc. prob=0.79]\rwarmup:  43%|████▎     | 428/1000 [00:12<00:12, 47.41it/s, 31 steps of size 8.80e-02. acc. prob=0.78]\rwarmup:  43%|████▎     | 434/1000 [00:12<00:12, 46.16it/s, 63 steps of size 7.26e-02. acc. prob=0.78]\rwarmup:  44%|████▍     | 439/1000 [00:12<00:12, 44.22it/s, 63 steps of size 7.45e-02. acc. prob=0.78]\rwarmup:  44%|████▍     | 444/1000 [00:12<00:12, 44.71it/s, 63 steps of size 8.61e-02. acc. prob=0.79]\rwarmup:  45%|████▍     | 449/1000 [00:13<00:14, 38.79it/s, 127 steps of size 2.98e-02. acc. prob=0.78]\rwarmup:  45%|████▌     | 454/1000 [00:13<00:26, 20.67it/s, 255 steps of size 1.38e-02. acc. prob=0.78]\rwarmup:  46%|████▌     | 458/1000 [00:13<00:34, 15.61it/s, 63 steps of size 5.24e-02. acc. prob=0.78] \rwarmup:  46%|████▌     | 461/1000 [00:14<00:32, 16.38it/s, 31 steps of size 7.84e-02. acc. prob=0.78]\rwarmup:  46%|████▋     | 464/1000 [00:14<00:29, 17.98it/s, 31 steps of size 1.38e-02. acc. prob=0.78]\rwarmup:  47%|████▋     | 467/1000 [00:14<00:36, 14.72it/s, 127 steps of size 6.31e-02. acc. prob=0.78]\rwarmup:  47%|████▋     | 470/1000 [00:14<00:31, 16.69it/s, 31 steps of size 1.57e-02. acc. prob=0.78] \rwarmup:  47%|████▋     | 473/1000 [00:14<00:36, 14.45it/s, 63 steps of size 9.14e-02. acc. prob=0.78]\rwarmup:  48%|████▊     | 476/1000 [00:15<00:33, 15.60it/s, 255 steps of size 2.98e-02. acc. prob=0.78]\rwarmup:  48%|████▊     | 479/1000 [00:15<00:39, 13.06it/s, 511 steps of size 1.07e-02. acc. prob=0.78]\rwarmup:  48%|████▊     | 481/1000 [00:16<01:04,  8.04it/s, 255 steps of size 2.60e-02. acc. prob=0.78]\rwarmup:  48%|████▊     | 483/1000 [00:16<00:58,  8.78it/s, 63 steps of size 5.51e-02. acc. prob=0.78] \rwarmup:  49%|████▊     | 487/1000 [00:16<00:42, 11.96it/s, 127 steps of size 5.63e-02. acc. prob=0.78]\rwarmup:  49%|████▉     | 490/1000 [00:16<00:35, 14.54it/s, 63 steps of size 7.50e-02. acc. prob=0.78] \rwarmup:  49%|████▉     | 494/1000 [00:16<00:28, 17.48it/s, 127 steps of size 4.81e-02. acc. prob=0.78]\rwarmup:  50%|████▉     | 497/1000 [00:16<00:32, 15.69it/s, 255 steps of size 2.77e-02. acc. prob=0.78]\rwarmup:  50%|████▉     | 499/1000 [00:16<00:30, 16.32it/s, 127 steps of size 6.89e-02. acc. prob=0.78]\rsample:  50%|█████     | 502/1000 [00:17<00:26, 18.73it/s, 127 steps of size 4.79e-02. acc. prob=0.98]\rsample:  51%|█████     | 506/1000 [00:17<00:22, 22.21it/s, 63 steps of size 4.79e-02. acc. prob=0.95] \rsample:  51%|█████     | 509/1000 [00:17<00:22, 21.89it/s, 127 steps of size 4.79e-02. acc. prob=0.96]\rsample:  51%|█████▏    | 513/1000 [00:17<00:19, 25.17it/s, 63 steps of size 4.79e-02. acc. prob=0.95] \rsample:  52%|█████▏    | 517/1000 [00:17<00:18, 26.76it/s, 63 steps of size 4.79e-02. acc. prob=0.96]\rsample:  52%|█████▏    | 520/1000 [00:17<00:18, 26.33it/s, 63 steps of size 4.79e-02. acc. prob=0.96]\rsample:  52%|█████▏    | 523/1000 [00:17<00:18, 26.20it/s, 63 steps of size 4.79e-02. acc. prob=0.96]\rsample:  53%|█████▎    | 527/1000 [00:17<00:16, 28.01it/s, 63 steps of size 4.79e-02. acc. prob=0.96]\rsample:  53%|█████▎    | 531/1000 [00:18<00:15, 29.34it/s, 63 steps of size 4.79e-02. acc. prob=0.96]\rsample:  53%|█████▎    | 534/1000 [00:18<00:16, 27.78it/s, 127 steps of size 4.79e-02. acc. prob=0.96]\rsample:  54%|█████▎    | 537/1000 [00:18<00:18, 24.68it/s, 127 steps of size 4.79e-02. acc. prob=0.95]\rsample:  54%|█████▍    | 540/1000 [00:18<00:17, 25.57it/s, 63 steps of size 4.79e-02. acc. prob=0.96] \rsample:  54%|█████▍    | 544/1000 [00:18<00:16, 28.43it/s, 63 steps of size 4.79e-02. acc. prob=0.96]\rsample:  55%|█████▍    | 547/1000 [00:18<00:15, 28.64it/s, 127 steps of size 4.79e-02. acc. prob=0.96]\rsample:  55%|█████▌    | 551/1000 [00:18<00:15, 29.84it/s, 63 steps of size 4.79e-02. acc. prob=0.96] \rsample:  56%|█████▌    | 555/1000 [00:18<00:14, 30.50it/s, 63 steps of size 4.79e-02. acc. prob=0.96]\rsample:  56%|█████▌    | 560/1000 [00:19<00:12, 35.24it/s, 63 steps of size 4.79e-02. acc. prob=0.95]\rsample:  57%|█████▋    | 566/1000 [00:19<00:11, 38.43it/s, 127 steps of size 4.79e-02. acc. prob=0.96]\rsample:  57%|█████▋    | 571/1000 [00:19<00:10, 39.43it/s, 63 steps of size 4.79e-02. acc. prob=0.95] \rsample:  58%|█████▊    | 576/1000 [00:19<00:10, 40.62it/s, 63 steps of size 4.79e-02. acc. prob=0.95]\rsample:  58%|█████▊    | 581/1000 [00:19<00:10, 39.39it/s, 127 steps of size 4.79e-02. acc. prob=0.95]\rsample:  59%|█████▊    | 586/1000 [00:19<00:09, 41.44it/s, 63 steps of size 4.79e-02. acc. prob=0.95] \rsample:  59%|█████▉    | 592/1000 [00:19<00:09, 44.16it/s, 63 steps of size 4.79e-02. acc. prob=0.95]\rsample:  60%|█████▉    | 598/1000 [00:19<00:08, 46.09it/s, 63 steps of size 4.79e-02. acc. prob=0.95]\rsample:  60%|██████    | 603/1000 [00:19<00:09, 43.19it/s, 127 steps of size 4.79e-02. acc. prob=0.95]\rsample:  61%|██████    | 608/1000 [00:20<00:08, 44.41it/s, 63 steps of size 4.79e-02. acc. prob=0.95] \rsample:  61%|██████▏   | 613/1000 [00:20<00:09, 41.97it/s, 63 steps of size 4.79e-02. acc. prob=0.95]\rsample:  62%|██████▏   | 619/1000 [00:20<00:08, 44.96it/s, 63 steps of size 4.79e-02. acc. prob=0.95]\rsample:  62%|██████▏   | 624/1000 [00:20<00:08, 46.23it/s, 63 steps of size 4.79e-02. acc. prob=0.95]\rsample:  63%|██████▎   | 630/1000 [00:20<00:07, 47.77it/s, 63 steps of size 4.79e-02. acc. prob=0.96]\rsample:  64%|██████▎   | 635/1000 [00:20<00:07, 47.58it/s, 63 steps of size 4.79e-02. acc. prob=0.96]\rsample:  64%|██████▍   | 640/1000 [00:20<00:08, 42.75it/s, 63 steps of size 4.79e-02. acc. prob=0.96]\rsample:  64%|██████▍   | 645/1000 [00:20<00:09, 39.20it/s, 63 steps of size 4.79e-02. acc. prob=0.95]\rsample:  65%|██████▌   | 650/1000 [00:21<00:09, 37.48it/s, 127 steps of size 4.79e-02. acc. prob=0.96]\rsample:  65%|██████▌   | 654/1000 [00:21<00:09, 37.91it/s, 63 steps of size 4.79e-02. acc. prob=0.96] \rsample:  66%|██████▌   | 658/1000 [00:21<00:09, 35.32it/s, 127 steps of size 4.79e-02. acc. prob=0.96]\rsample:  66%|██████▋   | 663/1000 [00:21<00:08, 37.51it/s, 63 steps of size 4.79e-02. acc. prob=0.96] \rsample:  67%|██████▋   | 668/1000 [00:21<00:08, 40.48it/s, 63 steps of size 4.79e-02. acc. prob=0.96]\rsample:  67%|██████▋   | 673/1000 [00:21<00:08, 38.71it/s, 63 steps of size 4.79e-02. acc. prob=0.96]\rsample:  68%|██████▊   | 678/1000 [00:21<00:08, 38.80it/s, 127 steps of size 4.79e-02. acc. prob=0.95]\rsample:  68%|██████▊   | 683/1000 [00:21<00:07, 40.63it/s, 63 steps of size 4.79e-02. acc. prob=0.95] \rsample:  69%|██████▉   | 688/1000 [00:22<00:07, 43.03it/s, 63 steps of size 4.79e-02. acc. prob=0.95]\rsample:  69%|██████▉   | 693/1000 [00:22<00:07, 42.43it/s, 127 steps of size 4.79e-02. acc. prob=0.95]\rsample:  70%|██████▉   | 699/1000 [00:22<00:06, 45.33it/s, 63 steps of size 4.79e-02. acc. prob=0.95] \rsample:  70%|███████   | 704/1000 [00:22<00:06, 45.32it/s, 63 steps of size 4.79e-02. acc. prob=0.95]\rsample:  71%|███████   | 710/1000 [00:22<00:06, 46.94it/s, 63 steps of size 4.79e-02. acc. prob=0.95]\rsample:  72%|███████▏  | 715/1000 [00:22<00:06, 42.09it/s, 63 steps of size 4.79e-02. acc. prob=0.95]\rsample:  72%|███████▏  | 720/1000 [00:22<00:06, 42.50it/s, 63 steps of size 4.79e-02. acc. prob=0.95]\rsample:  72%|███████▎  | 725/1000 [00:22<00:06, 43.34it/s, 63 steps of size 4.79e-02. acc. prob=0.95]\rsample:  73%|███████▎  | 730/1000 [00:22<00:06, 44.46it/s, 63 steps of size 4.79e-02. acc. prob=0.95]\rsample:  74%|███████▎  | 735/1000 [00:23<00:06, 43.75it/s, 63 steps of size 4.79e-02. acc. prob=0.95]\rsample:  74%|███████▍  | 740/1000 [00:23<00:06, 42.24it/s, 63 steps of size 4.79e-02. acc. prob=0.95]\rsample:  74%|███████▍  | 745/1000 [00:23<00:06, 41.63it/s, 63 steps of size 4.79e-02. acc. prob=0.95]\rsample:  75%|███████▌  | 750/1000 [00:23<00:06, 40.82it/s, 127 steps of size 4.79e-02. acc. prob=0.95]\rsample:  76%|███████▌  | 755/1000 [00:23<00:05, 42.57it/s, 63 steps of size 4.79e-02. acc. prob=0.95] \rsample:  76%|███████▌  | 760/1000 [00:23<00:06, 39.89it/s, 127 steps of size 4.79e-02. acc. prob=0.95]\rsample:  76%|███████▋  | 765/1000 [00:23<00:05, 41.72it/s, 63 steps of size 4.79e-02. acc. prob=0.95] \rsample:  77%|███████▋  | 770/1000 [00:23<00:05, 43.12it/s, 63 steps of size 4.79e-02. acc. prob=0.95]\rsample:  78%|███████▊  | 775/1000 [00:24<00:05, 43.87it/s, 63 steps of size 4.79e-02. acc. prob=0.95]\rsample:  78%|███████▊  | 780/1000 [00:24<00:04, 45.32it/s, 63 steps of size 4.79e-02. acc. prob=0.95]\rsample:  78%|███████▊  | 785/1000 [00:24<00:05, 40.80it/s, 63 steps of size 4.79e-02. acc. prob=0.95]\rsample:  79%|███████▉  | 790/1000 [00:24<00:05, 36.40it/s, 63 steps of size 4.79e-02. acc. prob=0.94]\rsample:  80%|███████▉  | 795/1000 [00:24<00:05, 39.45it/s, 63 steps of size 4.79e-02. acc. prob=0.94]\rsample:  80%|████████  | 800/1000 [00:24<00:05, 38.38it/s, 63 steps of size 4.79e-02. acc. prob=0.94]\rsample:  80%|████████  | 805/1000 [00:24<00:04, 39.64it/s, 63 steps of size 4.79e-02. acc. prob=0.94]\rsample:  81%|████████  | 810/1000 [00:24<00:04, 39.07it/s, 63 steps of size 4.79e-02. acc. prob=0.94]\rsample:  81%|████████▏ | 814/1000 [00:26<00:25,  7.17it/s, 127 steps of size 4.79e-02. acc. prob=0.94]\rsample:  82%|████████▏ | 818/1000 [00:26<00:20,  9.01it/s, 191 steps of size 4.79e-02. acc. prob=0.95]\rsample:  82%|████████▏ | 823/1000 [00:27<00:14, 12.12it/s, 127 steps of size 4.79e-02. acc. prob=0.95]\rsample:  83%|████████▎ | 827/1000 [00:27<00:11, 14.70it/s, 127 steps of size 4.79e-02. acc. prob=0.95]\rsample:  83%|████████▎ | 831/1000 [00:27<00:09, 17.54it/s, 63 steps of size 4.79e-02. acc. prob=0.95] \rsample:  84%|████████▎ | 836/1000 [00:27<00:07, 22.34it/s, 63 steps of size 4.79e-02. acc. prob=0.95]\rsample:  84%|████████▍ | 841/1000 [00:27<00:06, 26.28it/s, 63 steps of size 4.79e-02. acc. prob=0.95]\rsample:  85%|████████▍ | 846/1000 [00:27<00:05, 29.98it/s, 63 steps of size 4.79e-02. acc. prob=0.94]\rsample:  85%|████████▌ | 851/1000 [00:27<00:05, 29.72it/s, 127 steps of size 4.79e-02. acc. prob=0.94]\rsample:  86%|████████▌ | 855/1000 [00:27<00:04, 31.63it/s, 127 steps of size 4.79e-02. acc. prob=0.95]\rsample:  86%|████████▌ | 860/1000 [00:28<00:03, 35.78it/s, 63 steps of size 4.79e-02. acc. prob=0.94] \rsample:  87%|████████▋ | 866/1000 [00:28<00:03, 40.22it/s, 63 steps of size 4.79e-02. acc. prob=0.95]\rsample:  87%|████████▋ | 872/1000 [00:28<00:02, 43.27it/s, 63 steps of size 4.79e-02. acc. prob=0.95]\rsample:  88%|████████▊ | 877/1000 [00:28<00:02, 44.92it/s, 63 steps of size 4.79e-02. acc. prob=0.94]\rsample:  88%|████████▊ | 882/1000 [00:28<00:02, 44.43it/s, 63 steps of size 4.79e-02. acc. prob=0.94]\rsample:  89%|████████▊ | 887/1000 [00:28<00:02, 39.38it/s, 191 steps of size 4.79e-02. acc. prob=0.94]\rsample:  89%|████████▉ | 892/1000 [00:28<00:02, 39.46it/s, 63 steps of size 4.79e-02. acc. prob=0.94] \rsample:  90%|████████▉ | 898/1000 [00:28<00:02, 42.40it/s, 63 steps of size 4.79e-02. acc. prob=0.94]\rsample:  90%|█████████ | 904/1000 [00:29<00:02, 45.19it/s, 63 steps of size 4.79e-02. acc. prob=0.94]\rsample:  91%|█████████ | 909/1000 [00:29<00:02, 44.70it/s, 127 steps of size 4.79e-02. acc. prob=0.94]\rsample:  91%|█████████▏| 914/1000 [00:29<00:02, 42.04it/s, 127 steps of size 4.79e-02. acc. prob=0.95]\rsample:  92%|█████████▏| 919/1000 [00:29<00:01, 42.31it/s, 63 steps of size 4.79e-02. acc. prob=0.95] \rsample:  92%|█████████▏| 924/1000 [00:29<00:01, 42.45it/s, 63 steps of size 4.79e-02. acc. prob=0.94]\rsample:  93%|█████████▎| 929/1000 [00:29<00:01, 42.86it/s, 63 steps of size 4.79e-02. acc. prob=0.94]\rsample:  93%|█████████▎| 934/1000 [00:29<00:01, 42.43it/s, 63 steps of size 4.79e-02. acc. prob=0.95]\rsample:  94%|█████████▍| 939/1000 [00:29<00:01, 42.67it/s, 63 steps of size 4.79e-02. acc. prob=0.94]\rsample:  94%|█████████▍| 945/1000 [00:29<00:01, 45.03it/s, 63 steps of size 4.79e-02. acc. prob=0.94]\rsample:  95%|█████████▌| 950/1000 [00:30<00:01, 44.07it/s, 63 steps of size 4.79e-02. acc. prob=0.94]\rsample:  96%|█████████▌| 955/1000 [00:30<00:01, 44.30it/s, 63 steps of size 4.79e-02. acc. prob=0.94]\rsample:  96%|█████████▌| 960/1000 [00:30<00:00, 40.39it/s, 63 steps of size 4.79e-02. acc. prob=0.95]\rsample:  97%|█████████▋| 966/1000 [00:30<00:00, 43.63it/s, 63 steps of size 4.79e-02. acc. prob=0.95]\rsample:  97%|█████████▋| 971/1000 [00:30<00:00, 43.35it/s, 63 steps of size 4.79e-02. acc. prob=0.94]\rsample:  98%|█████████▊| 977/1000 [00:30<00:00, 45.49it/s, 63 steps of size 4.79e-02. acc. prob=0.94]\rsample:  98%|█████████▊| 983/1000 [00:30<00:00, 46.95it/s, 63 steps of size 4.79e-02. acc. prob=0.94]\rsample:  99%|█████████▉| 988/1000 [00:30<00:00, 46.26it/s, 63 steps of size 4.79e-02. acc. prob=0.94]\rsample:  99%|█████████▉| 993/1000 [00:31<00:00, 45.55it/s, 63 steps of size 4.79e-02. acc. prob=0.95]\rsample: 100%|█████████▉| 998/1000 [00:31<00:00, 39.85it/s, 127 steps of size 4.79e-02. acc. prob=0.94]\rsample: 100%|██████████| 1000/1000 [00:31<00:00, 31.97it/s, 63 steps of size 4.79e-02. acc. prob=0.94]\n```\n:::\n:::\n\n\n# Network Models\n\n::: {.panel-tabset group=\"language\"}\n## Python\n```Python\n# Setup device------------------------------------------------\nfrom BI import bi, jnp\n\n# Setup device------------------------------------------------\nm = bi(platform='cpu')\n# Simulate data ------------------------------------------------\nN = 50\nindividual_predictor = m.dist.normal(0,1, shape = (N,1), sample = True)\n\nkinship = m.dist.bernoulli(0.3, shape = (N,N), sample = True)\nkinship = kinship.at[jnp.diag_indices(N)].set(0)\n\ndef sim_network(kinship, individual_predictor):\n  # Intercept\n  alpha = m.dist.normal(0,1, sample = True)\n\n  # SR\n  sr = m.net.sender_receiver(individual_predictor, individual_predictor, s_mu = 0.4, r_mu = -0.4, sample = True)\n\n  # D\n  DR = m.net.dyadic_effect(kinship, d_sd=2.5, sample = True)\n\n  return m.dist.bernoulli(logits = alpha + sr + DR, sample = True)\n\n\nnetwork = sim_network(m.net.mat_to_edgl(kinship), individual_predictor)\n\n# Predictive model ------------------------------------------------\n\nm.data_on_model = dict(\n    network = network, \n    dyadic_predictors = m.net.mat_to_edgl(kinship),\n    focal_individual_predictors = individual_predictor,\n    target_individual_predictors = individual_predictor\n)\n\n\ndef model(network, dyadic_predictors, focal_individual_predictors, target_individual_predictors):\n    N_id = network.shape[0]\n\n    # Block ---------------------------------------\n    alpha = m.dist.normal(0,1, sample = True)\n\n    ## SR shape =  N individuals---------------------------------------\n    sr =  m.net.sender_receiver(\n      focal_individual_predictors,\n      target_individual_predictors,\n      s_mu = 0.4, r_mu = -0.4\n    )\n\n    # Dyadic shape = N dyads--------------------------------------  \n    dr = m.net.dyadic_effect(dyadic_predictors, d_sd=2.5) # Diadic effect intercept only \n\n    m.dist.bernoulli(logits = alpha + sr + dr, obs=network)\n\nm.fit(model, num_samples = 500, num_warmup = 500, num_chains = 1, thinning = 1)\n\n```\n\n:::\n\n",
    "supporting": [
      "Build in models_files/figure-pdf"
    ],
    "filters": []
  }
}