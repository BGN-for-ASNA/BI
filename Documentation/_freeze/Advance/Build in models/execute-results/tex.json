{
  "hash": "10ba04cc44c46214c9225cf13458af64",
  "result": {
    "engine": "jupyter",
    "markdown": "---\ntitle: \"Build in models\"\nsidebar: start\n---\n\n# PCA\n\n::: {.cell execution_count=1}\n``` {.python .cell-code}\nfrom BI import bi, jnp\n\nm=bi()\nm.data('iris.csv', sep=',') # Data is already scaled\nm.data_on_model = dict(\n    X=jnp.array(m.df.iloc[:,0:-2].values)\n)\nm.fit(m.models.pca(type=\"ARD\"), progress_bar=False) # or robust, sparse, classic, sparse_robust_ard\n\nm.models.pca.plot(\n    X=m.df.iloc[:,0:-2].values,\n    y=m.df.iloc[:,-2].values, \n    feature_names=m.df.columns[0:-2], \n    target_names=m.df.iloc[:,-1].unique(),\n    color_var=m.df.iloc[:,0].values,\n    shape_var=m.df.iloc[:,-2].values\n)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\njax.local_device_count 16\n```\n:::\n\n::: {.cell-output .cell-output-display}\n![](Build in models_files/figure-pdf/cell-2-output-2.png){fig-pos='H'}\n:::\n:::\n\n\n# Survival analysis\n\n::: {.cell execution_count=2}\n``` {.python .cell-code}\nfrom BI import bi, jnp\n\nm = bi()\nm.data('mastectomy.csv', sep=',').head()\n\nm.df.metastasized = (m.df.metastasized.values == \"yes\").astype(jnp.int64)\nm.models.survival.import_time_even(\n    m.df.time.values, \n    m.df.event.values, interval_length=3\n) # Import time-steps and events\nm.models.survival.import_covF(\n    m.df.metastasized.values, ['metastasized']\n) # Import time-fixed covariates\n# m.models.survival.import_covV # To import time-varying covariates\n\nm.fit(m.models.survival.model, num_samples=500) \nm.summary()\n\nm.models.survival.plot_surv( beta = 'Hazard_rate_metastasized')\n```\n\n::: {.cell-output .cell-output-stdout}\n```\njax.local_device_count 16\n------------------------------------------------------------------------------\nSurvival concern 44 individuals in 76 intervals.\n18.0 individuals experienced the event.\n------------------------------------------------------------------------------\nCovariates imported: ['metastasized']\nSurv object now has 1 covariates: ['metastasized']\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\n\r  0%|          | 0/1000 [00:00<?, ?it/s]\rwarmup:   0%|          | 1/1000 [00:01<29:12,  1.75s/it, 1 steps of size 2.34e+00. acc. prob=0.00]\rwarmup:   2%|▏         | 18/1000 [00:01<01:15, 13.05it/s, 1023 steps of size 2.28e-01. acc. prob=0.73]\rwarmup:   3%|▎         | 26/1000 [00:02<00:58, 16.63it/s, 1023 steps of size 2.42e-01. acc. prob=0.75]\rwarmup:   3%|▎         | 32/1000 [00:02<00:48, 19.84it/s, 34 steps of size 8.24e-02. acc. prob=0.74]  \rwarmup:   4%|▎         | 37/1000 [00:02<00:46, 20.75it/s, 1023 steps of size 2.82e-01. acc. prob=0.76]\rwarmup:   4%|▍         | 41/1000 [00:02<00:43, 21.98it/s, 13 steps of size 6.20e-02. acc. prob=0.75]  \rwarmup:   4%|▍         | 45/1000 [00:02<00:41, 23.20it/s, 149 steps of size 8.58e-02. acc. prob=0.76]\rwarmup:   5%|▍         | 49/1000 [00:02<00:39, 24.22it/s, 25 steps of size 1.03e-01. acc. prob=0.76] \rwarmup:   5%|▌         | 53/1000 [00:03<00:38, 24.82it/s, 67 steps of size 1.68e-01. acc. prob=0.77]\rwarmup:   6%|▌         | 56/1000 [00:03<00:39, 24.03it/s, 1023 steps of size 2.82e-01. acc. prob=0.77]\rwarmup:   6%|▌         | 59/1000 [00:03<00:37, 25.19it/s, 1023 steps of size 2.50e-01. acc. prob=0.77]\rwarmup:   6%|▌         | 62/1000 [00:03<00:38, 24.25it/s, 1023 steps of size 2.71e-01. acc. prob=0.77]\rwarmup:   6%|▋         | 65/1000 [00:03<00:39, 23.59it/s, 1023 steps of size 2.51e-01. acc. prob=0.77]\rwarmup:   7%|▋         | 69/1000 [00:03<00:36, 25.22it/s, 1023 steps of size 1.74e-01. acc. prob=0.77]\rwarmup:   7%|▋         | 72/1000 [00:03<00:36, 25.11it/s, 1023 steps of size 2.46e-01. acc. prob=0.78]\rwarmup:   8%|▊         | 75/1000 [00:04<00:39, 23.41it/s, 1023 steps of size 2.88e-01. acc. prob=0.78]\rwarmup:   8%|▊         | 79/1000 [00:04<00:34, 26.33it/s, 1023 steps of size 2.48e-01. acc. prob=0.78]\rwarmup:   8%|▊         | 82/1000 [00:04<00:37, 24.24it/s, 1023 steps of size 1.39e-01. acc. prob=0.77]\rwarmup:   9%|▊         | 86/1000 [00:04<00:35, 25.40it/s, 1023 steps of size 1.80e-01. acc. prob=0.78]\rwarmup:   9%|▉         | 89/1000 [00:04<00:35, 25.76it/s, 468 steps of size 2.46e-01. acc. prob=0.78] \rwarmup:   9%|▉         | 92/1000 [00:04<00:35, 25.52it/s, 511 steps of size 3.42e-01. acc. prob=0.78]\rwarmup:  10%|▉         | 96/1000 [00:04<00:35, 25.69it/s, 1023 steps of size 2.73e-01. acc. prob=0.78]\rwarmup:  10%|█         | 100/1000 [00:04<00:32, 28.12it/s, 511 steps of size 3.11e-01. acc. prob=0.78]\rwarmup:  10%|█         | 105/1000 [00:05<00:26, 33.40it/s, 1023 steps of size 8.07e-03. acc. prob=0.76]\rwarmup:  11%|█         | 109/1000 [00:05<00:29, 30.46it/s, 1023 steps of size 1.22e-02. acc. prob=0.77]\rwarmup:  11%|█▏        | 113/1000 [00:05<00:29, 30.37it/s, 1023 steps of size 8.33e-03. acc. prob=0.77]\rwarmup:  12%|█▏        | 118/1000 [00:05<00:27, 32.51it/s, 1023 steps of size 8.59e-03. acc. prob=0.77]\rwarmup:  12%|█▏        | 122/1000 [00:05<00:27, 32.30it/s, 1023 steps of size 9.81e-03. acc. prob=0.77]\rwarmup:  13%|█▎        | 126/1000 [00:05<00:29, 29.48it/s, 1023 steps of size 1.26e-02. acc. prob=0.77]\rwarmup:  13%|█▎        | 130/1000 [00:05<00:28, 30.02it/s, 198 steps of size 5.00e-03. acc. prob=0.77] \rwarmup:  13%|█▎        | 134/1000 [00:06<00:32, 26.79it/s, 1023 steps of size 1.72e-02. acc. prob=0.77]\rwarmup:  14%|█▍        | 139/1000 [00:06<00:29, 29.23it/s, 1023 steps of size 4.45e-03. acc. prob=0.77]\rwarmup:  14%|█▍        | 143/1000 [00:06<00:30, 28.20it/s, 511 steps of size 1.49e-02. acc. prob=0.77] \rwarmup:  15%|█▍        | 147/1000 [00:06<00:28, 30.02it/s, 1023 steps of size 9.29e-03. acc. prob=0.77]\rwarmup:  15%|█▌        | 154/1000 [00:06<00:22, 37.42it/s, 1023 steps of size 2.55e-03. acc. prob=0.76]\rwarmup:  16%|█▌        | 158/1000 [00:06<00:26, 32.32it/s, 1023 steps of size 7.53e-03. acc. prob=0.77]\rwarmup:  16%|█▌        | 162/1000 [00:06<00:26, 31.66it/s, 511 steps of size 1.02e-02. acc. prob=0.77] \rwarmup:  17%|█▋        | 166/1000 [00:07<00:25, 32.37it/s, 403 steps of size 1.86e-03. acc. prob=0.77]\rwarmup:  17%|█▋        | 170/1000 [00:07<00:27, 30.72it/s, 255 steps of size 8.00e-03. acc. prob=0.77]\rwarmup:  17%|█▋        | 174/1000 [00:07<00:26, 31.00it/s, 255 steps of size 1.53e-02. acc. prob=0.77]\rwarmup:  18%|█▊        | 178/1000 [00:07<00:25, 32.36it/s, 511 steps of size 6.35e-03. acc. prob=0.77]\rwarmup:  18%|█▊        | 182/1000 [00:07<00:27, 29.40it/s, 1023 steps of size 7.01e-03. acc. prob=0.77]\rwarmup:  19%|█▊        | 186/1000 [00:07<00:27, 29.39it/s, 511 steps of size 1.19e-02. acc. prob=0.77] \rwarmup:  19%|█▉        | 191/1000 [00:07<00:25, 31.66it/s, 1023 steps of size 7.83e-03. acc. prob=0.77]\rwarmup:  20%|█▉        | 197/1000 [00:07<00:20, 38.40it/s, 255 steps of size 6.74e-03. acc. prob=0.77] \rwarmup:  20%|██        | 202/1000 [00:08<00:22, 36.23it/s, 393 steps of size 3.74e-03. acc. prob=0.77]\rwarmup:  21%|██        | 206/1000 [00:08<00:21, 36.21it/s, 272 steps of size 4.18e-03. acc. prob=0.77]\rwarmup:  21%|██        | 210/1000 [00:08<00:21, 36.75it/s, 511 steps of size 1.10e-02. acc. prob=0.77]\rwarmup:  21%|██▏       | 214/1000 [00:08<00:21, 36.34it/s, 417 steps of size 9.88e-03. acc. prob=0.77]\rwarmup:  22%|██▏       | 218/1000 [00:08<00:21, 37.06it/s, 511 steps of size 5.51e-03. acc. prob=0.77]\rwarmup:  22%|██▏       | 223/1000 [00:08<00:19, 39.42it/s, 511 steps of size 6.15e-03. acc. prob=0.77]\rwarmup:  23%|██▎       | 227/1000 [00:08<00:22, 34.65it/s, 1023 steps of size 8.94e-03. acc. prob=0.78]\rwarmup:  23%|██▎       | 231/1000 [00:08<00:23, 33.28it/s, 511 steps of size 8.20e-03. acc. prob=0.78] \rwarmup:  24%|██▎       | 237/1000 [00:09<00:20, 38.04it/s, 511 steps of size 5.50e-03. acc. prob=0.78]\rwarmup:  24%|██▍       | 241/1000 [00:09<00:22, 33.11it/s, 1023 steps of size 4.96e-03. acc. prob=0.78]\rwarmup:  24%|██▍       | 245/1000 [00:09<00:23, 31.96it/s, 1023 steps of size 7.12e-03. acc. prob=0.78]\rwarmup:  25%|██▌       | 250/1000 [00:09<00:22, 32.67it/s, 1023 steps of size 7.59e-03. acc. prob=0.78]\rwarmup:  26%|██▌       | 255/1000 [00:09<00:21, 35.42it/s, 1023 steps of size 9.87e-03. acc. prob=0.77]\rwarmup:  26%|██▌       | 260/1000 [00:09<00:20, 36.11it/s, 1023 steps of size 7.98e-03. acc. prob=0.77]\rwarmup:  26%|██▋       | 264/1000 [00:09<00:20, 35.21it/s, 1023 steps of size 8.28e-03. acc. prob=0.78]\rwarmup:  27%|██▋       | 268/1000 [00:09<00:20, 36.06it/s, 1023 steps of size 8.42e-03. acc. prob=0.78]\rwarmup:  27%|██▋       | 272/1000 [00:10<00:20, 35.73it/s, 1023 steps of size 6.01e-03. acc. prob=0.78]\rwarmup:  28%|██▊       | 276/1000 [00:10<00:21, 34.14it/s, 1023 steps of size 7.57e-03. acc. prob=0.78]\rwarmup:  28%|██▊       | 280/1000 [00:10<00:22, 32.62it/s, 1023 steps of size 6.77e-03. acc. prob=0.78]\rwarmup:  28%|██▊       | 285/1000 [00:10<00:20, 34.47it/s, 1023 steps of size 6.13e-03. acc. prob=0.78]\rwarmup:  29%|██▉       | 289/1000 [00:10<00:24, 28.49it/s, 1023 steps of size 3.90e-03. acc. prob=0.78]\rwarmup:  29%|██▉       | 293/1000 [00:10<00:23, 30.13it/s, 255 steps of size 1.46e-02. acc. prob=0.78] \rwarmup:  30%|██▉       | 297/1000 [00:10<00:22, 31.70it/s, 511 steps of size 8.21e-03. acc. prob=0.78]\rwarmup:  30%|███       | 301/1000 [00:11<00:21, 32.20it/s, 1023 steps of size 5.30e-03. acc. prob=0.78]\rwarmup:  30%|███       | 305/1000 [00:11<00:21, 32.69it/s, 226 steps of size 3.19e-03. acc. prob=0.78] \rwarmup:  31%|███       | 309/1000 [00:11<00:22, 30.59it/s, 77 steps of size 4.35e-03. acc. prob=0.78] \rwarmup:  31%|███▏      | 313/1000 [00:11<00:23, 29.06it/s, 511 steps of size 1.26e-02. acc. prob=0.78]\rwarmup:  32%|███▏      | 317/1000 [00:11<00:21, 31.10it/s, 255 steps of size 6.07e-03. acc. prob=0.78]\rwarmup:  32%|███▏      | 321/1000 [00:11<00:22, 30.06it/s, 511 steps of size 7.93e-03. acc. prob=0.78]\rwarmup:  32%|███▎      | 325/1000 [00:11<00:22, 29.70it/s, 1023 steps of size 3.26e-03. acc. prob=0.78]\rwarmup:  33%|███▎      | 329/1000 [00:11<00:22, 29.98it/s, 127 steps of size 4.05e-03. acc. prob=0.78] \rwarmup:  33%|███▎      | 333/1000 [00:12<00:21, 31.41it/s, 255 steps of size 5.20e-03. acc. prob=0.78]\rwarmup:  34%|███▎      | 337/1000 [00:12<00:22, 29.80it/s, 511 steps of size 7.43e-03. acc. prob=0.78]\rwarmup:  34%|███▍      | 341/1000 [00:12<00:22, 29.86it/s, 1023 steps of size 6.40e-03. acc. prob=0.78]\rwarmup:  34%|███▍      | 345/1000 [00:12<00:22, 29.67it/s, 1023 steps of size 6.36e-03. acc. prob=0.78]\rwarmup:  35%|███▍      | 348/1000 [00:12<00:22, 29.38it/s, 511 steps of size 2.93e-03. acc. prob=0.78] \rwarmup:  35%|███▌      | 351/1000 [00:12<00:25, 25.39it/s, 1023 steps of size 7.81e-03. acc. prob=0.78]\rwarmup:  36%|███▌      | 355/1000 [00:12<00:23, 27.31it/s, 1023 steps of size 6.51e-03. acc. prob=0.78]\rwarmup:  36%|███▌      | 360/1000 [00:13<00:20, 31.32it/s, 511 steps of size 6.79e-03. acc. prob=0.78] \rwarmup:  36%|███▋      | 364/1000 [00:13<00:19, 31.86it/s, 511 steps of size 5.31e-03. acc. prob=0.78]\rwarmup:  37%|███▋      | 368/1000 [00:13<00:19, 31.98it/s, 255 steps of size 6.08e-03. acc. prob=0.78]\rwarmup:  37%|███▋      | 372/1000 [00:13<00:19, 32.01it/s, 1023 steps of size 5.92e-03. acc. prob=0.78]\rwarmup:  38%|███▊      | 376/1000 [00:13<00:19, 32.58it/s, 215 steps of size 6.27e-03. acc. prob=0.78] \rwarmup:  38%|███▊      | 380/1000 [00:13<00:19, 32.28it/s, 511 steps of size 5.33e-03. acc. prob=0.78]\rwarmup:  38%|███▊      | 384/1000 [00:13<00:18, 33.20it/s, 511 steps of size 1.15e-02. acc. prob=0.78]\rwarmup:  39%|███▉      | 388/1000 [00:13<00:18, 33.48it/s, 1023 steps of size 6.38e-03. acc. prob=0.78]\rwarmup:  39%|███▉      | 393/1000 [00:13<00:16, 36.21it/s, 412 steps of size 3.15e-03. acc. prob=0.78] \rwarmup:  40%|███▉      | 397/1000 [00:14<00:19, 31.18it/s, 511 steps of size 9.60e-03. acc. prob=0.78]\rwarmup:  40%|████      | 401/1000 [00:14<00:20, 29.68it/s, 434 steps of size 9.48e-03. acc. prob=0.78]\rwarmup:  40%|████      | 405/1000 [00:14<00:18, 31.42it/s, 1023 steps of size 5.37e-03. acc. prob=0.78]\rwarmup:  41%|████      | 409/1000 [00:14<00:19, 29.59it/s, 1023 steps of size 7.17e-03. acc. prob=0.78]\rwarmup:  41%|████▏     | 414/1000 [00:14<00:17, 34.23it/s, 302 steps of size 7.75e-03. acc. prob=0.78] \rwarmup:  42%|████▏     | 418/1000 [00:14<00:16, 34.96it/s, 511 steps of size 6.64e-03. acc. prob=0.78]\rwarmup:  42%|████▏     | 422/1000 [00:14<00:16, 34.53it/s, 1023 steps of size 6.19e-03. acc. prob=0.78]\rwarmup:  43%|████▎     | 427/1000 [00:15<00:15, 36.36it/s, 1023 steps of size 4.45e-03. acc. prob=0.78]\rwarmup:  43%|████▎     | 431/1000 [00:15<00:16, 34.00it/s, 1023 steps of size 6.88e-03. acc. prob=0.78]\rwarmup:  44%|████▎     | 436/1000 [00:15<00:15, 36.14it/s, 1023 steps of size 4.91e-03. acc. prob=0.78]\rwarmup:  44%|████▍     | 440/1000 [00:15<00:15, 36.11it/s, 343 steps of size 8.21e-03. acc. prob=0.78] \rwarmup:  44%|████▍     | 444/1000 [00:15<00:15, 35.54it/s, 1023 steps of size 6.84e-03. acc. prob=0.78]\rwarmup:  45%|████▍     | 448/1000 [00:15<00:15, 35.83it/s, 1023 steps of size 6.16e-03. acc. prob=0.78]\rwarmup:  45%|████▌     | 452/1000 [00:15<00:15, 35.44it/s, 2 steps of size 1.22e-02. acc. prob=0.78]   \rwarmup:  46%|████▌     | 456/1000 [00:15<00:15, 35.34it/s, 511 steps of size 9.88e-03. acc. prob=0.78]\rwarmup:  46%|████▌     | 460/1000 [00:15<00:15, 35.74it/s, 511 steps of size 1.08e-02. acc. prob=0.78]\rwarmup:  47%|████▋     | 466/1000 [00:16<00:12, 41.99it/s, 80 steps of size 1.45e-03. acc. prob=0.78] \rwarmup:  47%|████▋     | 471/1000 [00:16<00:14, 36.20it/s, 1023 steps of size 3.53e-03. acc. prob=0.78]\rwarmup:  48%|████▊     | 475/1000 [00:16<00:15, 34.63it/s, 1023 steps of size 6.06e-03. acc. prob=0.78]\rwarmup:  48%|████▊     | 480/1000 [00:16<00:13, 37.39it/s, 511 steps of size 1.30e-02. acc. prob=0.78] \rwarmup:  49%|████▊     | 487/1000 [00:16<00:11, 43.54it/s, 511 steps of size 7.08e-03. acc. prob=0.78]\rwarmup:  49%|████▉     | 492/1000 [00:16<00:12, 40.48it/s, 255 steps of size 6.21e-03. acc. prob=0.78]\rwarmup:  50%|████▉     | 497/1000 [00:16<00:12, 40.10it/s, 255 steps of size 7.04e-03. acc. prob=0.78]\rsample:  50%|█████     | 503/1000 [00:16<00:11, 44.13it/s, 511 steps of size 7.57e-03. acc. prob=0.46]\rsample:  51%|█████     | 508/1000 [00:17<00:11, 43.96it/s, 511 steps of size 7.57e-03. acc. prob=0.74]\rsample:  51%|█████▏    | 513/1000 [00:17<00:11, 43.37it/s, 511 steps of size 7.57e-03. acc. prob=0.75]\rsample:  52%|█████▏    | 518/1000 [00:17<00:10, 43.91it/s, 255 steps of size 7.57e-03. acc. prob=0.76]\rsample:  52%|█████▏    | 523/1000 [00:17<00:10, 43.41it/s, 511 steps of size 7.57e-03. acc. prob=0.79]\rsample:  53%|█████▎    | 528/1000 [00:17<00:11, 41.42it/s, 511 steps of size 7.57e-03. acc. prob=0.82]\rsample:  53%|█████▎    | 533/1000 [00:17<00:10, 43.57it/s, 511 steps of size 7.57e-03. acc. prob=0.82]\rsample:  54%|█████▍    | 538/1000 [00:17<00:10, 43.15it/s, 511 steps of size 7.57e-03. acc. prob=0.84]\rsample:  54%|█████▍    | 543/1000 [00:17<00:10, 42.96it/s, 511 steps of size 7.57e-03. acc. prob=0.85]\rsample:  55%|█████▍    | 548/1000 [00:18<00:10, 42.91it/s, 457 steps of size 7.57e-03. acc. prob=0.84]\rsample:  55%|█████▌    | 553/1000 [00:18<00:10, 43.21it/s, 417 steps of size 7.57e-03. acc. prob=0.84]\rsample:  56%|█████▌    | 558/1000 [00:18<00:10, 43.79it/s, 300 steps of size 7.57e-03. acc. prob=0.83]\rsample:  56%|█████▋    | 563/1000 [00:18<00:09, 44.69it/s, 302 steps of size 7.57e-03. acc. prob=0.82]\rsample:  57%|█████▋    | 568/1000 [00:18<00:09, 45.46it/s, 511 steps of size 7.57e-03. acc. prob=0.83]\rsample:  57%|█████▋    | 573/1000 [00:18<00:09, 44.51it/s, 511 steps of size 7.57e-03. acc. prob=0.83]\rsample:  58%|█████▊    | 578/1000 [00:18<00:09, 44.29it/s, 511 steps of size 7.57e-03. acc. prob=0.84]\rsample:  58%|█████▊    | 583/1000 [00:18<00:09, 44.14it/s, 511 steps of size 7.57e-03. acc. prob=0.84]\rsample:  59%|█████▉    | 588/1000 [00:18<00:09, 43.33it/s, 511 steps of size 7.57e-03. acc. prob=0.84]\rsample:  59%|█████▉    | 593/1000 [00:19<00:09, 43.60it/s, 511 steps of size 7.57e-03. acc. prob=0.83]\rsample:  60%|█████▉    | 598/1000 [00:19<00:09, 43.79it/s, 511 steps of size 7.57e-03. acc. prob=0.84]\rsample:  60%|██████    | 603/1000 [00:19<00:09, 42.66it/s, 511 steps of size 7.57e-03. acc. prob=0.84]\rsample:  61%|██████    | 608/1000 [00:19<00:09, 42.90it/s, 511 steps of size 7.57e-03. acc. prob=0.85]\rsample:  61%|██████▏   | 613/1000 [00:19<00:09, 42.56it/s, 511 steps of size 7.57e-03. acc. prob=0.85]\rsample:  62%|██████▏   | 618/1000 [00:19<00:08, 43.64it/s, 511 steps of size 7.57e-03. acc. prob=0.86]\rsample:  62%|██████▏   | 623/1000 [00:19<00:08, 43.63it/s, 511 steps of size 7.57e-03. acc. prob=0.85]\rsample:  63%|██████▎   | 628/1000 [00:19<00:08, 43.62it/s, 511 steps of size 7.57e-03. acc. prob=0.85]\rsample:  63%|██████▎   | 633/1000 [00:19<00:08, 43.55it/s, 511 steps of size 7.57e-03. acc. prob=0.85]\rsample:  64%|██████▍   | 638/1000 [00:20<00:08, 43.44it/s, 511 steps of size 7.57e-03. acc. prob=0.86]\rsample:  64%|██████▍   | 643/1000 [00:20<00:08, 43.23it/s, 511 steps of size 7.57e-03. acc. prob=0.85]\rsample:  65%|██████▍   | 648/1000 [00:20<00:08, 43.11it/s, 511 steps of size 7.57e-03. acc. prob=0.85]\rsample:  65%|██████▌   | 653/1000 [00:20<00:08, 42.82it/s, 511 steps of size 7.57e-03. acc. prob=0.85]\rsample:  66%|██████▌   | 658/1000 [00:20<00:08, 41.34it/s, 511 steps of size 7.57e-03. acc. prob=0.85]\rsample:  66%|██████▋   | 663/1000 [00:20<00:07, 42.69it/s, 511 steps of size 7.57e-03. acc. prob=0.85]\rsample:  67%|██████▋   | 668/1000 [00:20<00:07, 43.48it/s, 511 steps of size 7.57e-03. acc. prob=0.85]\rsample:  67%|██████▋   | 673/1000 [00:20<00:07, 44.90it/s, 511 steps of size 7.57e-03. acc. prob=0.84]\rsample:  68%|██████▊   | 678/1000 [00:21<00:07, 44.07it/s, 511 steps of size 7.57e-03. acc. prob=0.84]\rsample:  68%|██████▊   | 684/1000 [00:21<00:06, 46.07it/s, 511 steps of size 7.57e-03. acc. prob=0.84]\rsample:  69%|██████▉   | 689/1000 [00:21<00:06, 44.93it/s, 511 steps of size 7.57e-03. acc. prob=0.84]\rsample:  69%|██████▉   | 694/1000 [00:21<00:06, 43.87it/s, 511 steps of size 7.57e-03. acc. prob=0.84]\rsample:  70%|██████▉   | 699/1000 [00:21<00:07, 42.41it/s, 511 steps of size 7.57e-03. acc. prob=0.85]\rsample:  70%|███████   | 704/1000 [00:21<00:07, 40.77it/s, 511 steps of size 7.57e-03. acc. prob=0.85]\rsample:  71%|███████   | 709/1000 [00:21<00:07, 39.65it/s, 511 steps of size 7.57e-03. acc. prob=0.85]\rsample:  71%|███████▏  | 714/1000 [00:21<00:07, 40.60it/s, 511 steps of size 7.57e-03. acc. prob=0.85]\rsample:  72%|███████▏  | 719/1000 [00:21<00:06, 41.40it/s, 511 steps of size 7.57e-03. acc. prob=0.85]\rsample:  72%|███████▏  | 724/1000 [00:22<00:06, 41.56it/s, 511 steps of size 7.57e-03. acc. prob=0.85]\rsample:  73%|███████▎  | 729/1000 [00:22<00:06, 41.64it/s, 511 steps of size 7.57e-03. acc. prob=0.85]\rsample:  73%|███████▎  | 734/1000 [00:22<00:06, 41.76it/s, 511 steps of size 7.57e-03. acc. prob=0.85]\rsample:  74%|███████▍  | 739/1000 [00:22<00:06, 41.53it/s, 511 steps of size 7.57e-03. acc. prob=0.85]\rsample:  74%|███████▍  | 744/1000 [00:22<00:06, 41.54it/s, 511 steps of size 7.57e-03. acc. prob=0.85]\rsample:  75%|███████▍  | 749/1000 [00:22<00:05, 41.86it/s, 511 steps of size 7.57e-03. acc. prob=0.85]\rsample:  75%|███████▌  | 754/1000 [00:22<00:05, 42.78it/s, 511 steps of size 7.57e-03. acc. prob=0.85]\rsample:  76%|███████▌  | 759/1000 [00:22<00:05, 41.75it/s, 511 steps of size 7.57e-03. acc. prob=0.86]\rsample:  76%|███████▋  | 764/1000 [00:23<00:05, 42.97it/s, 511 steps of size 7.57e-03. acc. prob=0.86]\rsample:  77%|███████▋  | 769/1000 [00:23<00:05, 42.98it/s, 511 steps of size 7.57e-03. acc. prob=0.86]\rsample:  77%|███████▋  | 774/1000 [00:23<00:05, 42.88it/s, 511 steps of size 7.57e-03. acc. prob=0.86]\rsample:  78%|███████▊  | 779/1000 [00:23<00:05, 42.76it/s, 511 steps of size 7.57e-03. acc. prob=0.85]\rsample:  78%|███████▊  | 784/1000 [00:23<00:05, 42.75it/s, 511 steps of size 7.57e-03. acc. prob=0.86]\rsample:  79%|███████▉  | 789/1000 [00:23<00:04, 42.90it/s, 511 steps of size 7.57e-03. acc. prob=0.85]\rsample:  79%|███████▉  | 794/1000 [00:23<00:04, 42.53it/s, 511 steps of size 7.57e-03. acc. prob=0.85]\rsample:  80%|████████  | 800/1000 [00:23<00:04, 44.63it/s, 511 steps of size 7.57e-03. acc. prob=0.86]\rsample:  80%|████████  | 805/1000 [00:24<00:04, 43.49it/s, 511 steps of size 7.57e-03. acc. prob=0.85]\rsample:  81%|████████  | 810/1000 [00:24<00:04, 41.80it/s, 511 steps of size 7.57e-03. acc. prob=0.85]\rsample:  82%|████████▏ | 816/1000 [00:24<00:04, 43.91it/s, 511 steps of size 7.57e-03. acc. prob=0.85]\rsample:  82%|████████▏ | 821/1000 [00:24<00:04, 43.19it/s, 511 steps of size 7.57e-03. acc. prob=0.85]\rsample:  83%|████████▎ | 826/1000 [00:24<00:03, 44.52it/s, 511 steps of size 7.57e-03. acc. prob=0.85]\rsample:  83%|████████▎ | 831/1000 [00:24<00:03, 43.92it/s, 511 steps of size 7.57e-03. acc. prob=0.85]\rsample:  84%|████████▎ | 836/1000 [00:24<00:03, 45.14it/s, 511 steps of size 7.57e-03. acc. prob=0.85]\rsample:  84%|████████▍ | 841/1000 [00:24<00:03, 44.49it/s, 511 steps of size 7.57e-03. acc. prob=0.85]\rsample:  85%|████████▍ | 846/1000 [00:24<00:03, 45.29it/s, 511 steps of size 7.57e-03. acc. prob=0.85]\rsample:  85%|████████▌ | 851/1000 [00:25<00:03, 46.09it/s, 511 steps of size 7.57e-03. acc. prob=0.85]\rsample:  86%|████████▌ | 856/1000 [00:25<00:03, 42.34it/s, 511 steps of size 7.57e-03. acc. prob=0.85]\rsample:  86%|████████▌ | 861/1000 [00:25<00:03, 42.75it/s, 511 steps of size 7.57e-03. acc. prob=0.85]\rsample:  87%|████████▋ | 866/1000 [00:25<00:03, 44.01it/s, 511 steps of size 7.57e-03. acc. prob=0.86]\rsample:  87%|████████▋ | 871/1000 [00:25<00:02, 43.73it/s, 511 steps of size 7.57e-03. acc. prob=0.86]\rsample:  88%|████████▊ | 876/1000 [00:25<00:02, 43.71it/s, 511 steps of size 7.57e-03. acc. prob=0.86]\rsample:  88%|████████▊ | 881/1000 [00:25<00:02, 44.90it/s, 255 steps of size 7.57e-03. acc. prob=0.86]\rsample:  89%|████████▊ | 886/1000 [00:25<00:02, 45.58it/s, 511 steps of size 7.57e-03. acc. prob=0.86]\rsample:  89%|████████▉ | 891/1000 [00:25<00:02, 44.58it/s, 511 steps of size 7.57e-03. acc. prob=0.86]\rsample:  90%|████████▉ | 896/1000 [00:26<00:02, 45.90it/s, 255 steps of size 7.57e-03. acc. prob=0.86]\rsample:  90%|█████████ | 901/1000 [00:26<00:02, 46.58it/s, 511 steps of size 7.57e-03. acc. prob=0.86]\rsample:  91%|█████████ | 906/1000 [00:26<00:02, 45.64it/s, 511 steps of size 7.57e-03. acc. prob=0.86]\rsample:  91%|█████████ | 911/1000 [00:26<00:02, 42.43it/s, 511 steps of size 7.57e-03. acc. prob=0.86]\rsample:  92%|█████████▏| 916/1000 [00:26<00:01, 42.16it/s, 511 steps of size 7.57e-03. acc. prob=0.86]\rsample:  92%|█████████▏| 921/1000 [00:26<00:01, 42.44it/s, 511 steps of size 7.57e-03. acc. prob=0.86]\rsample:  93%|█████████▎| 926/1000 [00:26<00:01, 42.82it/s, 511 steps of size 7.57e-03. acc. prob=0.86]\rsample:  93%|█████████▎| 931/1000 [00:26<00:01, 43.01it/s, 511 steps of size 7.57e-03. acc. prob=0.86]\rsample:  94%|█████████▎| 936/1000 [00:27<00:01, 41.91it/s, 511 steps of size 7.57e-03. acc. prob=0.86]\rsample:  94%|█████████▍| 941/1000 [00:27<00:01, 40.96it/s, 511 steps of size 7.57e-03. acc. prob=0.86]\rsample:  95%|█████████▍| 946/1000 [00:27<00:01, 39.34it/s, 511 steps of size 7.57e-03. acc. prob=0.86]\rsample:  95%|█████████▌| 951/1000 [00:27<00:01, 41.57it/s, 511 steps of size 7.57e-03. acc. prob=0.86]\rsample:  96%|█████████▌| 956/1000 [00:27<00:01, 40.89it/s, 511 steps of size 7.57e-03. acc. prob=0.86]\rsample:  96%|█████████▌| 962/1000 [00:27<00:00, 45.54it/s, 511 steps of size 7.57e-03. acc. prob=0.86]\rsample:  97%|█████████▋| 967/1000 [00:27<00:00, 44.84it/s, 511 steps of size 7.57e-03. acc. prob=0.86]\rsample:  97%|█████████▋| 972/1000 [00:27<00:00, 44.09it/s, 511 steps of size 7.57e-03. acc. prob=0.86]\rsample:  98%|█████████▊| 977/1000 [00:27<00:00, 43.67it/s, 511 steps of size 7.57e-03. acc. prob=0.86]\rsample:  98%|█████████▊| 982/1000 [00:28<00:00, 43.46it/s, 511 steps of size 7.57e-03. acc. prob=0.86]\rsample:  99%|█████████▊| 987/1000 [00:28<00:00, 42.41it/s, 255 steps of size 7.57e-03. acc. prob=0.86]\rsample:  99%|█████████▉| 993/1000 [00:28<00:00, 44.90it/s, 511 steps of size 7.57e-03. acc. prob=0.86]\rsample: 100%|█████████▉| 998/1000 [00:28<00:00, 44.36it/s, 511 steps of size 7.57e-03. acc. prob=0.86]\rsample: 100%|██████████| 1000/1000 [00:28<00:00, 35.11it/s, 511 steps of size 7.57e-03. acc. prob=0.86]\narviz - WARNING - Shape validation failed: input_shape: (1, 500), minimum_shape: (chains=2, draws=4)\n/home/sosa/work/.venv/lib/python3.12/site-packages/arviz/plots/hdiplot.py:166: FutureWarning:\n\nhdi currently interprets 2d data as (draw, shape) but this will change in a future release to (chain, draw) for coherence with other functions\n\n/home/sosa/work/.venv/lib/python3.12/site-packages/arviz/plots/hdiplot.py:166: FutureWarning:\n\nhdi currently interprets 2d data as (draw, shape) but this will change in a future release to (chain, draw) for coherence with other functions\n\n/home/sosa/work/.venv/lib/python3.12/site-packages/arviz/plots/hdiplot.py:166: FutureWarning:\n\nhdi currently interprets 2d data as (draw, shape) but this will change in a future release to (chain, draw) for coherence with other functions\n\n/home/sosa/work/.venv/lib/python3.12/site-packages/arviz/plots/hdiplot.py:166: FutureWarning:\n\nhdi currently interprets 2d data as (draw, shape) but this will change in a future release to (chain, draw) for coherence with other functions\n\n```\n:::\n\n::: {.cell-output .cell-output-display}\n![](Build in models_files/figure-pdf/cell-3-output-3.png){fig-pos='H'}\n:::\n:::\n\n\n# Gaussian Mixture Models\n\n::: {.cell execution_count=3}\n``` {.python .cell-code}\nfrom BI import bi\nfrom sklearn.datasets import make_blobs\n\n# Generate synthetic data\ndata, true_labels = make_blobs(\n    n_samples=500, centers=8, cluster_std=0.8,\n    center_box=(-10,10), random_state=101\n)\n\n\nm.data_on_model = {\"data\": data,\"K\": 8 }\nm.fit(m.models.gmm) # Optimize model parameters through MCMC sampling\nm.plot(X=data,sampler=m.sampler) # Prebuild plot function for GMM\n```\n\n::: {.cell-output .cell-output-stderr}\n```\n\r  0%|          | 0/1000 [00:00<?, ?it/s]\rwarmup:   0%|          | 1/1000 [00:03<1:06:20,  3.98s/it, 1 steps of size 2.34e+00. acc. prob=0.00]\rwarmup:   2%|▏         | 23/1000 [00:04<02:05,  7.82it/s, 63 steps of size 2.05e-02. acc. prob=0.71]\rwarmup:   4%|▎         | 35/1000 [00:04<01:14, 12.98it/s, 15 steps of size 4.79e-02. acc. prob=0.74]\rwarmup:   5%|▍         | 49/1000 [00:04<00:45, 20.85it/s, 7 steps of size 5.89e-02. acc. prob=0.76] \rwarmup:   7%|▋         | 69/1000 [00:04<00:26, 35.41it/s, 15 steps of size 3.85e-02. acc. prob=0.76]\rwarmup:  10%|▉         | 95/1000 [00:04<00:15, 58.67it/s, 15 steps of size 3.50e-02. acc. prob=0.77]\rwarmup:  11%|█▏        | 114/1000 [00:04<00:12, 73.74it/s, 31 steps of size 2.16e-01. acc. prob=0.77]\rwarmup:  14%|█▎        | 137/1000 [00:04<00:08, 96.68it/s, 31 steps of size 1.83e-01. acc. prob=0.78]\rwarmup:  16%|█▌        | 161/1000 [00:04<00:06, 121.90it/s, 7 steps of size 4.79e-01. acc. prob=0.78]\rwarmup:  18%|█▊        | 183/1000 [00:04<00:05, 141.06it/s, 15 steps of size 4.68e-01. acc. prob=0.78]\rwarmup:  21%|██        | 209/1000 [00:05<00:04, 166.87it/s, 7 steps of size 2.20e-01. acc. prob=0.78] \rwarmup:  23%|██▎       | 232/1000 [00:05<00:04, 179.44it/s, 7 steps of size 2.27e-01. acc. prob=0.78]\rwarmup:  26%|██▌       | 256/1000 [00:05<00:03, 191.32it/s, 31 steps of size 2.78e-01. acc. prob=0.78]\rwarmup:  28%|██▊       | 279/1000 [00:05<00:03, 189.22it/s, 7 steps of size 8.27e-01. acc. prob=0.78] \rwarmup:  30%|███       | 301/1000 [00:05<00:03, 194.30it/s, 15 steps of size 3.35e-01. acc. prob=0.78]\rwarmup:  32%|███▎      | 325/1000 [00:05<00:03, 204.88it/s, 15 steps of size 5.69e-01. acc. prob=0.78]\rwarmup:  35%|███▌      | 351/1000 [00:05<00:02, 217.84it/s, 15 steps of size 4.43e-01. acc. prob=0.78]\rwarmup:  38%|███▊      | 379/1000 [00:05<00:02, 233.27it/s, 15 steps of size 3.53e-01. acc. prob=0.78]\rwarmup:  41%|████      | 408/1000 [00:05<00:02, 248.85it/s, 7 steps of size 6.61e-01. acc. prob=0.79] \rwarmup:  44%|████▎     | 436/1000 [00:06<00:02, 255.95it/s, 15 steps of size 5.15e-01. acc. prob=0.79]\rwarmup:  46%|████▋     | 465/1000 [00:06<00:02, 265.28it/s, 7 steps of size 4.65e-01. acc. prob=0.79] \rwarmup:  49%|████▉     | 492/1000 [00:06<00:02, 251.27it/s, 15 steps of size 3.56e-01. acc. prob=0.79]\rsample:  52%|█████▏    | 518/1000 [00:06<00:01, 241.91it/s, 15 steps of size 4.07e-01. acc. prob=0.89]\rsample:  54%|█████▍    | 543/1000 [00:06<00:01, 235.48it/s, 7 steps of size 4.07e-01. acc. prob=0.89] \rsample:  57%|█████▋    | 569/1000 [00:06<00:01, 242.17it/s, 7 steps of size 4.07e-01. acc. prob=0.90]\rsample:  59%|█████▉    | 594/1000 [00:06<00:01, 236.94it/s, 15 steps of size 4.07e-01. acc. prob=0.89]\rsample:  62%|██████▏   | 618/1000 [00:06<00:01, 221.08it/s, 31 steps of size 4.07e-01. acc. prob=0.90]\rsample:  64%|██████▍   | 644/1000 [00:06<00:01, 229.09it/s, 15 steps of size 4.07e-01. acc. prob=0.90]\rsample:  67%|██████▋   | 668/1000 [00:07<00:01, 220.81it/s, 7 steps of size 4.07e-01. acc. prob=0.90] \rsample:  69%|██████▉   | 691/1000 [00:07<00:01, 207.75it/s, 15 steps of size 4.07e-01. acc. prob=0.90]\rsample:  71%|███████▏  | 713/1000 [00:07<00:01, 198.89it/s, 15 steps of size 4.07e-01. acc. prob=0.90]\rsample:  73%|███████▎  | 734/1000 [00:07<00:01, 185.25it/s, 15 steps of size 4.07e-01. acc. prob=0.90]\rsample:  76%|███████▌  | 755/1000 [00:07<00:01, 189.75it/s, 15 steps of size 4.07e-01. acc. prob=0.90]\rsample:  78%|███████▊  | 775/1000 [00:07<00:01, 185.19it/s, 15 steps of size 4.07e-01. acc. prob=0.90]\rsample:  79%|███████▉  | 794/1000 [00:07<00:01, 168.68it/s, 15 steps of size 4.07e-01. acc. prob=0.90]\rsample:  81%|████████▏ | 814/1000 [00:07<00:01, 176.70it/s, 7 steps of size 4.07e-01. acc. prob=0.89] \rsample:  84%|████████▍ | 838/1000 [00:07<00:00, 191.67it/s, 15 steps of size 4.07e-01. acc. prob=0.89]\rsample:  86%|████████▌ | 862/1000 [00:08<00:00, 203.46it/s, 15 steps of size 4.07e-01. acc. prob=0.90]\rsample:  88%|████████▊ | 884/1000 [00:08<00:00, 205.04it/s, 15 steps of size 4.07e-01. acc. prob=0.90]\rsample:  91%|█████████ | 908/1000 [00:08<00:00, 211.68it/s, 15 steps of size 4.07e-01. acc. prob=0.90]\rsample:  93%|█████████▎| 933/1000 [00:08<00:00, 219.98it/s, 15 steps of size 4.07e-01. acc. prob=0.90]\rsample:  96%|█████████▌| 956/1000 [00:08<00:00, 222.08it/s, 7 steps of size 4.07e-01. acc. prob=0.89] \rsample:  98%|█████████▊| 979/1000 [00:08<00:00, 222.96it/s, 15 steps of size 4.07e-01. acc. prob=0.90]\rsample: 100%|██████████| 1000/1000 [00:08<00:00, 115.05it/s, 15 steps of size 4.07e-01. acc. prob=0.90]\n```\n:::\n\n::: {.cell-output .cell-output-display}\n![](Build in models_files/figure-pdf/cell-4-output-2.png){fig-pos='H'}\n:::\n\n::: {.cell-output .cell-output-stdout}\n```\nModel not supported\n```\n:::\n:::\n\n\n# Dirichlet Process Mixture Models\n\n\n## Python\n\n::: {.cell execution_count=4}\n``` {.python .cell-code}\nfrom BI import bi\nfrom sklearn.datasets import make_blobs\n\n# Generate synthetic data\ndata, true_labels = make_blobs(\n    n_samples=500, centers=8, cluster_std=0.8,\n    center_box=(-10,10), random_state=101\n)\n\nm.data_on_model = {\"data\": data, \"T\": 10 } # T = Number of maximum cluster to test for\nm.fit(m.models.dpmm) \nm.plot(X=data,sampler=m.sampler) # Prebuild plot function for GMM\n```\n\n::: {.cell-output .cell-output-stderr}\n```\n\r  0%|          | 0/1000 [00:00<?, ?it/s]\rwarmup:   0%|          | 1/1000 [00:03<1:04:07,  3.85s/it, 1 steps of size 2.34e+00. acc. prob=0.00]\rwarmup:   2%|▏         | 15/1000 [00:04<03:16,  5.01it/s, 511 steps of size 9.88e-03. acc. prob=0.65]\rwarmup:   2%|▏         | 19/1000 [00:04<02:35,  6.31it/s, 511 steps of size 5.50e-03. acc. prob=0.67]\rwarmup:   2%|▏         | 22/1000 [00:04<02:20,  6.98it/s, 127 steps of size 1.59e-02. acc. prob=0.70]\rwarmup:   2%|▎         | 25/1000 [00:04<01:58,  8.24it/s, 63 steps of size 5.95e-02. acc. prob=0.73] \rwarmup:   3%|▎         | 28/1000 [00:04<01:38,  9.91it/s, 127 steps of size 2.94e-02. acc. prob=0.73]\rwarmup:   3%|▎         | 31/1000 [00:04<01:22, 11.81it/s, 255 steps of size 1.59e-02. acc. prob=0.72]\rwarmup:   4%|▎         | 35/1000 [00:05<01:02, 15.48it/s, 31 steps of size 1.35e-01. acc. prob=0.75] \rwarmup:   4%|▍         | 38/1000 [00:05<01:11, 13.37it/s, 511 steps of size 4.71e-02. acc. prob=0.75]\rwarmup:   4%|▍         | 41/1000 [00:05<01:01, 15.67it/s, 63 steps of size 4.24e-02. acc. prob=0.75] \rwarmup:   4%|▍         | 45/1000 [00:05<00:49, 19.22it/s, 159 steps of size 8.74e-02. acc. prob=0.76]\rwarmup:   5%|▍         | 48/1000 [00:05<00:59, 16.04it/s, 383 steps of size 3.51e-02. acc. prob=0.75]\rwarmup:   5%|▌         | 52/1000 [00:06<00:48, 19.69it/s, 47 steps of size 1.13e-01. acc. prob=0.76] \rwarmup:   6%|▌         | 55/1000 [00:06<00:47, 19.80it/s, 255 steps of size 3.37e-02. acc. prob=0.75]\rwarmup:   6%|▌         | 58/1000 [00:06<00:43, 21.68it/s, 31 steps of size 1.12e-01. acc. prob=0.77] \rwarmup:   6%|▋         | 64/1000 [00:06<00:31, 29.96it/s, 55 steps of size 4.99e-02. acc. prob=0.76]\rwarmup:   7%|▋         | 68/1000 [00:06<00:29, 32.07it/s, 63 steps of size 8.05e-02. acc. prob=0.77]\rwarmup:   7%|▋         | 72/1000 [00:06<00:27, 33.61it/s, 63 steps of size 6.78e-02. acc. prob=0.77]\rwarmup:   8%|▊         | 76/1000 [00:06<00:29, 31.55it/s, 127 steps of size 8.55e-02. acc. prob=0.77]\rwarmup:   8%|▊         | 80/1000 [00:06<00:29, 30.95it/s, 95 steps of size 6.49e-02. acc. prob=0.77] \rwarmup:   9%|▊         | 86/1000 [00:07<00:26, 34.55it/s, 127 steps of size 6.24e-02. acc. prob=0.77]\rwarmup:   9%|▉         | 90/1000 [00:07<00:27, 32.75it/s, 31 steps of size 1.08e-01. acc. prob=0.77] \rwarmup:  10%|▉         | 96/1000 [00:07<00:23, 39.15it/s, 31 steps of size 5.09e-02. acc. prob=0.77]\rwarmup:  10%|█         | 101/1000 [00:07<00:22, 39.84it/s, 63 steps of size 1.04e+00. acc. prob=0.78]\rwarmup:  11%|█         | 106/1000 [00:07<00:26, 34.38it/s, 127 steps of size 6.15e-02. acc. prob=0.77]\rwarmup:  11%|█         | 110/1000 [00:07<00:27, 31.94it/s, 255 steps of size 7.47e-02. acc. prob=0.77]\rwarmup:  11%|█▏        | 114/1000 [00:07<00:32, 27.55it/s, 255 steps of size 4.19e-02. acc. prob=0.77]\rwarmup:  12%|█▏        | 118/1000 [00:08<00:33, 26.38it/s, 255 steps of size 3.46e-02. acc. prob=0.77]\rwarmup:  12%|█▏        | 122/1000 [00:08<00:30, 28.67it/s, 31 steps of size 1.77e-01. acc. prob=0.77] \rwarmup:  13%|█▎        | 126/1000 [00:08<00:35, 24.71it/s, 255 steps of size 9.85e-02. acc. prob=0.77]\rwarmup:  13%|█▎        | 129/1000 [00:08<00:35, 24.82it/s, 255 steps of size 4.65e-02. acc. prob=0.77]\rwarmup:  14%|█▎        | 135/1000 [00:08<00:27, 31.34it/s, 63 steps of size 1.61e-01. acc. prob=0.78] \rwarmup:  14%|█▍        | 139/1000 [00:08<00:28, 29.71it/s, 63 steps of size 8.10e-02. acc. prob=0.77]\rwarmup:  14%|█▍        | 143/1000 [00:08<00:30, 28.05it/s, 127 steps of size 6.67e-02. acc. prob=0.77]\rwarmup:  15%|█▍        | 149/1000 [00:09<00:24, 34.22it/s, 31 steps of size 5.58e-02. acc. prob=0.77] \rwarmup:  15%|█▌        | 154/1000 [00:09<00:22, 37.73it/s, 127 steps of size 5.55e-02. acc. prob=0.77]\rwarmup:  16%|█▌        | 160/1000 [00:09<00:19, 42.54it/s, 127 steps of size 8.61e-02. acc. prob=0.77]\rwarmup:  16%|█▋        | 165/1000 [00:09<00:19, 43.94it/s, 63 steps of size 1.01e-01. acc. prob=0.77] \rwarmup:  17%|█▋        | 171/1000 [00:09<00:17, 47.46it/s, 31 steps of size 1.55e-01. acc. prob=0.78]\rwarmup:  18%|█▊        | 176/1000 [00:09<00:24, 34.14it/s, 31 steps of size 6.53e-02. acc. prob=0.77]\rwarmup:  18%|█▊        | 181/1000 [00:09<00:22, 36.72it/s, 31 steps of size 1.04e-01. acc. prob=0.78]\rwarmup:  19%|█▉        | 188/1000 [00:09<00:19, 42.29it/s, 63 steps of size 1.08e-01. acc. prob=0.78]\rwarmup:  20%|█▉        | 196/1000 [00:10<00:15, 50.27it/s, 31 steps of size 2.67e-01. acc. prob=0.78]\rwarmup:  21%|██        | 206/1000 [00:10<00:12, 61.15it/s, 63 steps of size 9.68e-02. acc. prob=0.78]\rwarmup:  21%|██▏       | 213/1000 [00:10<00:12, 60.94it/s, 63 steps of size 1.61e-01. acc. prob=0.78]\rwarmup:  22%|██▏       | 220/1000 [00:10<00:12, 61.84it/s, 31 steps of size 1.58e-01. acc. prob=0.78]\rwarmup:  23%|██▎       | 229/1000 [00:10<00:11, 65.00it/s, 63 steps of size 8.33e-02. acc. prob=0.78]\rwarmup:  24%|██▎       | 236/1000 [00:10<00:12, 62.93it/s, 63 steps of size 1.04e-01. acc. prob=0.78]\rwarmup:  24%|██▍       | 243/1000 [00:10<00:12, 62.28it/s, 31 steps of size 1.84e-01. acc. prob=0.78]\rwarmup:  25%|██▌       | 250/1000 [00:10<00:11, 63.05it/s, 63 steps of size 8.65e-02. acc. prob=0.78]\rwarmup:  26%|██▌       | 257/1000 [00:10<00:11, 62.05it/s, 127 steps of size 3.09e-02. acc. prob=0.78]\rwarmup:  26%|██▋       | 264/1000 [00:11<00:22, 33.27it/s, 63 steps of size 9.79e-02. acc. prob=0.78] \rwarmup:  27%|██▋       | 269/1000 [00:11<00:24, 30.14it/s, 127 steps of size 9.16e-02. acc. prob=0.78]\rwarmup:  28%|██▊       | 276/1000 [00:11<00:20, 35.74it/s, 63 steps of size 1.09e-01. acc. prob=0.78] \rwarmup:  28%|██▊       | 281/1000 [00:11<00:18, 38.29it/s, 63 steps of size 8.61e-02. acc. prob=0.78]\rwarmup:  29%|██▊       | 286/1000 [00:11<00:17, 39.76it/s, 63 steps of size 3.49e-02. acc. prob=0.78]\rwarmup:  29%|██▉       | 291/1000 [00:12<00:21, 32.61it/s, 127 steps of size 6.50e-02. acc. prob=0.78]\rwarmup:  30%|██▉       | 299/1000 [00:12<00:17, 40.74it/s, 63 steps of size 9.13e-02. acc. prob=0.78] \rwarmup:  30%|███       | 304/1000 [00:12<00:17, 40.83it/s, 127 steps of size 1.99e-02. acc. prob=0.78]\rwarmup:  31%|███       | 309/1000 [00:12<00:25, 26.96it/s, 255 steps of size 1.96e-02. acc. prob=0.78]\rwarmup:  31%|███▏      | 313/1000 [00:13<00:29, 23.66it/s, 63 steps of size 7.83e-02. acc. prob=0.78] \rwarmup:  32%|███▏      | 320/1000 [00:13<00:21, 31.09it/s, 15 steps of size 6.43e-02. acc. prob=0.78]\rwarmup:  33%|███▎      | 326/1000 [00:13<00:18, 36.11it/s, 63 steps of size 6.37e-02. acc. prob=0.78]\rwarmup:  33%|███▎      | 332/1000 [00:13<00:16, 40.10it/s, 63 steps of size 6.16e-02. acc. prob=0.78]\rwarmup:  34%|███▎      | 337/1000 [00:13<00:17, 38.58it/s, 63 steps of size 6.09e-02. acc. prob=0.78]\rwarmup:  34%|███▍      | 342/1000 [00:13<00:19, 32.91it/s, 255 steps of size 3.21e-02. acc. prob=0.78]\rwarmup:  35%|███▍      | 346/1000 [00:13<00:19, 32.80it/s, 63 steps of size 1.10e-01. acc. prob=0.78] \rwarmup:  35%|███▌      | 351/1000 [00:13<00:19, 33.61it/s, 127 steps of size 7.10e-02. acc. prob=0.78]\rwarmup:  36%|███▌      | 356/1000 [00:14<00:18, 35.16it/s, 63 steps of size 6.66e-02. acc. prob=0.78] \rwarmup:  36%|███▌      | 361/1000 [00:14<00:17, 36.67it/s, 63 steps of size 1.12e-01. acc. prob=0.78]\rwarmup:  37%|███▋      | 367/1000 [00:14<00:15, 41.02it/s, 31 steps of size 1.29e-01. acc. prob=0.78]\rwarmup:  37%|███▋      | 372/1000 [00:14<00:16, 38.51it/s, 63 steps of size 1.00e-01. acc. prob=0.78]\rwarmup:  38%|███▊      | 376/1000 [00:14<00:16, 37.31it/s, 63 steps of size 4.27e-02. acc. prob=0.78]\rwarmup:  38%|███▊      | 380/1000 [00:14<00:18, 33.17it/s, 63 steps of size 1.07e-01. acc. prob=0.78]\rwarmup:  38%|███▊      | 385/1000 [00:14<00:17, 36.02it/s, 63 steps of size 4.95e-02. acc. prob=0.78]\rwarmup:  39%|███▉      | 389/1000 [00:15<00:17, 34.07it/s, 127 steps of size 5.07e-02. acc. prob=0.78]\rwarmup:  39%|███▉      | 393/1000 [00:15<00:17, 34.38it/s, 63 steps of size 3.80e-02. acc. prob=0.78] \rwarmup:  40%|███▉      | 397/1000 [00:15<00:19, 31.08it/s, 127 steps of size 3.79e-02. acc. prob=0.78]\rwarmup:  40%|████      | 401/1000 [00:15<00:20, 29.02it/s, 63 steps of size 7.02e-02. acc. prob=0.78] \rwarmup:  40%|████      | 405/1000 [00:15<00:19, 30.50it/s, 63 steps of size 4.27e-02. acc. prob=0.78]\rwarmup:  41%|████      | 409/1000 [00:15<00:26, 22.35it/s, 127 steps of size 4.02e-02. acc. prob=0.78]\rwarmup:  41%|████      | 412/1000 [00:16<00:26, 22.01it/s, 63 steps of size 7.57e-02. acc. prob=0.78] \rwarmup:  42%|████▏     | 418/1000 [00:16<00:20, 28.55it/s, 63 steps of size 7.52e-02. acc. prob=0.78]\rwarmup:  42%|████▏     | 423/1000 [00:16<00:17, 32.34it/s, 63 steps of size 1.23e-01. acc. prob=0.79]\rwarmup:  43%|████▎     | 430/1000 [00:16<00:14, 40.50it/s, 31 steps of size 7.51e-02. acc. prob=0.78]\rwarmup:  44%|████▎     | 435/1000 [00:16<00:13, 41.35it/s, 63 steps of size 9.54e-02. acc. prob=0.79]\rwarmup:  44%|████▍     | 440/1000 [00:16<00:12, 43.10it/s, 63 steps of size 9.70e-02. acc. prob=0.79]\rwarmup:  44%|████▍     | 445/1000 [00:16<00:13, 41.54it/s, 63 steps of size 9.75e-02. acc. prob=0.79]\rwarmup:  45%|████▌     | 450/1000 [00:16<00:16, 32.94it/s, 255 steps of size 3.92e-02. acc. prob=0.78]\rwarmup:  45%|████▌     | 454/1000 [00:17<00:17, 31.57it/s, 255 steps of size 1.38e-02. acc. prob=0.78]\rwarmup:  46%|████▌     | 458/1000 [00:17<00:21, 25.59it/s, 63 steps of size 5.24e-02. acc. prob=0.78] \rwarmup:  46%|████▋     | 463/1000 [00:17<00:17, 30.34it/s, 31 steps of size 1.64e-01. acc. prob=0.78]\rwarmup:  47%|████▋     | 467/1000 [00:17<00:20, 26.42it/s, 127 steps of size 6.31e-02. acc. prob=0.78]\rwarmup:  47%|████▋     | 471/1000 [00:17<00:20, 25.33it/s, 255 steps of size 2.90e-02. acc. prob=0.78]\rwarmup:  48%|████▊     | 476/1000 [00:17<00:20, 26.05it/s, 255 steps of size 2.98e-02. acc. prob=0.78]\rwarmup:  48%|████▊     | 479/1000 [00:18<00:23, 21.95it/s, 511 steps of size 1.07e-02. acc. prob=0.78]\rwarmup:  48%|████▊     | 482/1000 [00:18<00:29, 17.81it/s, 127 steps of size 4.40e-02. acc. prob=0.78]\rwarmup:  49%|████▊     | 487/1000 [00:18<00:22, 22.65it/s, 127 steps of size 5.63e-02. acc. prob=0.78]\rwarmup:  49%|████▉     | 493/1000 [00:18<00:17, 29.47it/s, 31 steps of size 2.90e-02. acc. prob=0.78] \rwarmup:  50%|████▉     | 497/1000 [00:18<00:18, 27.66it/s, 255 steps of size 2.77e-02. acc. prob=0.78]\rsample:  50%|█████     | 501/1000 [00:18<00:16, 29.45it/s, 63 steps of size 4.79e-02. acc. prob=0.98] \rsample:  50%|█████     | 505/1000 [00:19<00:15, 31.46it/s, 63 steps of size 4.79e-02. acc. prob=0.97]\rsample:  51%|█████     | 509/1000 [00:19<00:15, 31.39it/s, 127 steps of size 4.79e-02. acc. prob=0.96]\rsample:  51%|█████▏    | 514/1000 [00:19<00:13, 35.65it/s, 63 steps of size 4.79e-02. acc. prob=0.96] \rsample:  52%|█████▏    | 519/1000 [00:19<00:12, 38.84it/s, 63 steps of size 4.79e-02. acc. prob=0.96]\rsample:  52%|█████▏    | 524/1000 [00:19<00:12, 39.26it/s, 63 steps of size 4.79e-02. acc. prob=0.96]\rsample:  53%|█████▎    | 529/1000 [00:19<00:11, 39.65it/s, 63 steps of size 4.79e-02. acc. prob=0.97]\rsample:  53%|█████▎    | 534/1000 [00:19<00:11, 39.29it/s, 127 steps of size 4.79e-02. acc. prob=0.96]\rsample:  54%|█████▍    | 539/1000 [00:19<00:11, 38.92it/s, 63 steps of size 4.79e-02. acc. prob=0.96] \rsample:  54%|█████▍    | 544/1000 [00:20<00:11, 40.46it/s, 63 steps of size 4.79e-02. acc. prob=0.96]\rsample:  55%|█████▍    | 549/1000 [00:20<00:11, 38.05it/s, 63 steps of size 4.79e-02. acc. prob=0.96]\rsample:  55%|█████▌    | 554/1000 [00:20<00:11, 39.18it/s, 63 steps of size 4.79e-02. acc. prob=0.96]\rsample:  56%|█████▌    | 559/1000 [00:20<00:10, 41.48it/s, 63 steps of size 4.79e-02. acc. prob=0.95]\rsample:  56%|█████▋    | 565/1000 [00:20<00:09, 43.77it/s, 63 steps of size 4.79e-02. acc. prob=0.96]\rsample:  57%|█████▋    | 570/1000 [00:20<00:10, 41.41it/s, 63 steps of size 4.79e-02. acc. prob=0.95]\rsample:  57%|█████▊    | 575/1000 [00:20<00:10, 41.20it/s, 127 steps of size 4.79e-02. acc. prob=0.95]\rsample:  58%|█████▊    | 580/1000 [00:20<00:10, 40.99it/s, 63 steps of size 4.79e-02. acc. prob=0.95] \rsample:  58%|█████▊    | 585/1000 [00:21<00:10, 41.25it/s, 63 steps of size 4.79e-02. acc. prob=0.95]\rsample:  59%|█████▉    | 590/1000 [00:21<00:09, 42.70it/s, 63 steps of size 4.79e-02. acc. prob=0.95]\rsample:  60%|█████▉    | 595/1000 [00:21<00:09, 43.82it/s, 63 steps of size 4.79e-02. acc. prob=0.95]\rsample:  60%|██████    | 600/1000 [00:21<00:09, 44.24it/s, 63 steps of size 4.79e-02. acc. prob=0.95]\rsample:  60%|██████    | 605/1000 [00:21<00:09, 42.31it/s, 63 steps of size 4.79e-02. acc. prob=0.95]\rsample:  61%|██████    | 610/1000 [00:21<00:08, 43.90it/s, 63 steps of size 4.79e-02. acc. prob=0.95]\rsample:  62%|██████▏   | 615/1000 [00:21<00:09, 39.28it/s, 63 steps of size 4.79e-02. acc. prob=0.95]\rsample:  62%|██████▏   | 620/1000 [00:21<00:09, 41.00it/s, 63 steps of size 4.79e-02. acc. prob=0.95]\rsample:  62%|██████▎   | 625/1000 [00:21<00:08, 42.97it/s, 63 steps of size 4.79e-02. acc. prob=0.95]\rsample:  63%|██████▎   | 630/1000 [00:22<00:08, 43.82it/s, 63 steps of size 4.79e-02. acc. prob=0.96]\rsample:  64%|██████▎   | 635/1000 [00:22<00:08, 44.60it/s, 63 steps of size 4.79e-02. acc. prob=0.96]\rsample:  64%|██████▍   | 640/1000 [00:22<00:08, 43.67it/s, 63 steps of size 4.79e-02. acc. prob=0.96]\rsample:  64%|██████▍   | 645/1000 [00:22<00:08, 42.64it/s, 63 steps of size 4.79e-02. acc. prob=0.95]\rsample:  65%|██████▌   | 650/1000 [00:22<00:08, 41.45it/s, 127 steps of size 4.79e-02. acc. prob=0.96]\rsample:  66%|██████▌   | 655/1000 [00:22<00:08, 40.87it/s, 63 steps of size 4.79e-02. acc. prob=0.96] \rsample:  66%|██████▌   | 660/1000 [00:22<00:08, 38.93it/s, 63 steps of size 4.79e-02. acc. prob=0.96]\rsample:  66%|██████▋   | 664/1000 [00:22<00:08, 38.88it/s, 63 steps of size 4.79e-02. acc. prob=0.96]\rsample:  67%|██████▋   | 669/1000 [00:23<00:07, 41.64it/s, 63 steps of size 4.79e-02. acc. prob=0.96]\rsample:  67%|██████▋   | 674/1000 [00:23<00:08, 39.20it/s, 63 steps of size 4.79e-02. acc. prob=0.96]\rsample:  68%|██████▊   | 678/1000 [00:23<00:08, 38.60it/s, 127 steps of size 4.79e-02. acc. prob=0.95]\rsample:  68%|██████▊   | 683/1000 [00:23<00:07, 40.93it/s, 63 steps of size 4.79e-02. acc. prob=0.95] \rsample:  69%|██████▉   | 688/1000 [00:23<00:07, 42.77it/s, 63 steps of size 4.79e-02. acc. prob=0.95]\rsample:  69%|██████▉   | 693/1000 [00:23<00:07, 41.07it/s, 127 steps of size 4.79e-02. acc. prob=0.95]\rsample:  70%|██████▉   | 698/1000 [00:23<00:07, 42.95it/s, 63 steps of size 4.79e-02. acc. prob=0.95] \rsample:  70%|███████   | 703/1000 [00:23<00:06, 44.59it/s, 63 steps of size 4.79e-02. acc. prob=0.95]\rsample:  71%|███████   | 708/1000 [00:23<00:06, 45.37it/s, 63 steps of size 4.79e-02. acc. prob=0.95]\rsample:  71%|███████▏  | 713/1000 [00:24<00:07, 39.24it/s, 63 steps of size 4.79e-02. acc. prob=0.95]\rsample:  72%|███████▏  | 718/1000 [00:24<00:07, 39.66it/s, 63 steps of size 4.79e-02. acc. prob=0.95]\rsample:  72%|███████▏  | 723/1000 [00:24<00:06, 42.21it/s, 63 steps of size 4.79e-02. acc. prob=0.95]\rsample:  73%|███████▎  | 728/1000 [00:24<00:06, 43.90it/s, 63 steps of size 4.79e-02. acc. prob=0.95]\rsample:  73%|███████▎  | 733/1000 [00:24<00:06, 42.54it/s, 63 steps of size 4.79e-02. acc. prob=0.95]\rsample:  74%|███████▍  | 738/1000 [00:24<00:06, 41.34it/s, 63 steps of size 4.79e-02. acc. prob=0.95]\rsample:  74%|███████▍  | 743/1000 [00:24<00:06, 40.89it/s, 63 steps of size 4.79e-02. acc. prob=0.95]\rsample:  75%|███████▍  | 748/1000 [00:24<00:06, 40.15it/s, 63 steps of size 4.79e-02. acc. prob=0.95]\rsample:  75%|███████▌  | 753/1000 [00:25<00:06, 40.20it/s, 63 steps of size 4.79e-02. acc. prob=0.95]\rsample:  76%|███████▌  | 758/1000 [00:25<00:05, 42.00it/s, 63 steps of size 4.79e-02. acc. prob=0.95]\rsample:  76%|███████▋  | 763/1000 [00:25<00:05, 39.88it/s, 63 steps of size 4.79e-02. acc. prob=0.95]\rsample:  77%|███████▋  | 768/1000 [00:25<00:05, 41.53it/s, 63 steps of size 4.79e-02. acc. prob=0.95]\rsample:  77%|███████▋  | 773/1000 [00:25<00:05, 42.65it/s, 63 steps of size 4.79e-02. acc. prob=0.95]\rsample:  78%|███████▊  | 778/1000 [00:25<00:05, 44.13it/s, 63 steps of size 4.79e-02. acc. prob=0.95]\rsample:  78%|███████▊  | 783/1000 [00:25<00:04, 44.80it/s, 63 steps of size 4.79e-02. acc. prob=0.95]\rsample:  79%|███████▉  | 788/1000 [00:25<00:05, 36.46it/s, 127 steps of size 4.79e-02. acc. prob=0.94]\rsample:  79%|███████▉  | 793/1000 [00:26<00:05, 39.03it/s, 63 steps of size 4.79e-02. acc. prob=0.94] \rsample:  80%|███████▉  | 798/1000 [00:26<00:05, 39.47it/s, 127 steps of size 4.79e-02. acc. prob=0.94]\rsample:  80%|████████  | 803/1000 [00:26<00:05, 37.16it/s, 127 steps of size 4.79e-02. acc. prob=0.95]\rsample:  81%|████████  | 807/1000 [00:26<00:05, 36.44it/s, 63 steps of size 4.79e-02. acc. prob=0.94] \rsample:  81%|████████  | 812/1000 [00:26<00:04, 39.09it/s, 63 steps of size 4.79e-02. acc. prob=0.95]\rsample:  82%|████████▏ | 817/1000 [00:26<00:05, 36.16it/s, 127 steps of size 4.79e-02. acc. prob=0.95]\rsample:  82%|████████▏ | 821/1000 [00:26<00:05, 34.93it/s, 63 steps of size 4.79e-02. acc. prob=0.95] \rsample:  82%|████████▎ | 825/1000 [00:26<00:04, 35.84it/s, 63 steps of size 4.79e-02. acc. prob=0.95]\rsample:  83%|████████▎ | 829/1000 [00:27<00:04, 34.40it/s, 63 steps of size 4.79e-02. acc. prob=0.95]\rsample:  83%|████████▎ | 833/1000 [00:27<00:04, 33.72it/s, 63 steps of size 4.79e-02. acc. prob=0.95]\rsample:  84%|████████▎ | 837/1000 [00:27<00:04, 34.24it/s, 127 steps of size 4.79e-02. acc. prob=0.95]\rsample:  84%|████████▍ | 842/1000 [00:27<00:04, 37.63it/s, 63 steps of size 4.79e-02. acc. prob=0.95] \rsample:  85%|████████▍ | 846/1000 [00:27<00:04, 38.07it/s, 63 steps of size 4.79e-02. acc. prob=0.94]\rsample:  85%|████████▌ | 850/1000 [00:27<00:04, 34.55it/s, 127 steps of size 4.79e-02. acc. prob=0.94]\rsample:  85%|████████▌ | 854/1000 [00:27<00:04, 34.78it/s, 63 steps of size 4.79e-02. acc. prob=0.94] \rsample:  86%|████████▌ | 858/1000 [00:27<00:04, 35.41it/s, 63 steps of size 4.79e-02. acc. prob=0.95]\rsample:  86%|████████▋ | 863/1000 [00:27<00:03, 37.90it/s, 63 steps of size 4.79e-02. acc. prob=0.95]\rsample:  87%|████████▋ | 868/1000 [00:28<00:03, 40.16it/s, 63 steps of size 4.79e-02. acc. prob=0.95]\rsample:  87%|████████▋ | 873/1000 [00:28<00:02, 42.52it/s, 63 steps of size 4.79e-02. acc. prob=0.94]\rsample:  88%|████████▊ | 878/1000 [00:28<00:02, 43.84it/s, 63 steps of size 4.79e-02. acc. prob=0.94]\rsample:  88%|████████▊ | 883/1000 [00:28<00:02, 43.09it/s, 63 steps of size 4.79e-02. acc. prob=0.94]\rsample:  89%|████████▉ | 888/1000 [00:28<00:02, 38.72it/s, 63 steps of size 4.79e-02. acc. prob=0.94]\rsample:  89%|████████▉ | 892/1000 [00:28<00:02, 38.64it/s, 63 steps of size 4.79e-02. acc. prob=0.94]\rsample:  90%|████████▉ | 898/1000 [00:28<00:02, 42.20it/s, 63 steps of size 4.79e-02. acc. prob=0.94]\rsample:  90%|█████████ | 903/1000 [00:28<00:02, 43.72it/s, 63 steps of size 4.79e-02. acc. prob=0.94]\rsample:  91%|█████████ | 908/1000 [00:28<00:02, 44.62it/s, 63 steps of size 4.79e-02. acc. prob=0.94]\rsample:  91%|█████████▏| 913/1000 [00:29<00:02, 40.83it/s, 127 steps of size 4.79e-02. acc. prob=0.95]\rsample:  92%|█████████▏| 918/1000 [00:29<00:02, 38.70it/s, 63 steps of size 4.79e-02. acc. prob=0.95] \rsample:  92%|█████████▏| 922/1000 [00:29<00:02, 38.80it/s, 127 steps of size 4.79e-02. acc. prob=0.94]\rsample:  93%|█████████▎| 926/1000 [00:29<00:01, 37.17it/s, 63 steps of size 4.79e-02. acc. prob=0.94] \rsample:  93%|█████████▎| 931/1000 [00:29<00:01, 39.36it/s, 63 steps of size 4.79e-02. acc. prob=0.94]\rsample:  94%|█████████▎| 936/1000 [00:29<00:01, 40.07it/s, 63 steps of size 4.79e-02. acc. prob=0.94]\rsample:  94%|█████████▍| 941/1000 [00:29<00:01, 39.34it/s, 63 steps of size 4.79e-02. acc. prob=0.94]\rsample:  95%|█████████▍| 946/1000 [00:29<00:01, 41.51it/s, 63 steps of size 4.79e-02. acc. prob=0.94]\rsample:  95%|█████████▌| 951/1000 [00:30<00:01, 40.61it/s, 63 steps of size 4.79e-02. acc. prob=0.94]\rsample:  96%|█████████▌| 956/1000 [00:30<00:01, 38.83it/s, 127 steps of size 4.79e-02. acc. prob=0.95]\rsample:  96%|█████████▌| 960/1000 [00:30<00:01, 36.99it/s, 63 steps of size 4.79e-02. acc. prob=0.95] \rsample:  96%|█████████▋| 965/1000 [00:30<00:00, 39.18it/s, 63 steps of size 4.79e-02. acc. prob=0.95]\rsample:  97%|█████████▋| 969/1000 [00:30<00:00, 36.90it/s, 127 steps of size 4.79e-02. acc. prob=0.95]\rsample:  97%|█████████▋| 974/1000 [00:30<00:00, 38.87it/s, 63 steps of size 4.79e-02. acc. prob=0.94] \rsample:  98%|█████████▊| 979/1000 [00:30<00:00, 41.65it/s, 63 steps of size 4.79e-02. acc. prob=0.94]\rsample:  98%|█████████▊| 984/1000 [00:30<00:00, 42.97it/s, 63 steps of size 4.79e-02. acc. prob=0.94]\rsample:  99%|█████████▉| 989/1000 [00:31<00:00, 40.41it/s, 127 steps of size 4.79e-02. acc. prob=0.94]\rsample:  99%|█████████▉| 994/1000 [00:31<00:00, 39.47it/s, 127 steps of size 4.79e-02. acc. prob=0.94]\rsample: 100%|█████████▉| 999/1000 [00:31<00:00, 34.22it/s, 127 steps of size 4.79e-02. acc. prob=0.94]\rsample: 100%|██████████| 1000/1000 [00:31<00:00, 31.82it/s, 63 steps of size 4.79e-02. acc. prob=0.94]\n```\n:::\n\n::: {.cell-output .cell-output-stdout}\n```\nModel found 9 clusters.\n```\n:::\n\n::: {.cell-output .cell-output-display}\n![](Build in models_files/figure-pdf/cell-5-output-3.png){fig-pos='H'}\n:::\n:::\n\n\n# Network Models\n\n::: {.panel-tabset group=\"language\"}\n## Python\n```Python\nfrom BI import bi\n\n# Setup device------------------------------------------------\nfrom BI import bi\n# Setup device------------------------------------------------\nm = bi(platform='cpu')\n\nm.data_on_model = dict(\n    idx = idx,\n    Any = Any-1, \n    Merica = Merica-1, \n    Quantum = Quantum-1,\n    result_outcomes = m.net.mat_to_edgl(data['outcomes']), \n    kinship = m.net.mat_to_edgl(kinship),\n    focal_individual_predictors = data['individual_predictors'],\n    target_individual_predictors = data['individual_predictors'],\n    exposure_mat = data['exposure']\n)\n\n\ndef model(idx, result_outcomes, \n    exposure,\n    kinship, \n    focal_individual_predictors, target_individual_predictors, \n    Any, Merica, Quantum):\n      # Block ---------------------------------------\n      B_any = m.net.block_model(Any,1)\n      B_Merica = m.net.block_model(Merica,3)\n      B_Quantum = m.net.block_model(Quantum,2)\n\n      ## SR shape =  N individuals---------------------------------------\n      sr =  m.net.sender_receiver(focal_individual_predictors,target_individual_predictors)\n\n      # Dyadic shape = N dyads--------------------------------------  \n      dr = m.net.dyadic_effect(dyadic_predictors)\n\n      m.dist.poisson(jnp.exp(B_any + B_Merica + B_Quantum + sender_receiver + dr), obs = result_outcomes, name= 'latent network' )\n\n\n\nm.fit(model) \nsummary = m.summary()\nsummary.loc[['focal_effects[0]', 'target_effects[0]', 'dyad_effects[0]']]\n\nm.fit(model2) \nsummary = m.summary()\nsummary\n```\n## R\n```r\nlibrary(BI)\n# Setup platform------------------------------------------------\nm=importbi(platform='cpu')\n\n# Import data ------------------------------------------------\n\nload(paste(system.file(package = \"BI\"),'/data/STRAND sim sr only.Rdata', sep = ''))\n\nids = 0:(model_dat$N_id-1)\nidx = m$net$vec_node_to_edgle(jnp$stack(jnp$array(list(ids, ids)), axis = -as.integer(1)))\n\nkeys <- c(\"idx\",\n          'idxShape',\n          \"result_outcomes\",\n          'focal_individual_predictors',\n          'target_individual_predictors')\n\nvalues <- list(\n  idx,\n  idx$shape[[1]],\n  m$net$mat_to_edgl(model_dat$outcomes[,,1]),\n  jnp$array(model_dat$individual_predictors)$reshape(as.integer(1),as.integer(50)),\n  jnp$array(model_dat$individual_predictors)$reshape(as.integer(1),as.integer(50))\n)\ndata = py_dict(keys, values, convert = TRUE)\nm$data_on_model=data\n\n# Define model ------------------------------------------------\nmodel <- function(idx, idxShape, result_outcomes,focal_individual_predictors, target_individual_predictors){\n  N_id = 50\n  x=0.1/jnp$sqrt(N_id)\n  tmp=jnp$log(x / (1 - x))\n  \n  ## Block ---------------------------------------\n  B = bi.dist.normal(tmp, 2.5, shape=c(1), name = 'block')\n  \n  #SR ---------------------------------------\n  sr =  m$net$sender_receiver(focal_individual_predictors,target_individual_predictors)\n  \n  ### Dyadic--------------------------------------  \n  #dr, dr_raw, dr_sigma, dr_L = m.net.dyadic_random_effects(idx.shape[0], cholesky_density = 2)# shape = n dyads\n  dr = m$net$dyadic_effect(shape = c(idxShape))\n\n  ## SR ---------------------------------------                                                      \n  m$poisson(jnp$exp(B + sr + dr), obs=result_outcomes)  \n}\n\n# Run MCMC ------------------------------------------------\nm$fit(model) # Optimize model parameters through MCMC sampling\n\n# Summary ------------------------------------------------\nsummary =m$summary()\n\nsummary[rownames(summary) %in% c('focal_effects[0]', 'target_effects[0]', 'block[0]'),]\n\n```\n:::\n\n",
    "supporting": [
      "Build in models_files/figure-pdf"
    ],
    "filters": []
  }
}